<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="title" content="(wat-aro)"/><meta name="description" content="wat-aro のサイト"/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="(wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/images/default-ogimage.png"/><meta property="og:url" content="https://wat-aro.dev/slides/getting-started-with-elm"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="(wat-aro)"/><meta name="twitter:description" content="wat-aro のサイト"/><meta name="twitter:image" content="https://wat-aro.dev/images/default-ogimage.png"/><meta name="next-head-count" content="16"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/cef7709dba1aabcc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cef7709dba1aabcc.css" data-n-g=""/><link rel="preload" href="/_next/static/css/2b5404e9d344d383.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2b5404e9d344d383.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-e7be5a2ce3007f17.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-847cc7a6659a518e.js" defer=""></script><script src="/_next/static/chunks/pages/slides/%5Bslug%5D-2c380248fcce344d.js" defer=""></script><script src="/_next/static/UwCaGKmzBpbdZ13-mi1wQ/_buildManifest.js" defer=""></script><script src="/_next/static/UwCaGKmzBpbdZ13-mi1wQ/_ssgManifest.js" defer=""></script><script src="/_next/static/UwCaGKmzBpbdZ13-mi1wQ/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full flex flex-col justify-end border-black pb-4"><a href="/posts">Blog</a></li><li class="h-full flex flex-col justify-end border-black pb-3 border-b-4"><a href="/slides">Slide</a></li><li class="h-full flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li></ul></div><div class="flex md:justify-center justify-between w-full flex-grow"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><div class="top-0 left-0 w-full h-full"><div class="reveal"><div class="slides">
        <section data-markdown data-separator-vertical="^===
">
          <textarea data-template>
            # `Elm` ことはじめ

---

## 自己紹介

- wat-aro
- 10%の時間では Elm でフロントエンドをやっていました
- 関数型が好きです

---

## おしながき

- Elm とは
- 文法
- TEA
- まとめ

---

## Elm とは

- 静的型付け Alt JS
- A delightfull language
- No Runtime Exception
- Great Peerformance
- Small Assets

---

### 静的型付けの Alt JS

Haskell like な見た目

```elm
map : (a -> b) -> List a -> List b
map f list =
  case list of
    [] -> []
    (x :: xs) -> f x :: (map f xs)
```

---

### 静的型付けの Alt JS

強力な型推論と親切なエラーメッセージ

```elm
> 1 + "1"
-- TYPE MISMATCH ----------------------------------------------------------- elm

I cannot do addition with String values like this one:

4|   1 + "1"
         ^^^
The (+) operator only works with Int and Float values.

Hint: Switch to the (++) operator to append strings!
```

---

### A delightful language

公式サイトが言ってます

[![Image from Gyazo](https://i.gyazo.com/772c9e8c416140a595a7ca586a66a159.png)](https://gyazo.com/772c9e8c416140a595a7ca586a66a159)

---

### Great Peerformance

[![Image from Gyazo](https://i.gyazo.com/50ecbb1475d7b22a2495ebdc087d59af.png)](https://gyazo.com/50ecbb1475d7b22a2495ebdc087d59af)

---

### Small Assets

[![Image from Gyazo](https://i.gyazo.com/7e580ab002610cd302a89046d9e28e0a.png)](https://gyazo.com/7e580ab002610cd302a89046d9e28e0a)

---

---

## 文法

- デフォルトカリー化
- Haskell-like 型定義
- パターンマッチ

---

### デフォルトカリー化

ML や Haskell のようにデフォルトでカリー化されている

```elm
add : Int -> Int -> Int
add x y = x + y

add 2 3  -- 5

add2 : Int -> Int
add2 = add 2

add2 3 -- 5
```

---

### Haskell-like 型定義

- Haskell like な型定義
- 代数的データ型
- 型クラスはない

```elm
type Maybe a
  = Just a
  | Nothing
```

型アノテーションのコロンは一つ

```elm
42 : Int
"Hello Elm" : String
```

---

### パターンマッチ

- 型定義に沿った形でパターンマッチができる
- 網羅性検査もされるので漏れが出ない
- 漏れているとコンパイルエラー

```elm
type Maybe a
  = Just a
  | Nothing
```

```elm
map : (a -> b) -> Maybe a -> Maybe b
map f x = case x of
  Just a -> Maybe (f a)
  Nothing -> Nothing

```

---

---

## The Elm Architecture(TEA)

- `view`は`model`を受け取って`HTML`を作成する
- `HTML`から`msg`を投げ、`update`が現在の`model`と`msg`から新しい`model`を作成する
- 新しい`model`から再度`HTML`を作成する

```elm
sandbox :
    { init : model
    , view : model -> Html msg
    , update : msg -> model -> model
    }
    -> Program () model msg
```

---

### sandbox のライフサイクル

![Browser.sandbox](https://guide.elm-lang.org/effects/diagrams/sandbox.svg)

---

### カヌンターアプリの例

- `+` ボタンと `-` ボタンがあるカウンター
- https://elm-lang.org/examples/buttons
- モデルの初期値は 0
- update と view はそれぞれの名前の関数

```elm
sandbox :
    { init : model
    , view : model -> Html msg
    , update : msg -> model -> model
    }
    -> Program () model msg

main : Program () Int Msg
main =
  Browser.sandbox { init = 0, update = update, view = view }
```

---

### まずはメッセージの型定義から

- Msg は Increment と Decrement の二つ
- Increment が来たら model を +1 する
- Decrement が来たら model を -1 する
- RunTime System が update の返り値を受け取り現在のモデルを更新する

```elm
type Msg = Increment | Decrement

update : Msg -> Int -> Int
update msg model =
  case msg of
    Increment ->
      model + 1

    Decrement ->
      model - 1
```

---

### 描画に使う関数

- HTML タグ のタグも関数で定義されている
- div の第一引数は Attribute msg のリスト
- div の第二引数は Html msg のリスト
- onClick の引数に msg を渡すと、クリックされた時にそのメッセージを投げる
- text は文字列の描画用の関数
- 型変数になっている部分は型推論で解決される

```elm
div : List (Attribute msg) -> List (Html msg) -> Html msg
button : List (Attribute msg) -> List (Html msg) -> Html msg
onClick : msg -> Attribute msg
text : String -> Html msg
```

---

### 描画部分

- さっきの関数を使って view を構成する

```elm
view : Int -> Html Msg
view model =
  div []
    [ button [ onClick Decrement ] [ text "-" ]
    , div [] [ text (String.fromInt model) ]
    , button [ onClick Increment ] [ text "+" ]
    ]
```

---

### 副作用を扱う例(Cat gifs)

- 猫の GIF 画像をランダムに取得し描画するアプリ
- https://elm-lang.org/examples/cat-gifs
- `element` を使う

---

### Browser.element

- `view`は変わらない
- `update`の返り値が `model`から`(model, Cmd msg)`に変更
- 外部からのイベントを扱う `subscriptions` が追加(今回は扱いません)

```elm
element :
    { init : flags -> ( model, Cmd msg )
    , view : model -> Html msg
    , update : msg -> model -> ( model, Cmd msg )
    , subscriptions : model -> Sub msg
    }
    -> Program flags model msg
```

---

### Cmd とは

- 主に副作用を扱う(e.g. HTTP リクエスト, 乱数生成, 現在時の取得)
- 実行した結果 `Cmd msg` を返し、その`msg`が `Runtime System` によって `update`に渡される

---

### 副作用を扱った場合のライフサイクル

![Browser.element](https://guide.elm-lang.org/effects/diagrams/element.svg)

---

### Cat Gifs の Msg

- 再度猫 Gif を取得する MorePlease
- 猫 Gif の取得した結果を表す GotGif (Result Http.Error String)
- Result error value 型は成功・失敗を表すことが出来る

```elm
type Msg
  = MorePlease
  | GotGif (Result Http.Error String)
```

---

### Cat Gif の Model

- 猫画像取に失敗したら Failure
- 取得中は Loading
- 取得に成功したら Success に 猫 Gif の URL を文字列で持つ

```elm
type Model
  = Failure
  | Loading
  | Success String
```

---

### Cat Gif の Initialize phase

- モデルの初期値は Loading
- getRandomCatGif で猫 Gif を取得する
- Http.get の返り値の型が Cmd msg なので Cmd を強制される

```elm
init : () -> (Model, Cmd Msg)
init _ =
  (Loading, getRandomCatGif)

get : { url : String, expect : Expect msg } -> Cmd msg

getRandomCatGif : Cmd Msg
getRandomCatGif =
  Http.get
    { url = "https://api.giphy.com/v1/gifs/random?api_key=dc6zaTOxFJmzC&tag=cat"
    , expect = Http.expectJson GotGif gifDecoder
    }
```

---

### Cat Gif の更新 phase

- MorePlease メッセージなら Loading 状態にして猫 Gif を取得しにいく
- 取得した結果、成功していればモデルに URL を入れて描画、失敗していれば Failure 画面に

```elm
update : Msg -> Model -> (Model, Cmd Msg)
update msg model =
  case msg of
    MorePlease ->
      (Loading, getRandomCatGif)

    GotGif result ->
      case result of
        Ok url ->
          (Success url, Cmd.none)

        Err _ ->
          (Failure, Cmd.none)
```

---

### Cat Gif の描画

- view でもパターンマッチで状態を網羅して描画しているかが検査できる

```elm
view : Model -> Html Msg
view model =
  div []
    [ h2 [] [ text "Random Cats" ]
    , viewGif model
    ]

viewGif : Model -> Html Msg
viewGif model =
  case model of
    Failure ->
      div []
        [ text "I could not load a random cat for some reason. "
        , button [ onClick MorePlease ] [ text "Try Again!" ]
        ]

    Loading ->
      text "Loading..."

    Success url ->
      div []
        [ button [ onClick MorePlease, style "display" "block" ] [ text "More Please!" ]
        , img [ src url ] []
        ]
```

---

### TEA

- 副作用を扱わない場合 model, update, message, view によって構成される
- view から message を投げ、その message に合わせて model を更新する
- 副作用を扱う場合は update から副作用(Cmd)を実行し、Cmd からまた message を投げ update で受け取る
- 今回は見ていないけれど、外部からの入力(時間によって発するイベントや websocket のイベントなど\*\*は subscription で扱う

---

## まとめ

- Elm の基本的なところを紹介しました
- TEA を紹介しました
- 簡潔な型定義とパターンマッチで安全にフロントエンドが開発できるよ！

          </textarea>
        </section>
    </div></div></div></div></div><div class="flex md:justify-center w-full"><div class="flex flex-col md:max-w-4xl w-full"><hr/><div class="flex justify-center pt-4 pb-8">© 2022 wat-aro</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slide":{"title":"Elm ことはじめ","published":"2019/10/28","tags":["Elm"],"slug":"getting-started-with-elm","content":"# `Elm` ことはじめ\n\n---\n\n## 自己紹介\n\n- wat-aro\n- 10%の時間では Elm でフロントエンドをやっていました\n- 関数型が好きです\n\n---\n\n## おしながき\n\n- Elm とは\n- 文法\n- TEA\n- まとめ\n\n---\n\n## Elm とは\n\n- 静的型付け Alt JS\n- A delightfull language\n- No Runtime Exception\n- Great Peerformance\n- Small Assets\n\n---\n\n### 静的型付けの Alt JS\n\nHaskell like な見た目\n\n```elm\nmap : (a -\u003e b) -\u003e List a -\u003e List b\nmap f list =\n  case list of\n    [] -\u003e []\n    (x :: xs) -\u003e f x :: (map f xs)\n```\n\n---\n\n### 静的型付けの Alt JS\n\n強力な型推論と親切なエラーメッセージ\n\n```elm\n\u003e 1 + \"1\"\n-- TYPE MISMATCH ----------------------------------------------------------- elm\n\nI cannot do addition with String values like this one:\n\n4|   1 + \"1\"\n         ^^^\nThe (+) operator only works with Int and Float values.\n\nHint: Switch to the (++) operator to append strings!\n```\n\n---\n\n### A delightful language\n\n公式サイトが言ってます\n\n[![Image from Gyazo](https://i.gyazo.com/772c9e8c416140a595a7ca586a66a159.png)](https://gyazo.com/772c9e8c416140a595a7ca586a66a159)\n\n---\n\n### Great Peerformance\n\n[![Image from Gyazo](https://i.gyazo.com/50ecbb1475d7b22a2495ebdc087d59af.png)](https://gyazo.com/50ecbb1475d7b22a2495ebdc087d59af)\n\n---\n\n### Small Assets\n\n[![Image from Gyazo](https://i.gyazo.com/7e580ab002610cd302a89046d9e28e0a.png)](https://gyazo.com/7e580ab002610cd302a89046d9e28e0a)\n\n---\n\n---\n\n## 文法\n\n- デフォルトカリー化\n- Haskell-like 型定義\n- パターンマッチ\n\n---\n\n### デフォルトカリー化\n\nML や Haskell のようにデフォルトでカリー化されている\n\n```elm\nadd : Int -\u003e Int -\u003e Int\nadd x y = x + y\n\nadd 2 3  -- 5\n\nadd2 : Int -\u003e Int\nadd2 = add 2\n\nadd2 3 -- 5\n```\n\n---\n\n### Haskell-like 型定義\n\n- Haskell like な型定義\n- 代数的データ型\n- 型クラスはない\n\n```elm\ntype Maybe a\n  = Just a\n  | Nothing\n```\n\n型アノテーションのコロンは一つ\n\n```elm\n42 : Int\n\"Hello Elm\" : String\n```\n\n---\n\n### パターンマッチ\n\n- 型定義に沿った形でパターンマッチができる\n- 網羅性検査もされるので漏れが出ない\n- 漏れているとコンパイルエラー\n\n```elm\ntype Maybe a\n  = Just a\n  | Nothing\n```\n\n```elm\nmap : (a -\u003e b) -\u003e Maybe a -\u003e Maybe b\nmap f x = case x of\n  Just a -\u003e Maybe (f a)\n  Nothing -\u003e Nothing\n\n```\n\n---\n\n---\n\n## The Elm Architecture(TEA)\n\n- `view`は`model`を受け取って`HTML`を作成する\n- `HTML`から`msg`を投げ、`update`が現在の`model`と`msg`から新しい`model`を作成する\n- 新しい`model`から再度`HTML`を作成する\n\n```elm\nsandbox :\n    { init : model\n    , view : model -\u003e Html msg\n    , update : msg -\u003e model -\u003e model\n    }\n    -\u003e Program () model msg\n```\n\n---\n\n### sandbox のライフサイクル\n\n![Browser.sandbox](https://guide.elm-lang.org/effects/diagrams/sandbox.svg)\n\n---\n\n### カヌンターアプリの例\n\n- `+` ボタンと `-` ボタンがあるカウンター\n- https://elm-lang.org/examples/buttons\n- モデルの初期値は 0\n- update と view はそれぞれの名前の関数\n\n```elm\nsandbox :\n    { init : model\n    , view : model -\u003e Html msg\n    , update : msg -\u003e model -\u003e model\n    }\n    -\u003e Program () model msg\n\nmain : Program () Int Msg\nmain =\n  Browser.sandbox { init = 0, update = update, view = view }\n```\n\n---\n\n### まずはメッセージの型定義から\n\n- Msg は Increment と Decrement の二つ\n- Increment が来たら model を +1 する\n- Decrement が来たら model を -1 する\n- RunTime System が update の返り値を受け取り現在のモデルを更新する\n\n```elm\ntype Msg = Increment | Decrement\n\nupdate : Msg -\u003e Int -\u003e Int\nupdate msg model =\n  case msg of\n    Increment -\u003e\n      model + 1\n\n    Decrement -\u003e\n      model - 1\n```\n\n---\n\n### 描画に使う関数\n\n- HTML タグ のタグも関数で定義されている\n- div の第一引数は Attribute msg のリスト\n- div の第二引数は Html msg のリスト\n- onClick の引数に msg を渡すと、クリックされた時にそのメッセージを投げる\n- text は文字列の描画用の関数\n- 型変数になっている部分は型推論で解決される\n\n```elm\ndiv : List (Attribute msg) -\u003e List (Html msg) -\u003e Html msg\nbutton : List (Attribute msg) -\u003e List (Html msg) -\u003e Html msg\nonClick : msg -\u003e Attribute msg\ntext : String -\u003e Html msg\n```\n\n---\n\n### 描画部分\n\n- さっきの関数を使って view を構成する\n\n```elm\nview : Int -\u003e Html Msg\nview model =\n  div []\n    [ button [ onClick Decrement ] [ text \"-\" ]\n    , div [] [ text (String.fromInt model) ]\n    , button [ onClick Increment ] [ text \"+\" ]\n    ]\n```\n\n---\n\n### 副作用を扱う例(Cat gifs)\n\n- 猫の GIF 画像をランダムに取得し描画するアプリ\n- https://elm-lang.org/examples/cat-gifs\n- `element` を使う\n\n---\n\n### Browser.element\n\n- `view`は変わらない\n- `update`の返り値が `model`から`(model, Cmd msg)`に変更\n- 外部からのイベントを扱う `subscriptions` が追加(今回は扱いません)\n\n```elm\nelement :\n    { init : flags -\u003e ( model, Cmd msg )\n    , view : model -\u003e Html msg\n    , update : msg -\u003e model -\u003e ( model, Cmd msg )\n    , subscriptions : model -\u003e Sub msg\n    }\n    -\u003e Program flags model msg\n```\n\n---\n\n### Cmd とは\n\n- 主に副作用を扱う(e.g. HTTP リクエスト, 乱数生成, 現在時の取得)\n- 実行した結果 `Cmd msg` を返し、その`msg`が `Runtime System` によって `update`に渡される\n\n---\n\n### 副作用を扱った場合のライフサイクル\n\n![Browser.element](https://guide.elm-lang.org/effects/diagrams/element.svg)\n\n---\n\n### Cat Gifs の Msg\n\n- 再度猫 Gif を取得する MorePlease\n- 猫 Gif の取得した結果を表す GotGif (Result Http.Error String)\n- Result error value 型は成功・失敗を表すことが出来る\n\n```elm\ntype Msg\n  = MorePlease\n  | GotGif (Result Http.Error String)\n```\n\n---\n\n### Cat Gif の Model\n\n- 猫画像取に失敗したら Failure\n- 取得中は Loading\n- 取得に成功したら Success に 猫 Gif の URL を文字列で持つ\n\n```elm\ntype Model\n  = Failure\n  | Loading\n  | Success String\n```\n\n---\n\n### Cat Gif の Initialize phase\n\n- モデルの初期値は Loading\n- getRandomCatGif で猫 Gif を取得する\n- Http.get の返り値の型が Cmd msg なので Cmd を強制される\n\n```elm\ninit : () -\u003e (Model, Cmd Msg)\ninit _ =\n  (Loading, getRandomCatGif)\n\nget : { url : String, expect : Expect msg } -\u003e Cmd msg\n\ngetRandomCatGif : Cmd Msg\ngetRandomCatGif =\n  Http.get\n    { url = \"https://api.giphy.com/v1/gifs/random?api_key=dc6zaTOxFJmzC\u0026tag=cat\"\n    , expect = Http.expectJson GotGif gifDecoder\n    }\n```\n\n---\n\n### Cat Gif の更新 phase\n\n- MorePlease メッセージなら Loading 状態にして猫 Gif を取得しにいく\n- 取得した結果、成功していればモデルに URL を入れて描画、失敗していれば Failure 画面に\n\n```elm\nupdate : Msg -\u003e Model -\u003e (Model, Cmd Msg)\nupdate msg model =\n  case msg of\n    MorePlease -\u003e\n      (Loading, getRandomCatGif)\n\n    GotGif result -\u003e\n      case result of\n        Ok url -\u003e\n          (Success url, Cmd.none)\n\n        Err _ -\u003e\n          (Failure, Cmd.none)\n```\n\n---\n\n### Cat Gif の描画\n\n- view でもパターンマッチで状態を網羅して描画しているかが検査できる\n\n```elm\nview : Model -\u003e Html Msg\nview model =\n  div []\n    [ h2 [] [ text \"Random Cats\" ]\n    , viewGif model\n    ]\n\nviewGif : Model -\u003e Html Msg\nviewGif model =\n  case model of\n    Failure -\u003e\n      div []\n        [ text \"I could not load a random cat for some reason. \"\n        , button [ onClick MorePlease ] [ text \"Try Again!\" ]\n        ]\n\n    Loading -\u003e\n      text \"Loading...\"\n\n    Success url -\u003e\n      div []\n        [ button [ onClick MorePlease, style \"display\" \"block\" ] [ text \"More Please!\" ]\n        , img [ src url ] []\n        ]\n```\n\n---\n\n### TEA\n\n- 副作用を扱わない場合 model, update, message, view によって構成される\n- view から message を投げ、その message に合わせて model を更新する\n- 副作用を扱う場合は update から副作用(Cmd)を実行し、Cmd からまた message を投げ update で受け取る\n- 今回は見ていないけれど、外部からの入力(時間によって発するイベントや websocket のイベントなど\\*\\*は subscription で扱う\n\n---\n\n## まとめ\n\n- Elm の基本的なところを紹介しました\n- TEA を紹介しました\n- 簡潔な型定義とパターンマッチで安全にフロントエンドが開発できるよ！\n"}},"__N_SSG":true},"page":"/slides/[slug]","query":{"slug":"getting-started-with-elm"},"buildId":"UwCaGKmzBpbdZ13-mi1wQ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>