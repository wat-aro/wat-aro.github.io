{"pageProps":{"post":{"data":{"title":"X1 Carbon Gen 7th に Arch Linux をインストール","published":"2020/02/11","tags":["Arch"]},"content":"\n<p>基本的にはインストールガイドのとおり\n<a href=\"https://wiki.archlinux.jp/index.php/\">https://wiki.archlinux.jp/index.php/</a>インストールガイド\nWindowManager は <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/XMonad\">XMonad</a></p>\n\n<h2><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D1%A1%BC%A5%C6%A5%A3%A5%B7%A5%E7%A5%F3\">パーティション</a></h2>\n\n<p>funtoo を参考\n<a href=\"https://www.funtoo.org/Install/GPT_Partitioning\">https://www.funtoo.org/Install/GPT_Partitioning</a></p>\n\n<h2>フォーマット</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># mkfs.fat -F32 /dev/nvme0n1p1 # ESP\n# fatlabel /dev/nvme0n1p1 efi\n# mkfs.btrfs -L root /dev/nvme0n1p3 # Root\n# mkswap /dev/nvme0n1p2\n# swapon /dev/nvme0n1p2</pre>\n\n\n<h2>マウント</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># mount /dev/nvme0n1p3 /mnt\n# mkdir /mnt/boot\n# mount /dev/nvme0n1p1 /mnt/boot</pre>\n\n\n<h2>システムクロックの更新</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># timedatectl set-ntp true</pre>\n\n\n<h2>インストール</h2>\n\n<p>Japanのミラーのみを使うように変更</p>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># vim /etc/pacman.d/mirrorlist</pre>\n\n\n\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># pacstrap /mnt base linux linux-firmware</pre>\n\n\n<h2>システムの設定</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># genfstab -L /mnt &gt;&gt; /mnt/etc/fstab\n# cat /mnt/etc/fstab</pre>\n\n\n<h2><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/chroot\">chroot</a></h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># arch-chroot /mnt</pre>\n\n\n<h2><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BF%A5%A4%A5%E0%A5%BE%A1%BC%A5%F3\">タイムゾーン</a></h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n# hwclock --systohc --utc</pre>\n\n\n<h2><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%ED%A5%B1%A1%BC%A5%EB\">ロケール</a></h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># pacman -S neovim\n# nvim /etc/locale.gen</pre>\n\n\n<p><code>ja_JP.UTF-8 UTF-8</code> と <code>en_US.UTF-8 UTF-8</code> をアンコメント</p>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># locale-gen\n# echo LANG=en_US.UTF-8 &gt; /etc/locale.conf</pre>\n\n\n<h2>ネットワーク</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># pacman -S networkmanager\n# systemctl enable NetworkManager.service</pre>\n\n\n<h2>Rootパスワード</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># passwd</pre>\n\n\n<h2>ブート</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># pacman -S efibootmgr\n# efibootmgr -d /dev/nvme0n1 -p 1 -c -L &#34;Arch Linux&#34; -l /vmlinuz-linux -u &#34;root=/dev/nvme0n1p3 rw initrd=/initramfs-linux.img&#34;\n# exit\n# reboot</pre>\n\n\n<h2>ユーザ追加</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># pass\n# useradd -m -g users -G wheel -s /bin/bash wat-aro\n# passwd wat-aro\n# groupadd wat-aro\n# gpasswd -a wat-aro wat-aro\nid wat-aro</pre>\n\n\n<h2>sudo</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink># pacman -S sudo\n# EDITOR=nvim visudo</pre>\n\n\n<p>以下を追記</p>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink>%wheel ALL=(ALL) ALL</pre>\n\n\n<h2>Yay</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink>$ sudo pacman -S git\n$ sudo pacman -S base-devel\n$ git clone https://aur.archlinux.org/yay.git\n$ cd yay\n$ makepkg -si</pre>\n\n\n<h2>man</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink>$ yay -S man-db\n$ mandb</pre>\n\n\n<h2><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Xorg\">Xorg</a></h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink>$ yay -S xorg-server\n$ lspci | grep -e VGA -e 3D\n$ yay -S xf86-video-intel\n$ yay -S xorg-xrdb rxvt-unicode xorg-xmodmap</pre>\n\n\n<h2><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GUI\">GUI</a> 準備</h2>\n\n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/uim\">uim</a> の設定が終わるまで <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/xmonad\">xmonad</a> がちゃんと動かない</p>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink>$ git clone https://github.com/wat-aro/dotfiles\n$ cd dotfiles\n$ ./install.sh\n$ yay -S xmonad xmonad-contrib dmenu xmobar\n$ xmonad --recompile</pre>\n\n\n<h2>日本語入力</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink>$ yay -S uim anthy gtk3\n$ uim-pref-gtk3</pre>\n\n\n<h2>ブラウザ</h2>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink>$ yay -S noto-fonts noto-fonts-cjk noto-fonts-emoji\n$ yay -S google-chrome</pre>\n\n\n<h2>フォント</h2>\n\n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ricty\">Ricty</a> を手動で入れる</p>\n\n<h2>LightDM</h2>\n\n<p><a href=\"https://wiki.archlinux.jp/index.php/LightDM\">LightDM - ArchWiki</a></p>\n\n<p><a href=\"https://qiita.com/Hayao0819/items/7784178c7fd568291905\">&#x3010;ArchLinux&#x3011;&#x6700;&#x9AD8;&#x306E;&#x30ED;&#x30B0;&#x30A4;&#x30F3;&#x753B;&#x9762; - Qiita</a></p>\n\n<p>を参考</p>\n\n<h2>オーディオ</h2>\n\n<p>オーディオを有効にするためには <code>sof-firmware</code> も必要</p>\n\n<p><a href=\"https://www.reddit.com/r/archlinux/comments/e5rpxv/thinkpad_x1_carbon_gen_7_audio_broken_on_541arch11/\">Thinkpad X1 Carbon Gen 7 audio broken on 5.4.1-arch1-1 : archlinux</a></p>\n\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink>$ yay -S alsa-utils sof-firmware pulseaudio pavucontrol</pre>\n\n\n","slug":"X1 Carbon Gen 7th に Arch Linux をインストール"},"content":"<p>基本的にはインストールガイドのとおり\n<a href=\"https://wiki.archlinux.jp/index.php/\">https://wiki.archlinux.jp/index.php/</a>インストールガイド\nWindowManager は <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/XMonad\">XMonad</a></p>\n<h2 id=\"パーティション\"><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D1%A1%BC%A5%C6%A5%A3%A5%B7%A5%E7%A5%F3\">パーティション</a></h2>\n<p>funtoo を参考\n<a href=\"https://www.funtoo.org/Install/GPT_Partitioning\">https://www.funtoo.org/Install/GPT_Partitioning</a></p>\n<h2 id=\"フォーマット\">フォーマット</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># mkfs.fat -F32 /dev/nvme0n1p1 # ESP\n</span><span class=\"code-line\"># fatlabel /dev/nvme0n1p1 efi\n</span><span class=\"code-line\"># mkfs.btrfs -L root /dev/nvme0n1p3 # Root\n</span><span class=\"code-line\"># mkswap /dev/nvme0n1p2\n</span><span class=\"code-line\"># swapon /dev/nvme0n1p2</span></code></pre>\n<h2 id=\"マウント\">マウント</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># mount /dev/nvme0n1p3 /mnt\n</span><span class=\"code-line\"># mkdir /mnt/boot\n</span><span class=\"code-line\"># mount /dev/nvme0n1p1 /mnt/boot</span></code></pre>\n<h2 id=\"システムクロックの更新\">システムクロックの更新</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># timedatectl set-ntp true</span></code></pre>\n<h2 id=\"インストール\">インストール</h2>\n<p>Japanのミラーのみを使うように変更</p>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># vim /etc/pacman.d/mirrorlist</span></code></pre>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># pacstrap /mnt base linux linux-firmware</span></code></pre>\n<h2 id=\"システムの設定\">システムの設定</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># genfstab -L /mnt >> /mnt/etc/fstab\n</span><span class=\"code-line\"># cat /mnt/etc/fstab</span></code></pre>\n<h2 id=\"chroot\"><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/chroot\">chroot</a></h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># arch-chroot /mnt</span></code></pre>\n<h2 id=\"タイムゾーン\"><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BF%A5%A4%A5%E0%A5%BE%A1%BC%A5%F3\">タイムゾーン</a></h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n</span><span class=\"code-line\"># hwclock --systohc --utc</span></code></pre>\n<h2 id=\"ロケール\"><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%ED%A5%B1%A1%BC%A5%EB\">ロケール</a></h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># pacman -S neovim\n</span><span class=\"code-line\"># nvim /etc/locale.gen</span></code></pre>\n<p><code>ja_JP.UTF-8 UTF-8</code> と <code>en_US.UTF-8 UTF-8</code> をアンコメント</p>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># locale-gen\n</span><span class=\"code-line\"># echo LANG=en_US.UTF-8 > /etc/locale.conf</span></code></pre>\n<h2 id=\"ネットワーク\">ネットワーク</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># pacman -S networkmanager\n</span><span class=\"code-line\"># systemctl enable NetworkManager.service</span></code></pre>\n<h2 id=\"rootパスワード\">Rootパスワード</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># passwd</span></code></pre>\n<h2 id=\"ブート\">ブート</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># pacman -S efibootmgr\n</span><span class=\"code-line\"># efibootmgr -d /dev/nvme0n1 -p 1 -c -L \"Arch Linux\" -l /vmlinuz-linux -u \"root=/dev/nvme0n1p3 rw initrd=/initramfs-linux.img\"\n</span><span class=\"code-line\"># exit\n</span><span class=\"code-line\"># reboot</span></code></pre>\n<h2 id=\"ユーザ追加\">ユーザ追加</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># pass\n</span><span class=\"code-line\"># useradd -m -g users -G wheel -s /bin/bash wat-aro\n</span><span class=\"code-line\"># passwd wat-aro\n</span><span class=\"code-line\"># groupadd wat-aro\n</span><span class=\"code-line\"># gpasswd -a wat-aro wat-aro\n</span><span class=\"code-line\">id wat-aro</span></code></pre>\n<h2 id=\"sudo\">sudo</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"># pacman -S sudo\n</span><span class=\"code-line\"># EDITOR=nvim visudo</span></code></pre>\n<p>以下を追記</p>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">%wheel ALL=(ALL) ALL</span></code></pre>\n<h2 id=\"yay\">Yay</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">$ sudo pacman -S git\n</span><span class=\"code-line\">$ sudo pacman -S base-devel\n</span><span class=\"code-line\">$ git clone https://aur.archlinux.org/yay.git\n</span><span class=\"code-line\">$ cd yay\n</span><span class=\"code-line\">$ makepkg -si</span></code></pre>\n<h2 id=\"man\">man</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">$ yay -S man-db\n</span><span class=\"code-line\">$ mandb</span></code></pre>\n<h2 id=\"xorg\"><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Xorg\">Xorg</a></h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">$ yay -S xorg-server\n</span><span class=\"code-line\">$ lspci | grep -e VGA -e 3D\n</span><span class=\"code-line\">$ yay -S xf86-video-intel\n</span><span class=\"code-line\">$ yay -S xorg-xrdb rxvt-unicode xorg-xmodmap</span></code></pre>\n<h2 id=\"gui-準備\"><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GUI\">GUI</a> 準備</h2>\n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/uim\">uim</a> の設定が終わるまで <a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/xmonad\">xmonad</a> がちゃんと動かない</p>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">$ git clone https://github.com/wat-aro/dotfiles\n</span><span class=\"code-line\">$ cd dotfiles\n</span><span class=\"code-line\">$ ./install.sh\n</span><span class=\"code-line\">$ yay -S xmonad xmonad-contrib dmenu xmobar\n</span><span class=\"code-line\">$ xmonad --recompile</span></code></pre>\n<h2 id=\"日本語入力\">日本語入力</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">$ yay -S uim anthy gtk3\n</span><span class=\"code-line\">$ uim-pref-gtk3</span></code></pre>\n<h2 id=\"ブラウザ\">ブラウザ</h2>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">$ yay -S noto-fonts noto-fonts-cjk noto-fonts-emoji\n</span><span class=\"code-line\">$ yay -S google-chrome</span></code></pre>\n<h2 id=\"フォント\">フォント</h2>\n<p><a class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ricty\">Ricty</a> を手動で入れる</p>\n<h2 id=\"lightdm\">LightDM</h2>\n<p><a href=\"https://wiki.archlinux.jp/index.php/LightDM\">LightDM - ArchWiki</a></p>\n<p><a href=\"https://qiita.com/Hayao0819/items/7784178c7fd568291905\">【ArchLinux】最高のログイン画面 - Qiita</a></p>\n<p>を参考</p>\n<h2 id=\"オーディオ\">オーディオ</h2>\n<p>オーディオを有効にするためには <code>sof-firmware</code> も必要</p>\n<p><a href=\"https://www.reddit.com/r/archlinux/comments/e5rpxv/thinkpad_x1_carbon_gen_7_audio_broken_on_541arch11/\">Thinkpad X1 Carbon Gen 7 audio broken on 5.4.1-arch1-1 : archlinux</a></p>\n<pre class=\"code shell\" data-lang=\"shell\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">$ yay -S alsa-utils sof-firmware pulseaudio pavucontrol</span></code></pre>"},"__N_SSG":true}