{"pageProps":{"post":{"data":{"title":"SICP 問題 2.74","published":"2015/10/30","tags":["scheme","SICP"]},"content":"\n\n<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink><span class=\"synComment\">;; a</span>\n<span class=\"synComment\">;; 各事業所ごとに従業員ファイルを作っていると考え，person-fileのcar部に</span>\n<span class=\"synComment\">;; 従業所を識別するコードを入れるようにする．</span>\n<span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>get-record name  person-file<span class=\"synSpecial\">)</span>\n  <span class=\"synSpecial\">((</span>get <span class=\"synSpecial\">'</span>get-record <span class=\"synSpecial\">(</span>division person-file<span class=\"synSpecial\">))</span> name file<span class=\"synSpecial\">))</span>\n\n<span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>division file<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> file<span class=\"synSpecial\">))</span>\n\n<span class=\"synComment\">;; b</span>\n<span class=\"synComment\">;; ここではrecordが(name salary age)となってると考える．</span>\n<span class=\"synComment\">;; この事業所のrecordからsalaryを取り出すにはcadrを取れば良い</span>\n<span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>get-salary name record<span class=\"synSpecial\">)</span>\n  <span class=\"synSpecial\">((</span>get <span class=\"synSpecial\">'</span>get-salary <span class=\"synSpecial\">(</span>identifying person-file<span class=\"synSpecial\">))</span> record<span class=\"synSpecial\">))</span>\n\n<span class=\"synComment\">;; c</span>\n<span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>find-employee-record name division-list<span class=\"synSpecial\">)</span>\n  <span class=\"synSpecial\">(</span><span class=\"synStatement\">if</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">null?</span> division-list<span class=\"synSpecial\">)</span>\n      false\n      <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>serch <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">((</span>get <span class=\"synSpecial\">'</span>get-record <span class=\"synSpecial\">(</span>division x<span class=\"synSpecial\">))</span> name x<span class=\"synSpecial\">))))</span>\n        <span class=\"synSpecial\">(</span><span class=\"synStatement\">if</span> <span class=\"synSpecial\">(</span>serch <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> division-list<span class=\"synSpecial\">))</span>\n            <span class=\"synSpecial\">(</span>serch <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> division-list<span class=\"synSpecial\">))</span>\n            <span class=\"synSpecial\">(</span>find-employee-record name <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cdr</span> division-list<span class=\"synSpecial\">))))))</span>\n\n<span class=\"synComment\">;; d</span>\n<span class=\"synComment\">;; その新しく合併した会社の従業員レコードから情報を得るget-recordとget-salaryなどの</span>\n<span class=\"synComment\">;; 必要な手続きを作りパッケージを作成し，本社の表にputすればよい．</span>\n</pre>\n\n\n","slug":"SICP 問題 2.74"},"content":"<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"><span class=\"synComment\">;; a</span>\n</span><span class=\"code-line\"><span class=\"synComment\">;; 各事業所ごとに従業員ファイルを作っていると考え，person-fileのcar部に</span>\n</span><span class=\"code-line\"><span class=\"synComment\">;; 従業所を識別するコードを入れるようにする．</span>\n</span><span class=\"code-line\"><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>get-record name  person-file<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">((</span>get <span class=\"synSpecial\">'</span>get-record <span class=\"synSpecial\">(</span>division person-file<span class=\"synSpecial\">))</span> name file<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>division file<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> file<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"synComment\">;; b</span>\n</span><span class=\"code-line\"><span class=\"synComment\">;; ここではrecordが(name salary age)となってると考える．</span>\n</span><span class=\"code-line\"><span class=\"synComment\">;; この事業所のrecordからsalaryを取り出すにはcadrを取れば良い</span>\n</span><span class=\"code-line\"><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>get-salary name record<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">((</span>get <span class=\"synSpecial\">'</span>get-salary <span class=\"synSpecial\">(</span>identifying person-file<span class=\"synSpecial\">))</span> record<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"synComment\">;; c</span>\n</span><span class=\"code-line\"><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>find-employee-record name division-list<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">(</span><span class=\"synStatement\">if</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">null?</span> division-list<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">      false\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>serch <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">((</span>get <span class=\"synSpecial\">'</span>get-record <span class=\"synSpecial\">(</span>division x<span class=\"synSpecial\">))</span> name x<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span><span class=\"synStatement\">if</span> <span class=\"synSpecial\">(</span>serch <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> division-list<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">            <span class=\"synSpecial\">(</span>serch <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> division-list<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">            <span class=\"synSpecial\">(</span>find-employee-record name <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cdr</span> division-list<span class=\"synSpecial\">))))))</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"synComment\">;; d</span>\n</span><span class=\"code-line\"><span class=\"synComment\">;; その新しく合併した会社の従業員レコードから情報を得るget-recordとget-salaryなどの</span>\n</span><span class=\"code-line\"><span class=\"synComment\">;; 必要な手続きを作りパッケージを作成し，本社の表にputすればよい．</span>\n</span></code></pre>"},"__N_SSG":true}