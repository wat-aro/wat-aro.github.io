{"pageProps":{"post":{"data":{"title":"SICP 問題 2.79","published":"2015/10/31","tags":["scheme","SICP"]},"content":"\n\n<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink><span class=\"synComment\">;; scheme-numberパッケージに追加</span>\n<span class=\"synSpecial\">(</span>put <span class=\"synSpecial\">'</span>equ? <span class=\"synSpecial\">'(</span>scheme-number scheme-number<span class=\"synSpecial\">)</span>\n       <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>tag <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> x y<span class=\"synSpecial\">))))</span>\n\n<span class=\"synComment\">;; rationalパッケージに追加</span>\n<span class=\"synSpecial\">(</span>put <span class=\"synSpecial\">'</span>equ? <span class=\"synSpecial\">'(</span>rational rational<span class=\"synSpecial\">)</span>\n       <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">and</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> <span class=\"synSpecial\">(</span>numer x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>numer y<span class=\"synSpecial\">))</span>\n                          <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> <span class=\"synSpecial\">(</span>denom x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>denom y<span class=\"synSpecial\">)))))</span>\n<span class=\"synComment\">;; complexパッケージに追加</span>\n<span class=\"synSpecial\">(</span>put <span class=\"synSpecial\">'</span>equ <span class=\"synSpecial\">'(</span>complex complex<span class=\"synSpecial\">)</span>\n     <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">and</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">real-part</span> x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">real-part</span> y<span class=\"synSpecial\">))</span>\n                        <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">imag-part</span> x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">imag-part</span> y<span class=\"synSpecial\">)))))</span>\n\n\n<span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>equ? x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>apply-generic <span class=\"synSpecial\">'</span>equ? x y<span class=\"synSpecial\">))</span>\n</pre>\n\n\n","slug":"SICP 問題 2.79"},"content":"<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"><span class=\"synComment\">;; scheme-numberパッケージに追加</span>\n</span><span class=\"code-line\"><span class=\"synSpecial\">(</span>put <span class=\"synSpecial\">'</span>equ? <span class=\"synSpecial\">'(</span>scheme-number scheme-number<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">       <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>tag <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> x y<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"synComment\">;; rationalパッケージに追加</span>\n</span><span class=\"code-line\"><span class=\"synSpecial\">(</span>put <span class=\"synSpecial\">'</span>equ? <span class=\"synSpecial\">'(</span>rational rational<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">       <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">and</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> <span class=\"synSpecial\">(</span>numer x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>numer y<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">                          <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> <span class=\"synSpecial\">(</span>denom x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>denom y<span class=\"synSpecial\">)))))</span>\n</span><span class=\"code-line\"><span class=\"synComment\">;; complexパッケージに追加</span>\n</span><span class=\"code-line\"><span class=\"synSpecial\">(</span>put <span class=\"synSpecial\">'</span>equ <span class=\"synSpecial\">'(</span>complex complex<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">     <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">and</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">real-part</span> x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">real-part</span> y<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">                        <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">=</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">imag-part</span> x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">imag-part</span> y<span class=\"synSpecial\">)))))</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>equ? x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>apply-generic <span class=\"synSpecial\">'</span>equ? x y<span class=\"synSpecial\">))</span>\n</span></code></pre>"},"__N_SSG":true}