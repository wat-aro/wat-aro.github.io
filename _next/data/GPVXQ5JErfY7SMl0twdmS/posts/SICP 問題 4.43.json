{"pageProps":{"post":{"title":"SICP 問題 4.43","published":"2016/01/12","tags":["scheme","SICP"],"content":"\n<p>まずは素直に問題文に出てくる通りに書いてみる．</p>\n\n<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>kansas-state-enginner<span class=\"synSpecial\">)</span>\n  <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>moore <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                     <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n        <span class=\"synSpecial\">(</span>downing <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                       <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n        <span class=\"synSpecial\">(</span>hall <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                    <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n        <span class=\"synSpecial\">(</span>barnacle-hood <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                    <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n        <span class=\"synSpecial\">(</span>parker <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                      <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n        <span class=\"synSpecial\">(</span>daughter <span class=\"synIdentifier\">car</span><span class=\"synSpecial\">)</span>\n        <span class=\"synSpecial\">(</span>yacht <span class=\"synIdentifier\">cdr</span><span class=\"synSpecial\">))</span>\n    <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>father-list moore hall downing barnacle-hood parker<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? father-list<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">fold-left</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">and</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yacht x<span class=\"synSpecial\">)))</span> y<span class=\"synSpecial\">))</span>\n                     <span class=\"synConstant\">#t</span> father-list<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter moore<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>mary<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>gabrielle<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht moore<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>Lorna<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht hall<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>rosalind<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht downing<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter parker<span class=\"synSpecial\">)</span>\n                    <span class=\"synSpecial\">(</span>yocht <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">filter</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>gabrielle<span class=\"synSpecial\">))</span>\n                                        father-list<span class=\"synSpecial\">)))))</span>\n      <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> <span class=\"synSpecial\">'</span>moore moore <span class=\"synSpecial\">'</span>downing downing <span class=\"synSpecial\">'</span>hall hall <span class=\"synSpecial\">'</span>barnacle-hood barnacle-hood <span class=\"synSpecial\">'</span>parker parker<span class=\"synSpecial\">))))</span>\n</pre>\n\n\n<p>次はこれを効率的になるように並び替える．</p>\n\n<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>kansas-state-enginner<span class=\"synSpecial\">)</span>\n  <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>moore <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                     <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n        <span class=\"synSpecial\">(</span>daughter <span class=\"synIdentifier\">car</span><span class=\"synSpecial\">)</span>\n        <span class=\"synSpecial\">(</span>yacht <span class=\"synIdentifier\">cdr</span><span class=\"synSpecial\">))</span>\n    <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter moore<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>mary<span class=\"synSpecial\">))</span>\n    <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht moore<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>Lorna<span class=\"synSpecial\">))</span>\n    <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>downing <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                         <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> moore downing<span class=\"synSpecial\">)))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht downing<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))</span>\n      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter downing<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yocht downing<span class=\"synSpecial\">))))</span>\n      <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>hall <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                        <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))))</span>\n        <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> moore downing hall<span class=\"synSpecial\">)))</span>\n        <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter hall<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yocht hall<span class=\"synSpecial\">))))</span>\n        <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht hall<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>rosalind<span class=\"synSpecial\">))</span>\n        <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>barnacle-hood <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                                   <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))))</span>\n          <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? moore downing hall barnacle-hood<span class=\"synSpecial\">))</span>\n          <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yocht barnacle-hood<span class=\"synSpecial\">))))</span>\n          <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))</span>\n          <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>gabrielle<span class=\"synSpecial\">))</span>\n          <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>parker <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n                              <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))))</span>\n            <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> moore downing hall barnacle-hood parker<span class=\"synSpecial\">)))</span>\n            <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter parker<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yocht parker<span class=\"synSpecial\">))))</span>\n            <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter parker<span class=\"synSpecial\">)</span>\n                    <span class=\"synSpecial\">(</span>yocht <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">filter</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>gabrielle<span class=\"synSpecial\">))</span>\n                                        father-list<span class=\"synSpecial\">)))))</span>\n            <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> <span class=\"synSpecial\">'</span>moore moore <span class=\"synSpecial\">'</span>downing downing <span class=\"synSpecial\">'</span>hall hall <span class=\"synSpecial\">'</span>barnacle-hood barnacle-hood <span class=\"synSpecial\">'</span>parker parker<span class=\"synSpecial\">)))))))</span>\n</pre>\n\n\n","slug":"SICP 問題 4.43"},"content":"<p>まずは素直に問題文に出てくる通りに書いてみる．</p>\n<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>kansas-state-enginner<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>moore <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                     <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>downing <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                       <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>hall <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                    <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>barnacle-hood <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                    <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>parker <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                      <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>daughter <span class=\"synIdentifier\">car</span><span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>yacht <span class=\"synIdentifier\">cdr</span><span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">    <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>father-list moore hall downing barnacle-hood parker<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? father-list<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">fold-left</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x y<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">and</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yacht x<span class=\"synSpecial\">)))</span> y<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">                     <span class=\"synConstant\">#t</span> father-list<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter moore<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>mary<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>gabrielle<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht moore<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>Lorna<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht hall<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>rosalind<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht downing<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter parker<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                    <span class=\"synSpecial\">(</span>yocht <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">filter</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>gabrielle<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">                                        father-list<span class=\"synSpecial\">)))))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> <span class=\"synSpecial\">'</span>moore moore <span class=\"synSpecial\">'</span>downing downing <span class=\"synSpecial\">'</span>hall hall <span class=\"synSpecial\">'</span>barnacle-hood barnacle-hood <span class=\"synSpecial\">'</span>parker parker<span class=\"synSpecial\">))))</span>\n</span></code></pre>\n<p>次はこれを効率的になるように並び替える．</p>\n<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>kansas-state-enginner<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>moore <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                     <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>daughter <span class=\"synIdentifier\">car</span><span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>yacht <span class=\"synIdentifier\">cdr</span><span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">    <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter moore<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>mary<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">    <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht moore<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>Lorna<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">    <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>downing <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                         <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> moore downing<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht downing<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter downing<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yocht downing<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">      <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>hall <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                        <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> moore downing hall<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter hall<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yocht hall<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht hall<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>rosalind<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>barnacle-hood <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                                   <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">          <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? moore downing hall barnacle-hood<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">          <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yocht barnacle-hood<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">          <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">          <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>yocht barnacle-hood<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>gabrielle<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">          <span class=\"synSpecial\">(</span><span class=\"synStatement\">let</span> <span class=\"synSpecial\">((</span>parker <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">cons</span> <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                              <span class=\"synSpecial\">(</span>amb <span class=\"synSpecial\">'</span>mary <span class=\"synSpecial\">'</span>gabrielle <span class=\"synSpecial\">'</span>lorna <span class=\"synSpecial\">'</span>rosalind <span class=\"synSpecial\">'</span>melissa<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">            <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span>distinct? <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> moore downing hall barnacle-hood parker<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">            <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">not</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter parker<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span>yocht parker<span class=\"synSpecial\">))))</span>\n</span><span class=\"code-line\">            <span class=\"synSpecial\">(</span>require <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter parker<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">                    <span class=\"synSpecial\">(</span>yocht <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">car</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">filter</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">lambda</span> <span class=\"synSpecial\">(</span>x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> <span class=\"synSpecial\">(</span>daughter x<span class=\"synSpecial\">)</span> <span class=\"synSpecial\">'</span>gabrielle<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">                                        father-list<span class=\"synSpecial\">)))))</span>\n</span><span class=\"code-line\">            <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">list</span> <span class=\"synSpecial\">'</span>moore moore <span class=\"synSpecial\">'</span>downing downing <span class=\"synSpecial\">'</span>hall hall <span class=\"synSpecial\">'</span>barnacle-hood barnacle-hood <span class=\"synSpecial\">'</span>parker parker<span class=\"synSpecial\">)))))))</span>\n</span></code></pre>"},"__N_SSG":true}