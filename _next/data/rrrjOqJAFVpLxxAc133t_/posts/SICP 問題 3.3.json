{"pageProps":{"post":{"title":"SICP 問題 3.3","published":"2015/11/05","tags":["scheme","SICP"],"content":"\n\n<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>make-account balance password<span class=\"synSpecial\">)</span>\n  <span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>withdraw amount<span class=\"synSpecial\">)</span>\n    <span class=\"synSpecial\">(</span><span class=\"synStatement\">if</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">&gt;=</span> balance amount<span class=\"synSpecial\">)</span>\n        <span class=\"synSpecial\">(</span><span class=\"synStatement\">begin</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">set!</span> balance <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">-</span> balance amount<span class=\"synSpecial\">))</span>\n               balance<span class=\"synSpecial\">)</span>\n        <span class=\"synConstant\">&quot;Insufficient funds&quot;</span><span class=\"synSpecial\">))</span>\n  <span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>deposit amount<span class=\"synSpecial\">)</span>\n    <span class=\"synSpecial\">(</span><span class=\"synStatement\">set!</span> balance <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">+</span> balance amount<span class=\"synSpecial\">))</span>\n    balance<span class=\"synSpecial\">)</span>\n  <span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>login-error amount<span class=\"synSpecial\">)</span> <span class=\"synConstant\">&quot;Incorrect password&quot;</span><span class=\"synSpecial\">)</span>\n  <span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>dispatch pass m<span class=\"synSpecial\">)</span>\n    <span class=\"synSpecial\">(</span><span class=\"synStatement\">if</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> pass password<span class=\"synSpecial\">)</span>\n        <span class=\"synSpecial\">(</span><span class=\"synStatement\">cond</span> <span class=\"synSpecial\">((</span><span class=\"synIdentifier\">eq?</span> m <span class=\"synSpecial\">'</span>withdraw<span class=\"synSpecial\">)</span> withdraw<span class=\"synSpecial\">)</span>\n              <span class=\"synSpecial\">((</span><span class=\"synIdentifier\">eq?</span> m <span class=\"synSpecial\">'</span>deposit<span class=\"synSpecial\">)</span> deposit<span class=\"synSpecial\">)</span>\n              <span class=\"synSpecial\">(</span><span class=\"synStatement\">else</span> <span class=\"synSpecial\">(</span>error <span class=\"synConstant\">&quot;Unknown request: MAKE-ACCOUNT&quot;</span>\n                           m<span class=\"synSpecial\">)))</span>\n        login-error<span class=\"synSpecial\">))</span>\n  dispatch<span class=\"synSpecial\">)</span>\n</pre>\n\n\n\n\n<pre class=\"code\" data-lang=\"\" data-unlink>gosh&gt; (define acc (make-account 100 &#39;secret-password))\nacc\ngosh&gt; ((acc &#39;secret-password &#39;withdraw) 50)\n50\ngosh&gt; ((acc &#39;some-password &#39;deposit) 40)\n&#34;Incorrect password&#34;</pre>\n\n\n","slug":"SICP 問題 3.3"},"content":"<pre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\"><span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>make-account balance password<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>withdraw amount<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">    <span class=\"synSpecial\">(</span><span class=\"synStatement\">if</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">>=</span> balance amount<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span><span class=\"synStatement\">begin</span> <span class=\"synSpecial\">(</span><span class=\"synStatement\">set!</span> balance <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">-</span> balance amount<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">               balance<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">        <span class=\"synConstant\">\"Insufficient funds\"</span><span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>deposit amount<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">    <span class=\"synSpecial\">(</span><span class=\"synStatement\">set!</span> balance <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">+</span> balance amount<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">    balance<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>login-error amount<span class=\"synSpecial\">)</span> <span class=\"synConstant\">\"Incorrect password\"</span><span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">  <span class=\"synSpecial\">(</span><span class=\"synStatement\">define</span> <span class=\"synSpecial\">(</span>dispatch pass m<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">    <span class=\"synSpecial\">(</span><span class=\"synStatement\">if</span> <span class=\"synSpecial\">(</span><span class=\"synIdentifier\">eq?</span> pass password<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">        <span class=\"synSpecial\">(</span><span class=\"synStatement\">cond</span> <span class=\"synSpecial\">((</span><span class=\"synIdentifier\">eq?</span> m <span class=\"synSpecial\">'</span>withdraw<span class=\"synSpecial\">)</span> withdraw<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">              <span class=\"synSpecial\">((</span><span class=\"synIdentifier\">eq?</span> m <span class=\"synSpecial\">'</span>deposit<span class=\"synSpecial\">)</span> deposit<span class=\"synSpecial\">)</span>\n</span><span class=\"code-line\">              <span class=\"synSpecial\">(</span><span class=\"synStatement\">else</span> <span class=\"synSpecial\">(</span>error <span class=\"synConstant\">\"Unknown request: MAKE-ACCOUNT\"</span>\n</span><span class=\"code-line\">                           m<span class=\"synSpecial\">)))</span>\n</span><span class=\"code-line\">        login-error<span class=\"synSpecial\">))</span>\n</span><span class=\"code-line\">  dispatch<span class=\"synSpecial\">)</span>\n</span></code></pre>\n<pre class=\"code\" data-lang=\"\" data-unlink=\"\"><code class=\"code-highlight\"><span class=\"code-line\">gosh> (define acc (make-account 100 'secret-password))\n</span><span class=\"code-line\">acc\n</span><span class=\"code-line\">gosh> ((acc 'secret-password 'withdraw) 50)\n</span><span class=\"code-line\">50\n</span><span class=\"code-line\">gosh> ((acc 'some-password 'deposit) 40)\n</span><span class=\"code-line\">\"Incorrect password\"</span></code></pre>"},"__N_SSG":true}