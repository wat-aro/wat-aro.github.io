{"pageProps":{"title":"Elm ことはじめ","published":"2019-10-28","content":"<h1><code>Elm</code> ことはじめ</h1>\n<hr>\n<h2>自己紹介</h2>\n<ul>\n<li>wat-aro</li>\n<li>10%の時間では Elm でフロントエンドをやっていました</li>\n<li>関数型が好きです</li>\n</ul>\n<hr>\n<h2>おしながき</h2>\n<ul>\n<li>Elm とは</li>\n<li>文法</li>\n<li>TEA</li>\n<li>まとめ</li>\n</ul>\n<hr>\n<h2>Elm とは</h2>\n<ul>\n<li>静的型付け Alt JS</li>\n<li>A delightfull language</li>\n<li>No Runtime Exception</li>\n<li>Great Peerformance</li>\n<li>Small Assets</li>\n</ul>\n<hr>\n<h3>静的型付けの Alt JS</h3>\n<p>Haskell like な見た目</p>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">map</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">a</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token constant\">List</span> <span class=\"token hvariable\">a</span> <span class=\"token operator\">-></span> <span class=\"token constant\">List</span> <span class=\"token hvariable\">b</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">map</span> <span class=\"token hvariable\">f</span> <span class=\"token hvariable\">list</span> <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token keyword\">case</span> <span class=\"token hvariable\">list</span> <span class=\"token keyword\">of</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">(</span><span class=\"token hvariable\">x</span> <span class=\"token operator\">::</span> <span class=\"token hvariable\">xs</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">f</span> <span class=\"token hvariable\">x</span> <span class=\"token operator\">::</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">map</span> <span class=\"token hvariable\">f</span> <span class=\"token hvariable\">xs</span><span class=\"token punctuation\">)</span>\n</span></code></pre>\n<hr>\n<h3>静的型付けの Alt JS</h3>\n<p>強力な型推論と親切なエラーメッセージ</p>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token operator\">></span> <span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"1\"</span>\n</span><span class=\"code-line\"><span class=\"token comment\">-- TYPE MISMATCH ----------------------------------------------------------- elm</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token constant\">I</span> <span class=\"token hvariable\">cannot</span> <span class=\"token hvariable\">do</span> <span class=\"token hvariable\">addition</span> <span class=\"token hvariable\">with</span> <span class=\"token constant\">String</span> <span class=\"token hvariable\">values</span> <span class=\"token hvariable\">like</span> <span class=\"token hvariable\">this</span> <span class=\"token hvariable\">one</span><span class=\"token operator\">:</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token number\">4</span><span class=\"token operator\">|</span>   <span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"1\"</span>\n</span><span class=\"code-line\">         <span class=\"token operator\">^^^</span>\n</span><span class=\"code-line\"><span class=\"token constant\">The</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token punctuation\">)</span> <span class=\"token hvariable\">operator</span> <span class=\"token hvariable\">only</span> <span class=\"token hvariable\">works</span> <span class=\"token hvariable\">with</span> <span class=\"token constant\">Int</span> <span class=\"token hvariable\">and</span> <span class=\"token constant\">Float</span> <span class=\"token hvariable\">values</span><span class=\"token punctuation\">.</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token constant\">Hint</span><span class=\"token operator\">:</span> <span class=\"token constant\">Switch</span> <span class=\"token hvariable\">to</span> <span class=\"token hvariable\">the</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token hvariable\">operator</span> <span class=\"token hvariable\">to</span> <span class=\"token hvariable\">append</span> <span class=\"token hvariable\">strings</span><span class=\"token operator\">!</span>\n</span></code></pre>\n<hr>\n<h3>A delightful language</h3>\n<p>公式サイトが言ってます</p>\n<p><a href=\"https://gyazo.com/772c9e8c416140a595a7ca586a66a159\"><img src=\"https://i.gyazo.com/772c9e8c416140a595a7ca586a66a159.png\" alt=\"Image from Gyazo\"></a></p>\n<hr>\n<h3>Great Peerformance</h3>\n<p><a href=\"https://gyazo.com/50ecbb1475d7b22a2495ebdc087d59af\"><img src=\"https://i.gyazo.com/50ecbb1475d7b22a2495ebdc087d59af.png\" alt=\"Image from Gyazo\"></a></p>\n<hr>\n<h3>Small Assets</h3>\n<p><a href=\"https://gyazo.com/7e580ab002610cd302a89046d9e28e0a\"><img src=\"https://i.gyazo.com/7e580ab002610cd302a89046d9e28e0a.png\" alt=\"Image from Gyazo\"></a></p>\n<hr>\n<hr>\n<h2>文法</h2>\n<ul>\n<li>デフォルトカリー化</li>\n<li>Haskell-like 型定義</li>\n<li>パターンマッチ</li>\n</ul>\n<hr>\n<h3>デフォルトカリー化</h3>\n<p>ML や Haskell のようにデフォルトでカリー化されている</p>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">add</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Int</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Int</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Int</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">add</span> <span class=\"token hvariable\">x</span> <span class=\"token hvariable\">y</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">x</span> <span class=\"token operator\">+</span> <span class=\"token hvariable\">y</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token hvariable\">add</span> <span class=\"token number\">2</span> <span class=\"token number\">3</span>  <span class=\"token comment\">-- 5</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token hvariable\">add2</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Int</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Int</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">add2</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">add</span> <span class=\"token number\">2</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token hvariable\">add2</span> <span class=\"token number\">3</span> <span class=\"token comment\">-- 5</span>\n</span></code></pre>\n<hr>\n<h3>Haskell-like 型定義</h3>\n<ul>\n<li>Haskell like な型定義</li>\n<li>代数的データ型</li>\n<li>型クラスはない</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token keyword\">type</span> <span class=\"token constant\">Maybe</span> <span class=\"token hvariable\">a</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">=</span> <span class=\"token constant\">Just</span> <span class=\"token hvariable\">a</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">|</span> <span class=\"token constant\">Nothing</span>\n</span></code></pre>\n<p>型アノテーションのコロンは一つ</p>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token number\">42</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Int</span>\n</span><span class=\"code-line\"><span class=\"token string\">\"Hello Elm\"</span> <span class=\"token operator\">:</span> <span class=\"token constant\">String</span>\n</span></code></pre>\n<hr>\n<h3>パターンマッチ</h3>\n<ul>\n<li>型定義に沿った形でパターンマッチができる</li>\n<li>網羅性検査もされるので漏れが出ない</li>\n<li>漏れているとコンパイルエラー</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token keyword\">type</span> <span class=\"token constant\">Maybe</span> <span class=\"token hvariable\">a</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">=</span> <span class=\"token constant\">Just</span> <span class=\"token hvariable\">a</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">|</span> <span class=\"token constant\">Nothing</span>\n</span></code></pre>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">map</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">a</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Maybe</span> <span class=\"token hvariable\">a</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Maybe</span> <span class=\"token hvariable\">b</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">map</span> <span class=\"token hvariable\">f</span> <span class=\"token hvariable\">x</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">case</span> <span class=\"token hvariable\">x</span> <span class=\"token keyword\">of</span>\n</span><span class=\"code-line\">  <span class=\"token constant\">Just</span> <span class=\"token hvariable\">a</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Maybe</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">f</span> <span class=\"token hvariable\">a</span><span class=\"token punctuation\">)</span>\n</span><span class=\"code-line\">  <span class=\"token constant\">Nothing</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Nothing</span>\n</span><span class=\"code-line\">\n</span></code></pre>\n<hr>\n<hr>\n<h2>The Elm Architecture(TEA)</h2>\n<ul>\n<li><code>view</code>は<code>model</code>を受け取って<code>HTML</code>を作成する</li>\n<li><code>HTML</code>から<code>msg</code>を投げ、<code>update</code>が現在の<code>model</code>と<code>msg</code>から新しい<code>model</code>を作成する</li>\n<li>新しい<code>model</code>から再度<code>HTML</code>を作成する</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">sandbox</span> <span class=\"token operator\">:</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">init</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">model</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">view</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">update</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">msg</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">model</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">}</span>\n</span><span class=\"code-line\">    <span class=\"token operator\">-></span> <span class=\"token constant\">Program</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token hvariable\">model</span> <span class=\"token hvariable\">msg</span>\n</span></code></pre>\n<hr>\n<h3>sandbox のライフサイクル</h3>\n<p><img src=\"https://guide.elm-lang.org/effects/diagrams/sandbox.svg\" alt=\"Browser.sandbox\"></p>\n<hr>\n<h3>カヌンターアプリの例</h3>\n<ul>\n<li><code>+</code> ボタンと <code>-</code> ボタンがあるカウンター</li>\n<li><a href=\"https://elm-lang.org/examples/buttons\">https://elm-lang.org/examples/buttons</a></li>\n<li>モデルの初期値は 0</li>\n<li>update と view はそれぞれの名前の関数</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">sandbox</span> <span class=\"token operator\">:</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">init</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">model</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">view</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">update</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">msg</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">model</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">}</span>\n</span><span class=\"code-line\">    <span class=\"token operator\">-></span> <span class=\"token constant\">Program</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token hvariable\">model</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token hvariable\">main</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Program</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">Int</span> <span class=\"token constant\">Msg</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">main</span> <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token hvariable\">Browser.sandbox</span> <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">init</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">update</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">update</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">view</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">view</span> <span class=\"token punctuation\">}</span>\n</span></code></pre>\n<hr>\n<h3>まずはメッセージの型定義から</h3>\n<ul>\n<li>Msg は Increment と Decrement の二つ</li>\n<li>Increment が来たら model を +1 する</li>\n<li>Decrement が来たら model を -1 する</li>\n<li>RunTime System が update の返り値を受け取り現在のモデルを更新する</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token keyword\">type</span> <span class=\"token constant\">Msg</span> <span class=\"token operator\">=</span> <span class=\"token constant\">Increment</span> <span class=\"token operator\">|</span> <span class=\"token constant\">Decrement</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token hvariable\">update</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Msg</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Int</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Int</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">update</span> <span class=\"token hvariable\">msg</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token keyword\">case</span> <span class=\"token hvariable\">msg</span> <span class=\"token keyword\">of</span>\n</span><span class=\"code-line\">    <span class=\"token constant\">Increment</span> <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">      <span class=\"token hvariable\">model</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">    <span class=\"token constant\">Decrement</span> <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">      <span class=\"token hvariable\">model</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n</span></code></pre>\n<hr>\n<h3>描画に使う関数</h3>\n<ul>\n<li>HTML タグ のタグも関数で定義されている</li>\n<li>div の第一引数は Attribute msg のリスト</li>\n<li>div の第二引数は Html msg のリスト</li>\n<li>onClick の引数に msg を渡すと、クリックされた時にそのメッセージを投げる</li>\n<li>text は文字列の描画用の関数</li>\n<li>型変数になっている部分は型推論で解決される</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">div</span> <span class=\"token operator\">:</span> <span class=\"token constant\">List</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Attribute</span> <span class=\"token hvariable\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token constant\">List</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Html</span> <span class=\"token hvariable\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">button</span> <span class=\"token operator\">:</span> <span class=\"token constant\">List</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Attribute</span> <span class=\"token hvariable\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token constant\">List</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Html</span> <span class=\"token hvariable\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">onClick</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">msg</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Attribute</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">text</span> <span class=\"token operator\">:</span> <span class=\"token constant\">String</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token hvariable\">msg</span>\n</span></code></pre>\n<hr>\n<h3>描画部分</h3>\n<ul>\n<li>さっきの関数を使って view を構成する</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">view</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Int</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token constant\">Msg</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">view</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token hvariable\">div</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">button</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">onClick</span> <span class=\"token constant\">Decrement</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token string\">\"-\"</span> <span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">div</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">String.fromInt</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">button</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">onClick</span> <span class=\"token constant\">Increment</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token string\">\"+\"</span> <span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">]</span>\n</span></code></pre>\n<hr>\n<h3>副作用を扱う例(Cat gifs)</h3>\n<ul>\n<li>猫の GIF 画像をランダムに取得し描画するアプリ</li>\n<li><a href=\"https://elm-lang.org/examples/cat-gifs\">https://elm-lang.org/examples/cat-gifs</a></li>\n<li><code>element</code> を使う</li>\n</ul>\n<hr>\n<h3>Browser.element</h3>\n<ul>\n<li><code>view</code>は変わらない</li>\n<li><code>update</code>の返り値が <code>model</code>から<code>(model, Cmd msg)</code>に変更</li>\n<li>外部からのイベントを扱う <code>subscriptions</code> が追加(今回は扱いません)</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">element</span> <span class=\"token operator\">:</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">init</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">flags</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token hvariable\">msg</span> <span class=\"token punctuation\">)</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">view</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">update</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">msg</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token hvariable\">msg</span> <span class=\"token punctuation\">)</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">subscriptions</span> <span class=\"token operator\">:</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Sub</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">}</span>\n</span><span class=\"code-line\">    <span class=\"token operator\">-></span> <span class=\"token constant\">Program</span> <span class=\"token hvariable\">flags</span> <span class=\"token hvariable\">model</span> <span class=\"token hvariable\">msg</span>\n</span></code></pre>\n<hr>\n<h3>Cmd とは</h3>\n<ul>\n<li>主に副作用を扱う(e.g. HTTP リクエスト, 乱数生成, 現在時の取得)</li>\n<li>実行した結果 <code>Cmd msg</code> を返し、その<code>msg</code>が <code>Runtime System</code> によって <code>update</code>に渡される</li>\n</ul>\n<hr>\n<h3>副作用を扱った場合のライフサイクル</h3>\n<p><img src=\"https://guide.elm-lang.org/effects/diagrams/element.svg\" alt=\"Browser.element\"></p>\n<hr>\n<h3>Cat Gifs の Msg</h3>\n<ul>\n<li>再度猫 Gif を取得する MorePlease</li>\n<li>猫 Gif の取得した結果を表す GotGif (Result Http.Error String)</li>\n<li>Result error value 型は成功・失敗を表すことが出来る</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token keyword\">type</span> <span class=\"token constant\">Msg</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">=</span> <span class=\"token constant\">MorePlease</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">|</span> <span class=\"token constant\">GotGif</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Result</span> <span class=\"token constant\">Http.Error</span> <span class=\"token constant\">String</span><span class=\"token punctuation\">)</span>\n</span></code></pre>\n<hr>\n<h3>Cat Gif の Model</h3>\n<ul>\n<li>猫画像取に失敗したら Failure</li>\n<li>取得中は Loading</li>\n<li>取得に成功したら Success に 猫 Gif の URL を文字列で持つ</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token keyword\">type</span> <span class=\"token constant\">Model</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">=</span> <span class=\"token constant\">Failure</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">|</span> <span class=\"token constant\">Loading</span>\n</span><span class=\"code-line\">  <span class=\"token operator\">|</span> <span class=\"token constant\">Success</span> <span class=\"token constant\">String</span>\n</span></code></pre>\n<hr>\n<h3>Cat Gif の Initialize phase</h3>\n<ul>\n<li>モデルの初期値は Loading</li>\n<li>getRandomCatGif で猫 Gif を取得する</li>\n<li>Http.get の返り値の型が Cmd msg なので Cmd を強制される</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">init</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span><span class=\"token punctuation\">)</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">init</span> _ <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token punctuation\">(</span><span class=\"token constant\">Loading</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">getRandomCatGif</span><span class=\"token punctuation\">)</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token hvariable\">get</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">url</span> <span class=\"token operator\">:</span> <span class=\"token constant\">String</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">expect</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Expect</span> <span class=\"token hvariable\">msg</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Cmd</span> <span class=\"token hvariable\">msg</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token hvariable\">getRandomCatGif</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">getRandomCatGif</span> <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token hvariable\">Http.get</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">url</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"https://api.giphy.com/v1/gifs/random?api_key=dc6zaTOxFJmzC&#x26;tag=cat\"</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">expect</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">Http.expectJson</span> <span class=\"token constant\">GotGif</span> <span class=\"token hvariable\">gifDecoder</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">}</span>\n</span></code></pre>\n<hr>\n<h3>Cat Gif の更新 phase</h3>\n<ul>\n<li>MorePlease メッセージなら Loading 状態にして猫 Gif を取得しにいく</li>\n<li>取得した結果、成功していればモデルに URL を入れて描画、失敗していれば Failure 画面に</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">update</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Msg</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span><span class=\"token punctuation\">)</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">update</span> <span class=\"token hvariable\">msg</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token keyword\">case</span> <span class=\"token hvariable\">msg</span> <span class=\"token keyword\">of</span>\n</span><span class=\"code-line\">    <span class=\"token constant\">MorePlease</span> <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">      <span class=\"token punctuation\">(</span><span class=\"token constant\">Loading</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">getRandomCatGif</span><span class=\"token punctuation\">)</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">    <span class=\"token constant\">GotGif</span> <span class=\"token hvariable\">result</span> <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">      <span class=\"token keyword\">case</span> <span class=\"token hvariable\">result</span> <span class=\"token keyword\">of</span>\n</span><span class=\"code-line\">        <span class=\"token constant\">Ok</span> <span class=\"token hvariable\">url</span> <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">          <span class=\"token punctuation\">(</span><span class=\"token constant\">Success</span> <span class=\"token hvariable\">url</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span><span class=\"token punctuation\">)</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">        <span class=\"token constant\">Err</span> _ <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">          <span class=\"token punctuation\">(</span><span class=\"token constant\">Failure</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span><span class=\"token punctuation\">)</span>\n</span></code></pre>\n<hr>\n<h3>Cat Gif の描画</h3>\n<ul>\n<li>view でもパターンマッチで状態を網羅して描画しているかが検査できる</li>\n</ul>\n<pre class=\"language-elm\"><code class=\"language-elm code-highlight\"><span class=\"code-line\"><span class=\"token hvariable\">view</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token constant\">Msg</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">view</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token hvariable\">div</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">h2</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token string\">\"Random Cats\"</span> <span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">viewGif</span> <span class=\"token hvariable\">model</span>\n</span><span class=\"code-line\">    <span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\"><span class=\"token hvariable\">viewGif</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token constant\">Msg</span>\n</span><span class=\"code-line\"><span class=\"token hvariable\">viewGif</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n</span><span class=\"code-line\">  <span class=\"token keyword\">case</span> <span class=\"token hvariable\">model</span> <span class=\"token keyword\">of</span>\n</span><span class=\"code-line\">    <span class=\"token constant\">Failure</span> <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">      <span class=\"token hvariable\">div</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">        <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token string\">\"I could not load a random cat for some reason. \"</span>\n</span><span class=\"code-line\">        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">button</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">onClick</span> <span class=\"token constant\">MorePlease</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token string\">\"Try Again!\"</span> <span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">        <span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">    <span class=\"token constant\">Loading</span> <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">      <span class=\"token hvariable\">text</span> <span class=\"token string\">\"Loading...\"</span>\n</span><span class=\"code-line\">\n</span><span class=\"code-line\">    <span class=\"token constant\">Success</span> <span class=\"token hvariable\">url</span> <span class=\"token operator\">-></span>\n</span><span class=\"code-line\">      <span class=\"token hvariable\">div</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">        <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">button</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">onClick</span> <span class=\"token constant\">MorePlease</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">style</span> <span class=\"token string\">\"display\"</span> <span class=\"token string\">\"block\"</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token string\">\"More Please!\"</span> <span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">img</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">src</span> <span class=\"token hvariable\">url</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n</span><span class=\"code-line\">        <span class=\"token punctuation\">]</span>\n</span></code></pre>\n<hr>\n<h3>TEA</h3>\n<ul>\n<li>副作用を扱わない場合 model, update, message, view によって構成される</li>\n<li>view から message を投げ、その message に合わせて model を更新する</li>\n<li>副作用を扱う場合は update から副作用(Cmd)を実行し、Cmd からまた message を投げ update で受け取る</li>\n<li>今回は見ていないけれど、外部からの入力(時間によって発するイベントや websocket のイベントなど**は subscription で扱う</li>\n</ul>\n<hr>\n<h2>まとめ</h2>\n<ul>\n<li>Elm の基本的なところを紹介しました</li>\n<li>TEA を紹介しました</li>\n<li>簡潔な型定義とパターンマッチで安全にフロントエンドが開発できるよ！</li>\n</ul>"},"__N_SSG":true}