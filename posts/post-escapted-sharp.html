<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Next.js で URL に#を含むページを作成する | (wat-aro)</title><meta name="title" content="Next.js で URL に#を含むページを作成する | (wat-aro)"/><meta name="description" content=" tl;drnext.js で `` が含まれた static page のリンクは `` でなく `%2325` にする必要がある。アクセスできるようになったが、そもそも URL に `` を入れないのがよい。 事象はてなブログからの記事を移行する際に、記事のタイトルを markdown のファイル名にしていた。`/"/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="Next.js で URL に#を含むページを作成する | (wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/og-images/post-escapted-sharp.png"/><meta property="og:url" content="https://wat-aro.dev/posts/post-escapted-sharp"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="Next.js で URL に#を含むページを作成する | (wat-aro)"/><meta name="twitter:description" content=" tl;drnext.js で `` が含まれた static page のリンクは `` でなく `%2325` にする必要がある。アクセスできるようになったが、そもそも URL に `` を入れないのがよい。 事象はてなブログからの記事を移行する際に、記事のタイトルを markdown のファイル名にしていた。`/"/><meta name="twitter:image" content="https://wat-aro.dev/og-images/post-escapted-sharp.png"/><meta name="next-head-count" content="17"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/02ced8e6983f7546.css" as="style"/><link rel="stylesheet" href="/_next/static/css/02ced8e6983f7546.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d3eeee857401101e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-0e1c4012a86ba0a9.js" defer=""></script><script src="/_next/static/MwAZdhrPfcr2hZiH7rGrL/_buildManifest.js" defer=""></script><script src="/_next/static/MwAZdhrPfcr2hZiH7rGrL/_ssgManifest.js" defer=""></script><script src="/_next/static/MwAZdhrPfcr2hZiH7rGrL/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full  flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li><li class="h-full  flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts/pages/1">Blog</a></li></ul></div><div class="flex md:justify-center justify-between w-full"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><article class="flex max-w-4xl w-full"><div class="py-4 w-full"><div class="mr-2 text-xs font-bold">2022/06/14</div><h1 class="font-bold text-3xl text-black">Next.js で URL に#を含むページを作成する</h1><nav class="flex mt-2 mb-2 items-start text-gray-500 text-xs"><div class="flex flex-nowrap max-w-full overflow-x-auto"><p class="mr-1 rounded-full px-2 py-1 border leading-none">Next.js</p></div></nav><div class="znc"><h2 id="tldr">tl;dr</h2>
<p>next.js で <code>#</code> が含まれた static page のリンクは <code>#</code> でなく <code>%2325</code> にする必要がある。<br>
アクセスできるようになったが、そもそも URL に <code>#</code> を入れないのがよい。</p>
<h2 id="事象">事象</h2>
<p>はてなブログからの記事を移行する際に、記事のタイトルを markdown のファイル名にしていた。<br>
<code>/posts/Array#slice.md</code> を元に出力した <code>/posts/Arrray#slice</code> ページにアクセスしようとすると 404 になってしまう。</p>
<h2 id="環境">環境</h2>
<ul>
<li>Next.js</li>
</ul>
<h2 id="解決策">解決策</h2>
<p>普通に <code>#</code> だけをパーセントエンコーディングしてリンクを生成したところ、 <code>next dev</code> で実行する際はうまくいったが、 <code>next export</code> してデプロイするとアクセスできない。<br>
実際に <code>Next.js</code> が出力した html を見てみると ファイル名の <code>#</code> が html のファイル名の時点で <code>%25</code> に変換されていた。<br>
<a href="https://github.com/wat-aro/wat-aro.github.io/blob/47a30b9d9a1d03154b7934bfde91f3809b2006cc/posts/Array%2523slice.html">https://github.com/wat-aro/wat-aro.github.io/blob/47a30b9d9a1d03154b7934bfde91f3809b2006cc/posts/Array%2523slice.html</a></p>
<p>アクセスする際のリンクが <code>/posts/Array%25slice</code> だとうまくいかないのはこのせいだった。<br>
html 自体が <code>/posts/Array%25slice</code> に配置されているので、ここへアクセスするためには <code>%25</code> をさらにパーセントエンコーディングしないといけない。<br>
URL を生成する際に <code>#</code> を <code>%2325</code> に変換すると <code>next export</code> した際にきちんと動くようになった 😄</p>
<p>しかし、 <code>next dev</code> ではうごかない。<br>
<code>next export</code> -> <code>#</code> が変換された html にアクセス<br>
<code>next dev</code> -> <code>#</code> を変換していない html にアクセス<br>
という具合の挙動になっていそう。<br>
<code>export</code> と <code>dev</code> でファイル名が違うため環境によって分岐しないと両方で表示できるようにはならない。</p>
<p><code>#</code> が入らないように調整するのが一番よさそうですね。</p></div></div></article></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"Next.js で URL に#を含むページを作成する","published":"2022/06/14","tags":["Next.js"],"content":"\u003ch2 id=\"tldr\"\u003etl;dr\u003c/h2\u003e\n\u003cp\u003enext.js で \u003ccode\u003e#\u003c/code\u003e が含まれた static page のリンクは \u003ccode\u003e#\u003c/code\u003e でなく \u003ccode\u003e%2325\u003c/code\u003e にする必要がある。\u003cbr\u003e\nアクセスできるようになったが、そもそも URL に \u003ccode\u003e#\u003c/code\u003e を入れないのがよい。\u003c/p\u003e\n\u003ch2 id=\"事象\"\u003e事象\u003c/h2\u003e\n\u003cp\u003eはてなブログからの記事を移行する際に、記事のタイトルを markdown のファイル名にしていた。\u003cbr\u003e\n\u003ccode\u003e/posts/Array#slice.md\u003c/code\u003e を元に出力した \u003ccode\u003e/posts/Arrray#slice\u003c/code\u003e ページにアクセスしようとすると 404 になってしまう。\u003c/p\u003e\n\u003ch2 id=\"環境\"\u003e環境\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eNext.js\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"解決策\"\u003e解決策\u003c/h2\u003e\n\u003cp\u003e普通に \u003ccode\u003e#\u003c/code\u003e だけをパーセントエンコーディングしてリンクを生成したところ、 \u003ccode\u003enext dev\u003c/code\u003e で実行する際はうまくいったが、 \u003ccode\u003enext export\u003c/code\u003e してデプロイするとアクセスできない。\u003cbr\u003e\n実際に \u003ccode\u003eNext.js\u003c/code\u003e が出力した html を見てみると ファイル名の \u003ccode\u003e#\u003c/code\u003e が html のファイル名の時点で \u003ccode\u003e%25\u003c/code\u003e に変換されていた。\u003cbr\u003e\n\u003ca href=\"https://github.com/wat-aro/wat-aro.github.io/blob/47a30b9d9a1d03154b7934bfde91f3809b2006cc/posts/Array%2523slice.html\"\u003ehttps://github.com/wat-aro/wat-aro.github.io/blob/47a30b9d9a1d03154b7934bfde91f3809b2006cc/posts/Array%2523slice.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eアクセスする際のリンクが \u003ccode\u003e/posts/Array%25slice\u003c/code\u003e だとうまくいかないのはこのせいだった。\u003cbr\u003e\nhtml 自体が \u003ccode\u003e/posts/Array%25slice\u003c/code\u003e に配置されているので、ここへアクセスするためには \u003ccode\u003e%25\u003c/code\u003e をさらにパーセントエンコーディングしないといけない。\u003cbr\u003e\nURL を生成する際に \u003ccode\u003e#\u003c/code\u003e を \u003ccode\u003e%2325\u003c/code\u003e に変換すると \u003ccode\u003enext export\u003c/code\u003e した際にきちんと動くようになった 😄\u003c/p\u003e\n\u003cp\u003eしかし、 \u003ccode\u003enext dev\u003c/code\u003e ではうごかない。\u003cbr\u003e\n\u003ccode\u003enext export\u003c/code\u003e -\u003e \u003ccode\u003e#\u003c/code\u003e が変換された html にアクセス\u003cbr\u003e\n\u003ccode\u003enext dev\u003c/code\u003e -\u003e \u003ccode\u003e#\u003c/code\u003e を変換していない html にアクセス\u003cbr\u003e\nという具合の挙動になっていそう。\u003cbr\u003e\n\u003ccode\u003eexport\u003c/code\u003e と \u003ccode\u003edev\u003c/code\u003e でファイル名が違うため環境によって分岐しないと両方で表示できるようにはならない。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e#\u003c/code\u003e が入らないように調整するのが一番よさそうですね。\u003c/p\u003e","slug":"post-escapted-sharp","rawContent":"\n## tl;dr\n\nnext.js で `#` が含まれた static page のリンクは `#` でなく `%2325` にする必要がある。\nアクセスできるようになったが、そもそも URL に `#` を入れないのがよい。\n\n## 事象\n\nはてなブログからの記事を移行する際に、記事のタイトルを markdown のファイル名にしていた。\n`/posts/Array#slice.md` を元に出力した `/posts/Arrray#slice` ページにアクセスしようとすると 404 になってしまう。\n\n## 環境\n\n- Next.js\n\n## 解決策\n\n普通に `#` だけをパーセントエンコーディングしてリンクを生成したところ、 `next dev` で実行する際はうまくいったが、 `next export` してデプロイするとアクセスできない。\n実際に `Next.js` が出力した html を見てみると ファイル名の `#` が html のファイル名の時点で `%25` に変換されていた。\nhttps://github.com/wat-aro/wat-aro.github.io/blob/47a30b9d9a1d03154b7934bfde91f3809b2006cc/posts/Array%2523slice.html\n\nアクセスする際のリンクが `/posts/Array%25slice` だとうまくいかないのはこのせいだった。\nhtml 自体が `/posts/Array%25slice` に配置されているので、ここへアクセスするためには `%25` をさらにパーセントエンコーディングしないといけない。\nURL を生成する際に `#` を `%2325` に変換すると `next export` した際にきちんと動くようになった :smile:\n\nしかし、 `next dev` ではうごかない。\n`next export` -\u003e `#` が変換された html にアクセス\n`next dev` -\u003e `#` を変換していない html にアクセス\nという具合の挙動になっていそう。\n`export` と `dev` でファイル名が違うため環境によって分岐しないと両方で表示できるようにはならない。\n\n`#` が入らないように調整するのが一番よさそうですね。\n"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"post-escapted-sharp"},"buildId":"MwAZdhrPfcr2hZiH7rGrL","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>