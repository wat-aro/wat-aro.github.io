<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Posts | (wat-aro)</title><meta name="title" content="(wat-aro)"/><meta name="description"/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="(wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/images/profile.jpg"/><meta property="og:url" content="https://wat-aro.dev/posts/pages/3"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="(wat-aro)"/><meta name="twitter:description"/><meta name="twitter:image" content="https://wat-aro.dev/images/profile.jpg"/><meta name="next-head-count" content="17"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/02ced8e6983f7546.css" as="style"/><link rel="stylesheet" href="/_next/static/css/02ced8e6983f7546.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d3eeee857401101e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/pages/%5Bpage%5D-ad998518afd269cc.js" defer=""></script><script src="/_next/static/A1Wu7EQPosfnUh_uET58m/_buildManifest.js" defer=""></script><script src="/_next/static/A1Wu7EQPosfnUh_uET58m/_ssgManifest.js" defer=""></script><script src="/_next/static/A1Wu7EQPosfnUh_uET58m/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full  flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li><li class="h-full  flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts/pages/1">Blog</a></li></ul></div><div class="flex md:justify-center justify-between w-full"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><h1 class="text-3xl mb-4">Posts</h1><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/fjord%E3%81%AE%E3%83%AA%E3%83%A2%E3%83%BC%E3%83%88%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%B3%E3%81%AB%E5%8F%82%E5%8A%A0%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">fjordのリモートインターンに参加しました</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/25</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AE%E5%9F%BA%E7%A4%8E%E3%82%92%E8%AA%AD%E3%81%BF%E7%B5%82%E3%82%8F%E3%81%A3%E3%81%9F%EF%BC%8E"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">プログラミングの基礎を読み終わった．</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/20</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AE%E5%9F%BA%E7%A4%8E%E3%80%8016.4%20%E6%9C%80%E5%88%9D%E3%81%AE%E5%AE%8C%E5%8B%95%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">プログラミングの基礎　16.4 最初の完動プログラム</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/16</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/OCaml%E3%81%AE%E7%84%A1%E5%90%8D%E9%96%A2%E6%95%B0%E3%81%AF%E5%86%8D%E5%B8%B0%E3%82%92%E5%AE%9A%E7%BE%A9%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%EF%BC%9F"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">OCamlの無名関数は再帰を定義できない？</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/15</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%88%9D%E5%BF%83%E8%80%85%E3%81%8CSICP(%E8%A8%88%E7%AE%97%E6%A9%9F%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E6%A7%8B%E9%80%A0%E3%81%A8%E8%A7%A3%E9%87%88)%E3%82%92%E8%AA%AD%E3%82%93%E3%81%A7%E3%81%BF%E3%81%9F"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">プログラミング初心者がSICP(計算機プログラムの構造と解釈)を読んでみた</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/13</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.50"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.50</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/12</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.49"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.49</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/10</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.48"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.48</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/10</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.47"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.47</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/10</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.46"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.46</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/10</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.45"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.45</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/10</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.44"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.44</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/09</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.43"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.43</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/09</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.42"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.42</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/09</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.41"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.41</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/09</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.40"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.40</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/09</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.39"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.39</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/09</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.38d"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.38d</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/08</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.38c"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.38c</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/08</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%205.38ab"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 5.38ab</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2016/02/08</div></div></a><div class="flex gap-4 py-4"><a href="/posts/pages/1">1<!-- --></a><a href="/posts/pages/2">2<!-- --></a><div class="font-bold">3<!-- --></div><a href="/posts/pages/4">4<!-- --></a><a href="/posts/pages/5">5<!-- --></a><a href="/posts/pages/6">6<!-- --></a><a href="/posts/pages/7">7<!-- --></a><a href="/posts/pages/8">8<!-- --></a><a href="/posts/pages/9">9<!-- --></a><a href="/posts/pages/10">10<!-- --></a><a href="/posts/pages/11">11<!-- --></a><a href="/posts/pages/12">12<!-- --></a><a href="/posts/pages/13">13<!-- --></a><a href="/posts/pages/14">14<!-- --></a><a href="/posts/pages/15">15<!-- --></a><a href="/posts/pages/16">16<!-- --></a><a href="/posts/pages/17">17<!-- --></a><a href="/posts/pages/18">18<!-- --></a><a href="/posts/pages/19">19<!-- --></a><a href="/posts/pages/20">20<!-- --></a><a href="/posts/pages/21">21<!-- --></a><a href="/posts/pages/22">22<!-- --></a></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"data":{"title":"fjordのリモートインターンに参加しました","published":"2016/02/25"},"content":"\n\u003cp\u003e昨日別ブログにも書きましたが，向こうはやめてこっちに書いていきます．\u003cbr/\u003e\nコードを書いてごはんが食べられるように頑張ります．\u003c/p\u003e\n\n","slug":"fjordのリモートインターンに参加しました"},{"data":{"title":"プログラミングの基礎を読み終わった．","published":"2016/02/20","tags":["プログラミングの基礎","OCaml"]},"content":"\n\u003cp\u003e\u003cdiv class=\"hatena-asin-detail\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4781911609/wataro-22/\"\u003e\u003cimg src=\"http://ecx.images-amazon.com/images/I/51FBsJHo4EL._SL160_.jpg\" class=\"hatena-asin-detail-image\" alt=\"プログラミングの基礎 (Computer Science Library)\" title=\"プログラミングの基礎 (Computer Science Library)\"\u003e\u003c/a\u003e\u003cdiv class=\"hatena-asin-detail-info\"\u003e\u003cp class=\"hatena-asin-detail-title\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4781911609/wataro-22/\"\u003eプログラミングの基礎 (Computer Science Library)\u003c/a\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e作者:\u003c/span\u003e \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%C0%F5%B0%E6%B7%F2%B0%EC\"\u003e浅井健一\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e出版社/メーカー:\u003c/span\u003e \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B5%A5%A4%A5%A8%A5%F3%A5%B9%BC%D2\"\u003eサイエンス社\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e発売日:\u003c/span\u003e 2007/03\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003eメディア:\u003c/span\u003e 単行本\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e購入\u003c/span\u003e: 17人 \u003cspan class=\"hatena-asin-detail-label\"\u003eクリック\u003c/span\u003e: 409回\u003c/li\u003e\u003cli\u003e\u003ca href=\"http://d.hatena.ne.jp/asin/4781911609/wataro-22\" target=\"_blank\"\u003eこの商品を含むブログ (126件) を見る\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cdiv class=\"hatena-asin-detail-foot\"\u003e\u003c/div\u003e\u003c/div\u003e\u003c/p\u003e\n\n\u003cp\u003e演習問題をほぼ解いて一週間くらいかかりました．\n　　  \u003cbr/\u003e\nタイトルどおりに丁寧にプログラミングの基礎を習得出来る本でした．\u003cbr/\u003e\nデザインレシピを通して，プログラムの書き方を学んでいきます．\u003cbr/\u003e\nこのデザインレシピがよく出来ていて，\u003cbr/\u003e\n簡単な関数ならこのやり方のまま迷わずに書いていけます．\u003cbr/\u003e\nさらに実行して期待する型が出力できる段階まで書けると，テストを書くようになっているので．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C6%A5%B9%A5%C8%A5%D5%A5%A1%A1%BC%A5%B9%A5%C8\"\u003eテストファースト\u003c/a\u003eも体験できます．\u003cbr/\u003e\n何度も問題を解いていくうちに型をちゃんと意識するようになりました．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SICP\"\u003eSICP\u003c/a\u003eやっていた時も面倒なバグは大体型がおかしくなっていることに起因していたのですごくためになります．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003eやリスト操作自体は慣れていましたが，パターンマッチによって操作していくのはおもしろかったです． \u003cbr/\u003e\nプログラミング初心者にも\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B4%D8%BF%F4%B7%BF%B8%C0%B8%EC\"\u003e関数型言語\u003c/a\u003e初心者にもおすすめな内容だと思います．\u003c/p\u003e\n\n","slug":"プログラミングの基礎を読み終わった．"},{"data":{"title":"プログラミングの基礎　16.4 最初の完動プログラム","published":"2016/02/16","tags":["OCaml","プログラミングの基礎"]},"content":"\n\u003cp\u003eプログラミングの基礎で作ったメトロネットワーク最短路問題の解答．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AF%A5%B9%A5%C8%A5%E9\"\u003eダイクストラ\u003c/a\u003e法を使い求める．\u003cbr/\u003e\nここまでのメトロネットワーク最短路問題に関係する問題の解答すべてここに書いてある．\u003c/p\u003e\n\n\u003cpre class=\"code lang-ocaml\" data-lang=\"ocaml\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e(* サポートページからダウンロードしたglobal_ekimei_listとglobal_ekikan_list *)\u003c/span\u003e\n\u003cspan class=\"synPreProc\"\u003e#use\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;metro.ml\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のデータを受け取り，「路線名，駅名（かな）」を返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* hyoji : ekimei_t -\u0026gt; string *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e hyoji ekimei \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e ekimei \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e;}\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;，\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e kanji \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;（\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;）\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e(* hyoji test *)\u003c/span\u003e\nprint_string \u003cspan class=\"synConstant\"\u003e\u0026quot;hyouji test\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e hyoji \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;茗荷谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;みょうがだに\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                   romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;myogadani\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;丸ノ内線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;丸ノ内線，茗荷谷（みょうがだに）\u0026quot;\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ローマ字の駅名（文字列）と駅名リスト(ekimei_t list 型)を受け取り\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   園駅の漢字表記を返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* romaji_to_kanji -\u0026gt; string -\u0026gt; ekimei_t list -\u0026gt; string *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e romaji_to_kanji name lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e name \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kanji\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e romaji_to_kanji name rest\n\n\u003cspan class=\"synComment\"\u003e(* romaji_to_kanji test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;myogadani\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;myogadani\u0026quot;\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;茗荷谷\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;aoyamaicchome\u0026quot;\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;heiwadai\u0026quot;\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;平和台\u0026quot;\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：漢字の駅名を２つと駅間リストを受け取ったら，駅間リストの中からその２駅間の距離を返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* get_ekikan_kyori : string -\u0026gt; string -\u0026gt; ekikan_t list -\u0026gt; float *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e get_ekikan_kyori eki1 eki2 lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e infinity\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekiten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shuten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e keiyu \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e keiyu\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e jikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e jikan\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten \u003cspan class=\"synStatement\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e eki2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kyori\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten \u003cspan class=\"synStatement\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e eki1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kyori\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e get_ekikan_kyori eki1 eki2 rest\n\n\n\n\u003cspan class=\"synComment\"\u003e(* get_ekikan_kyori test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;錦糸町\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;住吉\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;錦糸町\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;錦糸町\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;横浜駅\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;錦糸町\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test7 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;霞ヶ関\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;日比谷\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.2\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ローマ字の駅名を２つ受け取り，その間の距離を調べ，つながっている場合は\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   「A駅からB駅までのはｘｋｍです」と返し，繋がっていない場合は\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   「A駅からB駅はつながっていません」と返す*)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori_wo_hyoji r1 r2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji r1 global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji r2 global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e not_exist \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;という駅は存在しません\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e r1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e not_exist\n  \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e r2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e not_exist\n  \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori k1 k2 global_ekikan_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n       \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n       \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;駅と\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;駅はつながっていません\u0026quot;\u003c/span\u003e\n       \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;駅から\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;駅までは\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e string_of_float kyori \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;kmです\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* kyori_wo_hyoji test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;hibiya\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町駅と日比谷駅はつながっていません\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;kinsityo\u0026quot;\u003c/span\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;という駅は存在しません\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;yokohama\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;kinsityo\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;yokohamaという駅は存在しません\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;mitsukoshimae\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町駅から三越前駅までは0.7kmです\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;mitsukoshimae\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前駅から大手町駅までは0.7kmです\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;kasumigaseki\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;hibiya\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;霞ヶ関駅から日比谷駅までは1.2kmです\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"synStatement\"\u003etype\u003c/span\u003e eki_t \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003e\n  namae : \u003cspan class=\"synType\"\u003estring\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e               \u003cspan class=\"synComment\"\u003e(* 駅名（漢字の文字列） *)\u003c/span\u003e\n  saitan_kyori : \u003cspan class=\"synType\"\u003efloat\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e(* 最短距離（実数） *)\u003c/span\u003e\n  temae_list : \u003cspan class=\"synType\"\u003estring\u003c/span\u003e \u003cspan class=\"synType\"\u003elist\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e(* 駅名（漢字の文字列）のリスト *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* 目的：string型の駅名(漢字)とekimei_t list型を受け取り，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   ekimei_t listをeki_t listに変え，その際駅名と一致する駅についてはshokikaする *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* make_initial_eki_list : string -\u0026gt; ekimei_t list -\u0026gt; eki_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e make_initial_eki_list name lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.map \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e a\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e r\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e s\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e name\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003ek\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e})\u003c/span\u003e\n    lst\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* make_initial_eki_list test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;よよぎうえはら\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                                 romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;yoyogiuehara\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\u0026quot;明治神宮前\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;代々木公園\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;よよぎこうえん\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                                romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;yoyogikouen\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n                                               \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;明治神宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;めいじじんぐうまえ\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                                romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;meijijinguumae\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;代々木公園\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;明治神宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;明治神宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\u0026quot;赤坂\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;表参道\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;おもてさんどう\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;omotesandou\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n                                          \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;乃木坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;のぎざか\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;nogizaka\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n                                          \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;赤坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;あかさか\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;akasaka\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;表参道\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;乃木坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;赤坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;赤坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\n\n\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のレコードとekimei_t型のリストを受け取ったら，平仮名の昇順となる位置に\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   ekimei_t型のレコードを挿入する．同じ駅がリストにあれば挿入しない．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   seiretsuのための補助関数*)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* ekimei_isnert : -\u0026gt; ekimei_t -\u0026gt; ekimei_t list -\u0026gt; ekimei_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e ekimei_insert eki lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eeki\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e({\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e;}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eas\u003c/span\u003e first\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e eki.kana\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e lst                   \u003cspan class=\"synComment\"\u003e(* リストにあったほうが残る *)\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki.kana \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003e kana    \u003cspan class=\"synComment\"\u003e(* 駅のkana \u0026lt; first のkana *)\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e ekimei_insert eki rest\n\n\u003cspan class=\"synComment\"\u003e(* test data *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e yoyogiuehara_tiyodasen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;よよぎうえはら\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                              romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;yoyogiuehara\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;おおてまち\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                         romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi_hanzoumonsen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;おおてまち\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                             romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;半蔵門線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert yoyogiuehara_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のリストを受け取ったら，それを平仮名の順に整列し，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   さらに駅の重複を取り除いたekimei_t型のリストを返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* seiretsu : ekimei_t -\u0026gt; ekimei_t *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e seiretsu lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e ekimei_insert first \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eseiretsu rest\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\n\n\n\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e otemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e otemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\n\n\n\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shibuya \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e aoyamaichome \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：直前に確定した駅 p (eki_t型)と味覚手の役のリスト v (eki_t list型)を受け取り\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   必要な更新処理を行った後の未確定の駅のリストを返す*)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* koushin -\u0026gt; eki_t -\u0026gt; eki_t list -\u0026gt; ekikan_t list -\u0026gt; eki_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e koushin p v ekikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.map\n    \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e q \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori p.namae q.namae ekikan \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e q\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e p_keiyu_q_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e p.saitan_kyori +. kyori \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n           \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e  p_keiyu_q_kyori  \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003e q.saitan_kyori\n           \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003e namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e q.namae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e p_keiyu_q_kyori\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                  temae_list \u003cspan class=\"synStatement\"\u003e=(\u003c/span\u003eq.namae\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e p.temae_list\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n           \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e q\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n    v\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* test data *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shibuya \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e aoyamaichome \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e nagatacho \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;永田町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shinochanomizu \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* koushin test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e koushin_test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e koushin otemachi\n  \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003emitsukoshimae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shibuya\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shinochanomizu\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e aoyamaichome\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e global_ekikan_list\n  \u003cspan class=\"synStatement\"\u003e=[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}];;\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：eki_t list型のリストを受け取り，「最短距離最小の駅」と\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   「最短距離最小の駅以外からなるリスト」の組を返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* saitan_wo_bunri : eki_t list -\u0026gt; eki_t * eki_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e saitan_wo_bunri eki_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.fold_right\n    \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e first rest_saitan \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eminimum, lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e rest_saitan \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e minimum.namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003efirst, lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e first.saitan_kyori \u003cspan class=\"synStatement\"\u003e\u0026lt;=\u003c/span\u003e minimum.saitan_kyori\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003efirst, minimum \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eminimum, first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\u003cspan class=\"synStatement\"\u003e))\u003c/span\u003e\n    eki_list\n    \u003cspan class=\"synStatement\"\u003e({\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e, \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e saitan_wo_bunri \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=({\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e,\n    \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]);;\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：eki_t list型の未確定の駅のリストとekikan_t list型の駅間のリストを受け取り\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   ダイクストラのアルゴリズムにしたがって各駅について\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   最短距離と最短経路が正しく入ったリストを返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* dijkstra_main : eki_t list -\u0026gt; ekikan_t list -\u0026gt; eki_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e dijkstra_main  eki_list ekikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e eki_list \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan_wo_bunri eki_list\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan1, \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003esaitan1\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan2, rest\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e saitan2 \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003edijkstra_main \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003ekoushin saitan2 rest ekikan\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e ekikan\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e(* test_data *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e suitenguumae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kiyosumishirakawa \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;清澄白河\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e sumiyoshi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;住吉\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e dijkstra_test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra_main \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e mitsukoshimae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e suitenguumae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                    kiyosumishirakawa\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e sumiyoshi\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  global_ekikan_list\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2.4\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;清澄白河\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5.4\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;清澄白河\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;住吉\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7.30000000000000071\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n         \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;住吉\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;清澄白河\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* 目的：始点の駅名（ローマ字の文字列）と終点の駅名（ローマ字の文字列）を受け取り\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   seiretsuを使ってglobal_ekimei_list の重複を取り除き，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   romaji_to_kanji を使って始点と終点の漢字表記を求め\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   make_initial_eki_listを使って駅のリストを作り，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   dijkstra_mainを使って各駅までの最短路を確定し，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   その中空終点の駅のレコード(eki_t型)を返す*)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* dijkstra : string -\u0026gt; string -\u0026gt; eki_t *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e dijkstra siten shuten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e sorted_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e siten_kanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji siten sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shuten_kanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji shuten sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e initialized_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list siten_kanji sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e saitan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra_main initialized_list global_ekikan_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e serch item lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n      \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n       \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e first.namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e item\n       \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e first\n       \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e serch item rest\n  \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e serch shuten_kanji saitan_list\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* test *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* サポートページからのコピペ *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra \u003cspan class=\"synConstant\"\u003e\u0026quot;shibuya\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;gokokuji\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;護国寺\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e9.8\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n   temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;護国寺\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;江戸川橋\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;飯田橋\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;市ヶ谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;麹町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;永田町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;表参道\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra \u003cspan class=\"synConstant\"\u003e\u0026quot;myogadani\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;meguro\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;目黒\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e12.7000000000000028\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n   temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;目黒\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;白金台\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;白金高輪\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;麻布十番\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;六本木一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;溜池山王\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"synConstant\"\u003e\u0026quot;永田町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;麹町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;市ヶ谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;飯田橋\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;後楽園\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;茗荷谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"プログラミングの基礎　16.4 最初の完動プログラム"},{"data":{"title":"OCamlの無名関数は再帰を定義できない？","published":"2016/02/15","tags":["プログラミングの基礎","OCaml"]},"content":"\n\u003cp\u003eわたろーです．\u003cbr/\u003e\n今\u003ca href=\"http://d.hatena.ne.jp/asin/4781911609/wataro-22\"\u003eプログラミングの基礎 (Computer Science Library)\u003c/a\u003eを読んでいます．\u003cbr/\u003e\nこれは\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/OCaml\"\u003eOCaml\u003c/a\u003eとデザインレシピでプログラミングの基礎を学ぶという内容なのですが，\u003cbr/\u003e\n名前のない関数という節で気になる文章がありました．\u003cbr/\u003e\n14.4 名前のない関数 p145\u003c/p\u003e\n\n\u003cblockquote\u003e\u003cp\u003e名前のない関数で定義できるのは\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003eをしていない関数だけです．\u003c/p\u003e\u003c/blockquote\u003e\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/OCaml\"\u003eOCaml\u003c/a\u003eは\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%E9%A5%E0%A5%C0%B7%D7%BB%BB\"\u003eラムダ計算\u003c/a\u003eを元にしていると思っていたので驚きました．\u003cbr/\u003e\nY\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D3%A5%CD%A1%BC%A5%BF\"\u003eコンビネータ\u003c/a\u003e使って\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003e出来ないのって思ったので試してみました．\u003cbr/\u003e\nY\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D3%A5%CD%A1%BC%A5%BF\"\u003eコンビネータ\u003c/a\u003eは\u003ca href=\"http://d.hatena.ne.jp/asin/4798135984/wataro-22\"\u003e計算機プログラムの構造と解釈 第2版\u003c/a\u003ep233 問題4.21に載っていたものを使います．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;;; SICP\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; 階乗計算\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003en\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact fact n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eft k\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e k \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e k \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eft ft \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e k \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e実行すると\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003en\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact fact n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eft k\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e k \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e k \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eft ft \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e k \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n       \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e120\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\nこれを\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/OCaml\"\u003eOCaml\u003c/a\u003eで書いてみます．\u003c/p\u003e\n\n\u003cpre class=\"code lang-ocaml\" data-lang=\"ocaml\" data-unlink\u003e\u003cspan class=\"synPreProc\"\u003e#\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e n\u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e fact \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n    fact fact n\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e ft k \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e k \u003cspan class=\"synStatement\"\u003e*\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eft ft \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003ek - \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e))))\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n            \u003cspan class=\"synConstant\"\u003eCharacters\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e33\u003c/span\u003e-\u003cspan class=\"synConstant\"\u003e37\u003c/span\u003e:\n      fact fact n\u003cspan class=\"synError\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synStatement\"\u003e^^^^\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003eError\u003c/span\u003e: \u003cspan class=\"synConstant\"\u003eThis\u003c/span\u003e expression has \u003cspan class=\"synStatement\"\u003etype\u003c/span\u003e 'a \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e 'b \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e 'c\n       but an expression was expected \u003cspan class=\"synStatement\"\u003eof\u003c/span\u003e \u003cspan class=\"synStatement\"\u003etype\u003c/span\u003e 'a\n       \u003cspan class=\"synConstant\"\u003eThe\u003c/span\u003e \u003cspan class=\"synStatement\"\u003etype\u003c/span\u003e variable 'a occurs inside 'a \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e 'b \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e 'c\n\u003c/pre\u003e\n\n\n\u003cp\u003eエラーですね．\u003cbr/\u003e\n型が解決されていないのでしょうか．\u003cbr/\u003e\nググッてみると -rectypesを使って\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%BF%A5%D7%A5%EA%A5%BF\"\u003eインタプリタ\u003c/a\u003eを起動すれば出来るようです．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://d.hatena.ne.jp/sumii/20051203/1133575324\"\u003e\u0026#x4E0D;\u0026#x52D5;\u0026#x70B9;\u0026#x6F14;\u0026#x7B97;\u0026#x5B50;\u0026#x3075;\u0026#x305F;\u0026#x305F;\u0026#x3073; - sumii\u0026#x306E;\u0026#x65E5;\u0026#x8A18;\u003c/a\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-ocaml\" data-lang=\"ocaml\" data-unlink\u003e\u003cspan class=\"synPreProc\"\u003e#\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e n\u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e fact \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n      fact fact n\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e ft k \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e k \u003cspan class=\"synStatement\"\u003e*\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eft ft \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003ek - \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e))))\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n            - : \u003cspan class=\"synType\"\u003eint\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e120\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eおお，動いた．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003e型っていうのが必要になるわけなんですね．\u003cbr/\u003e\nまだまだわからないことだらけですが，型もおもしろそうです．\u003cbr/\u003e\nこの辺探すのに行き着いたこのページのTaPLのまとめがすごくおもしろそうです．\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"http://mint.hateblo.jp/embed/2014/12/24/211543\" title=\"おいお前ら、TAPL読むぞ！ - ミントフレーバー緑茶\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"http://mint.hateblo.jp/entry/2014/12/24/211543\"\u003emint.hateblo.jp\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003eおもしろそう．読みたい．すごく読みたい．\nでもまだ自分には厳しそう．\u003c/p\u003e\n\n\u003cp\u003eその前に\u003ca href=\"http://d.hatena.ne.jp/asin/4781912850/wataro-22\"\u003eプログラミング言語の基礎概念 (ライブラリ情報学コア・テキスト)\u003c/a\u003eを読みたい．\u003cbr/\u003e\nしかしその時間を作れるか．\u003cbr/\u003e\nそろそろお仕事探しのために動かないといけないかもって思ってきています．\u003cbr/\u003e\n勉強だけしていたい．\u003c/p\u003e\n\n","slug":"OCamlの無名関数は再帰を定義できない？"},{"data":{"title":"プログラミング初心者がSICP(計算機プログラムの構造と解釈)を読んでみた","published":"2016/02/13","tags":["scheme","SICP"]},"content":"\n\u003ch1\u003e読む前の状態と動機\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e読み始めた時点でプログラミング歴約１年\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://www.shido.info/lisp/idx_scm.html\"\u003eもうひとつのscheme入門\u003c/a\u003eでプログラミングに入門するも，\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B9%E2%B3%AC%B4%D8%BF%F4\"\u003e高階関数\u003c/a\u003eで挫折．\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby\"\u003eRuby\u003c/a\u003e本二冊，\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\"\u003eRails\u003c/a\u003e Tutorialを二周．\u003c/li\u003e\n\u003cli\u003e他読み始めたけど途中で飽きた本が何冊か．\u003c/li\u003e\n\u003cli\u003e仕事（非IT)が忙しく，プログラミング始めて一年でこれくらいしか出来なかった．\u003c/li\u003e\n\u003cli\u003e基本的なところがしっくりこない．\u003c/li\u003e\n\u003cli\u003eでもコード書くのは楽しいし，出来ればそれを仕事にしたいので基礎を身に着けたい．\u003c/li\u003e\n\u003cli\u003e無職になって時間もあるから基礎を身につけるために\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SICP\"\u003eSICP\u003c/a\u003eを読もう．\u003cbr/\u003e\n　\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\n\n\n\u003cp\u003e\n　\u003c/p\u003e\n\n\u003ch1\u003e読むための準備\u003c/h1\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Scheme\"\u003eScheme\u003c/a\u003e手習いとプログラミング\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Gauche\"\u003eGauche\u003c/a\u003eを読んでから\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SICP\"\u003eSICP\u003c/a\u003eにとりかかった．\u003c/li\u003e\n\u003cli\u003eメインで読んだのは2版の和田訳．読んでわからない時は原著や1版の元吉訳に当たる．\u003c/li\u003e\n\u003cli\u003e後半になると\u003ca href=\"https://github.com/hiroshi-manabe/sicp-pdf\"\u003e真鍋訳\u003c/a\u003eが登場したためこちらにも助けられた．\u003cbr/\u003e\n　\u003cbr/\u003e\n　\n\n\u003ch1\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SICP\"\u003eSICP\u003c/a\u003eを読む過程で得たもの\u003c/h1\u003e\u003c/li\u003e\n\u003cli\u003e括弧が気にならなくなった\u003c/li\u003e\n\u003cli\u003eS式のほうが読みやすいのになんで\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%C3%E6%C3%D6%B5%AD%CB%A1\"\u003e中置記法\u003c/a\u003eのほうがメジャーなの？\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003e的プロセスと反復的プロセス\u003c/li\u003e\n\u003cli\u003e第一級手続き\u003c/li\u003e\n\u003cli\u003e抽象の壁\u003c/li\u003e\n\u003cli\u003eメッセージパッシング\u003c/li\u003e\n\u003cli\u003e型によるディスパッチと強制型変換\u003c/li\u003e\n\u003cli\u003eイベントドリヴン\u003c/li\u003e\n\u003cli\u003e制約の拡散\u003c/li\u003e\n\u003cli\u003e破壊的代入が怖くなった\u003c/li\u003e\n\u003cli\u003eストリーム\u003c/li\u003e\n\u003cli\u003e遅延評価\u003c/li\u003e\n\u003cli\u003e超循環評価器の実装を通して評価戦略を理解した．\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EC%A5%B8%A5%B9%A5%BF\"\u003eレジスタ\u003c/a\u003eマシンのシミュレータによって低レベルで何が行われているのか理解した．\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%E9\"\u003eコンパイラ\u003c/a\u003eと\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%BF%A5%D7%A5%EA%A5%BF\"\u003eインタプリタ\u003c/a\u003eの効率の違い\u003cbr/\u003e\n　\n\n\u003ch1\u003e感想\u003c/h1\u003e\n\n\u003cp\u003e４ヶ月半近くかかった．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SICP\"\u003eSICP\u003c/a\u003eは基礎と聞いていたけど，やっぱり基礎でした．\u003cbr/\u003e\n今の段階で読んでおいてよかった．\u003cbr/\u003e\n問題全部解くつもりはなかったけど，だんだんと自力で解きたくなってきたため結局ほとんど自力で解いていた．\u003cbr/\u003e\n解けないと悔しい．\u003cbr/\u003e\n問題やってみて思うのは，時間がめちゃくちゃかかるけど解かないと理解できなかった．\u003cbr/\u003e\n特に４章からは本文のコードを動かすにも\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C7%A5%D0%A5%C3%A5%B0\"\u003eデバッグ\u003c/a\u003eが大変で，問題解くにも\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C7%A5%D0%A5%C3%A5%B0\"\u003eデバッグ\u003c/a\u003eが大変．\u003cbr/\u003e\nでもその\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C7%A5%D0%A5%C3%A5%B0\"\u003eデバッグ\u003c/a\u003eを通して何度もコードや本文を読むことでそこで何をしているのか理解していけた．\u003cbr/\u003e\n最後はソースがコメントだらけになった．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/C%B8%C0%B8%EC\"\u003eC言語\u003c/a\u003eでやる問題が２問残っているのでCを勉強してから解きたい．\u003cbr/\u003e\nプログラミング楽しい！に\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D7%A5%ED%A5%B0%A5%E9%A5%DF%A5%F3%A5%B0%B8%C0%B8%EC\"\u003eプログラミング言語\u003c/a\u003eおもしろい！も追加された．\u003cbr/\u003e\nプログラミング初心者からプログラミング初級者へレベルアップできた・・・はず．\u003cbr/\u003e\n　\u003cbr/\u003e\nこれから読む人には\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Scheme\"\u003eScheme\u003c/a\u003e手習いを読んでおくことを勧めたい．\u003cbr/\u003e\n読みにくいし後半急激に難しくなるけど，そこで継続を渡すことを覚えておくと楽になる．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C7%A5%D0%A5%C3%A5%B0\"\u003eデバッグ\u003c/a\u003e方法も覚えておかないと４章から辛いので\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Gauche\"\u003eGauche\u003c/a\u003e使うならプログラミング\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Gauche\"\u003eGauche\u003c/a\u003eにも一通り目を通しておいたほうがいい．\u003cbr/\u003e\n　\u003cbr/\u003e\nかなり苦しんだけど，それでも楽しい・おもしろいのほうが勝ってる．\u003cbr/\u003e\nまだ半年は生きていけそうなのでまだまだ勉強してコード書く仕事につけるように頑張ります．\u003cbr/\u003e\nとりあえず\u003ca href=\"http://d.hatena.ne.jp/asin/4781911609/wataro-22\"\u003eプログラミングの基礎 (Computer Science Library)\u003c/a\u003eでMLとデザインレシピに触れてからK\u0026amp;Rを読もうと思ってます．\u003c/p\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e\u003cdiv class=\"hatena-asin-detail\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4798135984/wataro-22/\"\u003e\u003cimg src=\"http://ecx.images-amazon.com/images/I/511qf4jdYjL._SL160_.jpg\" class=\"hatena-asin-detail-image\" alt=\"計算機プログラムの構造と解釈 第2版\" title=\"計算機プログラムの構造と解釈 第2版\"\u003e\u003c/a\u003e\u003cdiv class=\"hatena-asin-detail-info\"\u003e\u003cp class=\"hatena-asin-detail-title\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4798135984/wataro-22/\"\u003e計算機プログラムの構造と解釈 第2版\u003c/a\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e作者:\u003c/span\u003e ハロルド\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%A4%A5%D6%A5%EB\"\u003eエイブル\u003c/a\u003eソン,ジュリーサスマン,\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B8%A5%A7%A5%E9%A5%EB%A5%C9%A1%A6%A5%B8%A5%A7%A5%A4%A5%B5%A5%B9%A5%DE%A5%F3\"\u003eジェラルド・ジェイサスマン\u003c/a\u003e,Harold Abelson,Julie Sussman,Gerald Jay Sussman,和田英一\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e出版社/メーカー:\u003c/span\u003e \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%E6%C6%B1%CB%BC%D2\"\u003e翔泳社\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e発売日:\u003c/span\u003e 2014/05/17\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003eメディア:\u003c/span\u003e 大型本\u003c/li\u003e\u003cli\u003e\u003ca href=\"http://d.hatena.ne.jp/asin/4798135984/wataro-22\" target=\"_blank\"\u003eこの商品を含むブログ (2件) を見る\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cdiv class=\"hatena-asin-detail-foot\"\u003e\u003c/div\u003e\u003c/div\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cdiv class=\"hatena-asin-detail\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4274068269/wataro-22/\"\u003e\u003cimg src=\"http://ecx.images-amazon.com/images/I/41OG665OkZL._SL160_.jpg\" class=\"hatena-asin-detail-image\" alt=\"Scheme手習い\" title=\"Scheme手習い\"\u003e\u003c/a\u003e\u003cdiv class=\"hatena-asin-detail-info\"\u003e\u003cp class=\"hatena-asin-detail-title\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4274068269/wataro-22/\"\u003eScheme手習い\u003c/a\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e作者:\u003c/span\u003e Daniel P. Friedman,Matthias Felleisen,元吉文男,横山晶一\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e出版社/メーカー:\u003c/span\u003e \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AA%A1%BC%A5%E0%BC%D2\"\u003eオーム社\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e発売日:\u003c/span\u003e 2010/10/22\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003eメディア:\u003c/span\u003e 単行本（ソフトカバー）\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e購入\u003c/span\u003e: 5人 \u003cspan class=\"hatena-asin-detail-label\"\u003eクリック\u003c/span\u003e: 129回\u003c/li\u003e\u003cli\u003e\u003ca href=\"http://d.hatena.ne.jp/asin/4274068269/wataro-22\" target=\"_blank\"\u003eこの商品を含むブログ (33件) を見る\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cdiv class=\"hatena-asin-detail-foot\"\u003e\u003c/div\u003e\u003c/div\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cdiv class=\"hatena-asin-detail\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4873113482/wataro-22/\"\u003e\u003cimg src=\"http://ecx.images-amazon.com/images/I/51Exg14b4uL._SL160_.jpg\" class=\"hatena-asin-detail-image\" alt=\"プログラミングGauche\" title=\"プログラミングGauche\"\u003e\u003c/a\u003e\u003cdiv class=\"hatena-asin-detail-info\"\u003e\u003cp class=\"hatena-asin-detail-title\"\u003e\u003ca href=\"http://www.amazon.co.jp/exec/obidos/ASIN/4873113482/wataro-22/\"\u003eプログラミングGauche\u003c/a\u003e\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e作者:\u003c/span\u003e \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Kahua\"\u003eKahua\u003c/a\u003eプロジェクト,\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%C0%EE%B9%E7%BB%CB%CF%AF\"\u003e川合史朗\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e出版社/メーカー:\u003c/span\u003e \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AA%A5%E9%A5%A4%A5%EA%A1%BC%A5%B8%A5%E3%A5%D1%A5%F3\"\u003eオライリージャパン\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e発売日:\u003c/span\u003e 2008/03/14\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003eメディア:\u003c/span\u003e 大型本\u003c/li\u003e\u003cli\u003e\u003cspan class=\"hatena-asin-detail-label\"\u003e購入\u003c/span\u003e: 22人 \u003cspan class=\"hatena-asin-detail-label\"\u003eクリック\u003c/span\u003e: 713回\u003c/li\u003e\u003cli\u003e\u003ca href=\"http://d.hatena.ne.jp/asin/4873113482/wataro-22\" target=\"_blank\"\u003eこの商品を含むブログ (272件) を見る\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cdiv class=\"hatena-asin-detail-foot\"\u003e\u003c/div\u003e\u003c/div\u003e\u003c/p\u003e\n\n","slug":"プログラミング初心者がSICP(計算機プログラムの構造と解釈)を読んでみた"},{"data":{"title":"SICP 問題 5.50","published":"2016/02/12","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e4.1節の超循環評価器を5.5で作った翻訳系で\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eする．\u003cbr/\u003e\n　\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.serendip.ws/archives/4020\"\u003e\u0026#x554F;\u0026#x984C;5.50 \u0026ndash; SICP\u0026#xFF08;\u0026#x8A08;\u0026#x7B97;\u0026#x6A5F;\u0026#x30D7;\u0026#x30ED;\u0026#x30B0;\u0026#x30E9;\u0026#x30E0;\u0026#x306E;\u0026#x69CB;\u0026#x9020;\u0026#x3068;\u0026#x89E3;\u0026#x91C8;\u0026#xFF09;\u0026#x305D;\u0026#x306E;302 : Serendip - Web\u0026#x30C7;\u0026#x30B6;\u0026#x30A4;\u0026#x30F3;\u0026#x30FB;\u0026#x30D7;\u0026#x30ED;\u0026#x30B0;\u0026#x30E9;\u0026#x30DF;\u0026#x30F3;\u0026#x30B0;\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://himoiku.cocolog-nifty.com/blog/2008/07/sicp550_f385.html\"\u003ehttp://himoiku.cocolog-nifty.com/blog/2008/07/sicp550_f385.html\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eここを参考にしました．\u003cbr/\u003e\nまずここに書いてるmapが\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%B0%A4%EB\"\u003eバグる\u003c/a\u003eっていうのがわからないところからスタート．\u003cbr/\u003e\nエラーメッセージを見ても原因がmapだとは気づかず，\u003cbr/\u003e\nこの２つのブログを参考にしながら修正するも，翻訳系がダメなのか\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%BF%A5%D7%A5%EA%A5%BF\"\u003eインタプリタ\u003c/a\u003eがダメなのかもなかなかわからず．\u003cbr/\u003e\n　\u003cbr/\u003e\n三日間いろいろなバグに出会いながら最後まで残ったのが２つ．\u003cbr/\u003e\n一つ目はどこかで環境の保護がされていないために，\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003eのベースケースから戻ってきても環境が回復されずその後の計算がおかしくなるバグ．\u003cbr/\u003e\n二つ目はレキシカルアドレッシングで翻訳時環境から得たアドレスが狂うバグ．\u003cbr/\u003e\n一つ目は最終的にソースをenvで検索してpreservingまたはmake-instruction-sequenceでenvが足らないところがないか探しました．\u003cbr/\u003e\nレキシカルアドレッシングの実装時に，作ったcompile-variablesとcompile-assignmentのmake-instruction-sequenceのneededにenvが入っていないためでした．\n二つ目の原因は内部定義でした．\u003cbr/\u003e\n翻訳時環境が拡張されるのはcompile-lambda-bodyだけなので，内部定義でフレームが拡張されず，\u003cbr/\u003e\nfind-variableが指すアドレスがこのシンボルがない時の環境でのアドレスなので実行時環境では違うものを指してしまいバグっていました．\u003cbr/\u003e\nこれの解決策として，scan-out-definesでmake-letを使い内部定義を全てletに吐き出し，\u003cbr/\u003e\nそれをlet-\u003ecombinationでlambdaに変換することで解決しました．\u003cbr/\u003e\n根本的な解決ではないですが，とりあえず，\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eについては問題なく動きます．\u003cbr/\u003e\n　\u003cbr/\u003e\n以下はテスト．\n翻訳系のREPLのEC-COMPからdriver-loopを呼び出し，\u003cbr/\u003e\n翻訳系で\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eした\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%BF%A5%D7%A5%EA%A5%BF\"\u003eインタプリタ\u003c/a\u003eのREPL，MC-Evalに入っています．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;;;EC-COMP input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e proc lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'((\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecount \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproduct \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e n count\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        product\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e count\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e count product\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e120\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      n\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         n\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e120\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter count product\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e n count\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        product\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e count\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e count product\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; MC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e120\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.50"},{"data":{"title":"SICP 問題 5.49","published":"2016/02/10","tags":["scheme","SICP"]},"content":"\n\u003cp\u003ecompileとassembleを機械計算として持ち，REPLを行う\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EC%A5%B8%A5%B9%A5%BF\"\u003eレジスタ\u003c/a\u003e計算機を設計する．\u003cbr/\u003e\n　\u003cbr/\u003e\nはじめ，assembleを命令列の上でやる方法がわからずに，compile-and-assembleという手続きを作り，\u003cbr/\u003e\nそれを機械演算として登録してRCEPLを実装したが，\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"http://www.serendip.ws/archives/4005\"\u003e\u0026#x554F;\u0026#x984C;5.49 \u0026ndash; SICP\u0026#xFF08;\u0026#x8A08;\u0026#x7B97;\u0026#x6A5F;\u0026#x30D7;\u0026#x30ED;\u0026#x30B0;\u0026#x30E9;\u0026#x30E0;\u0026#x306E;\u0026#x69CB;\u0026#x9020;\u0026#x3068;\u0026#x89E3;\u0026#x91C8;\u0026#xFF09;\u0026#x305D;\u0026#x306E;301 : Serendip - Web\u0026#x30C7;\u0026#x30B6;\u0026#x30A4;\u0026#x30F3;\u0026#x30FB;\u0026#x30D7;\u0026#x30ED;\u0026#x30B0;\u0026#x30E9;\u0026#x30DF;\u0026#x30F3;\u0026#x30B0;\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eここでそれをうまく回避していたので真似た．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eload\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;./eval.scm\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eload\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;./compiler.scm\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eload\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;./register-machine-simulator.scm\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eload\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;./eceval.scm\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ercepl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e RCEPL\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e rcepl-proc\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e eceval-procedure\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompile compile\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eassemble assemble\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ercepl rcepl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003estatements statements\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e RCEPL\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-machine\n   rcepl-proc\n   \u003cspan class=\"synSpecial\"\u003e'((\u003c/span\u003eassign machine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop rcepl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;直接RCEPLを指せないので\u003c/span\u003e\n     read-compile-execute-print-loop\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop initialize-stack\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop prompt-for-input\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e\u0026quot;;;;EC-COMP input:\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign exp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop read\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop get-global-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel print-result\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel read-compile-execute\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n     print-result\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop print-stack-statistics\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop announce-output\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e\u0026quot;;;;EC-COMP value\u0026quot;\u003c/span\u003e:\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop user-print\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel read-compile-execute-print-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n     read-compile-execute\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compile\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg exp\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst return\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e()))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign exp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop statements\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop assemble\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg exp\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg machine\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart-rcepl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e the-global-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart RCEPL\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\ntest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart-rcepl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;;;EC-COMP input:\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            n\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;;EC-COMP value\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;;EC-COMP input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e20\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e78\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e40\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;;EC-COMP value\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2432902008176640000\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.49"},{"data":{"title":"SICP 問題 5.48","published":"2016/02/10","tags":["scheme","SICP"]},"content":"\n\u003cp\u003eECEVALのrepl上で\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003e出来るようにする．\u003cbr/\u003e\nこれで動くかなって思ったら動いた．\u003cbr/\u003e\nただトレースした命令列を見ると，\u003cbr/\u003e\napply-dispatchからprimitive-procedureにジャンプせずに先頭に戻っている．\u003cbr/\u003e\nなぜそうなるのかわからない．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; 環境を拡張してprimitive-procedureとしてcompile-and-run を登録\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment-with-compile\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompile-and-run\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive compile-and-run\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; setup-environment-with-compileの環境からecevalに入るようにする\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-and-go expression\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einstructions\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassemble \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estatements\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile expression \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereturn \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n                   eceval\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e the-global-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment-with-compile\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! eceval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval instructions\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! eceval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eflag true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart eceval\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e; ; and-goとは違い環境の初期設定はいらない．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-and-run expression\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einstructions\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassemble \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estatements\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile expression \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereturn \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n                   eceval\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! eceval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval instructions\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! eceval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eflag true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart eceval\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 環境をwith-compileのほうにしてflagをfalseにしてからecevalに入る．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart-eceval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e the-global-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment-with-compile\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! eceval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eflag false\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart eceval\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.48"},{"data":{"title":"SICP 問題 5.47","published":"2016/02/10","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eした手続きから積極制御評価器で定義した手続きを使えるようにする．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-procedure-call target linkage\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprimitive-branch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-label \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive-branch\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompiled-branch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-label \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompiled-branch\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-branch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-label \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompound-branch\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; compound-branchの作成\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eafter-call \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-label \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eafter-call\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompiled-linkage\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e linkage \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e after-call linkage\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n        \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eprimitive-branch\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n       \u003cspan class=\"synComment\"\u003e;; compiled-branchへの分岐を追加\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n        \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003ecompiled-branch\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n       \u003cspan class=\"synComment\"\u003e;; primitiveでもcompiledでもなかったらcompoundとして処理．\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eparallel-instruction-sequences\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n         compound-branch\n         \u003cspan class=\"synComment\"\u003e;; compiledと同じようにcompound-proc-applで命令を作る\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-proc-appl target compiled-linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eparallel-instruction-sequences\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n             compiled-branch\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-proc-appl target compiled-linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n             primitive-branch\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eend-with-linkage\n              linkage\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n               \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eproc argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n       after-call\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; ほとんどcompile-proc-applと同じで，continueをセーブしてからcompappにジャンプする．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; compappには(label procedure-apply)が入っている．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-proc-appl target linkage\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e target \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e linkage \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereturn\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n          \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e all-regs\n          \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003elinkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg compapp\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e target \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e linkage \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereturn\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-return \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-label \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eproc-return\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n            \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e all-regs\n            \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eproc-return\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg compapp\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eproc-return\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003elinkage\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e target \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e linkage \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereturn\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n          \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eproc continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e all-regs\n          \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg compapp\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e target \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e linkage \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereturn\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;return linkage, target not val -- COMPILE\u0026quot;\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; ec-evalの命令の先頭でcompappを初期化する．\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e'((\u003c/span\u003eassign compapp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel compound-apply\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;追加\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel external-entry\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     read-eval-print-loop\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop initialize-stack\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\ntest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-and-go\n       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ebegin\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ x \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e12\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e x \u003cspan class=\"synConstant\"\u003e20\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e22\u003c/span\u003e\n\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-and-go\n       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e x \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e13\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eした定義の上書き，\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eしていない定義へのアクセスの両方がうまくいっている．\u003c/p\u003e\n\n","slug":"SICP 問題 5.47"},{"data":{"title":"SICP 問題 5.46","published":"2016/02/10","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e5.45と同様に今度は\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%A3%A5%DC%A5%CA%A5%C3%A5%C1%BF%F4%CE%F3\"\u003eフィボナッチ数列\u003c/a\u003eの計算でそれぞれ比べる．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e fib  \u003cspan class=\"synComment\"\u003e;;一回目以外は省略\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-machine\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u0026lt; \u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e- \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003econtroller\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           fib-loop\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u0026lt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synComment\"\u003e;; Fib(n-1)を計算するよう設定\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;n の昔の値を退避\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop -\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;n を n-1 に変える\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e               \u003cspan class=\"synComment\"\u003e;再帰呼び出しを実行\u003c/span\u003e\n           afterfib-n-1                \u003cspan class=\"synComment\"\u003e;戻った時 Fib(n-1) は val にある\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synComment\"\u003e;; Fib(n-2)を計算するよう設定\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop -\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;Fib(n-1) を退避\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           afterfib-n-2            \u003cspan class=\"synComment\"\u003e;戻った時 Fib(n-2) の値は val にある\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;n には Fib(n-2) がある\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e           \u003cspan class=\"synComment\"\u003e;val には Fib(n-1) がある\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val                   \u003cspan class=\"synComment\"\u003e;Fib(n-1) + Fib(n-2)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop +\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;呼び出し側に戻る．答えは val にある\u003c/span\u003e\n           immediate-answer\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e          \u003cspan class=\"synComment\"\u003e;基底の場合: Fib(n)=n\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           fib-done\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop print-stack-statistics\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\nfib\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e28\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e28\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e48\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e80\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e12\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e13\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e132\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e14\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e21\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e216\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e34\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fib\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e352\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e18\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fib \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e55\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\n翻訳系\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-and-go\n       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u0026lt; n \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              n\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e- n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e- n \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e15\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e23\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e39\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e63\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e11\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e103\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e13\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e167\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e15\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e13\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e271\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e17\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e21\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e439\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e19\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e34\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e711\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e21\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e55\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\n積極制御評価器\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      n\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e72\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e13\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e128\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e18\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e240\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e23\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e408\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e28\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e688\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e33\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1136\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e38\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e13\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1864\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e43\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e21\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3040\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e48\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e34\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-fib \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4944\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e53\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e55\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eプッシュ数\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e n   \u003c/th\u003e\n\u003cth style=\"text-align:right;\"\u003e 計算機 \u003c/th\u003e\n\u003cth style=\"text-align:right;\"\u003e 翻訳系 \u003c/th\u003e\n\u003cth style=\"text-align:right;\"\u003e 評価器 \u003c/th\u003e\n\u003cth style=\"text-align:right;\"\u003e 評/機 \u003c/th\u003e\n\u003cth style=\"text-align:right;\"\u003e 翻/機 \u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e 3   \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e    8 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e  23 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e   128  \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 16.0 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 2.87 \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e 4 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 16 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e  39 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 240 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 15.0 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 2.43 \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e5 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 28 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 63 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 408 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 14.57\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 2.25 \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e6 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 48\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 103 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 688 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 14.33 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e2.14\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e7 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 80 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 167\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 1136 \u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e14.2\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e2.08\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e8\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e132\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e271\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e1864\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 14.12\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e2.05\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e9\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e216\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e439\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e3040\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e14.07\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e 2.03\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e352\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e711\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e4944\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e14.04\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e2.01|\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e20\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e43780\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e87567\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e612936\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e14.0\u003c/td\u003e\n\u003ctd style=\"text-align:right;\"\u003e2.0\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\n 最大スタック深さ\u003c/p\u003e\n\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e 計算機\u003c/th\u003e\n\u003cth\u003e 翻訳系\u003c/th\u003e\n\u003cth\u003e 評価器 \u003c/th\u003e\n\u003cth\u003e評/機\u003c/th\u003e\n\u003cth\u003e 翻/機\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e2n-2\u003c/td\u003e\n\u003ctd\u003e2n+1\u003c/td\u003e\n\u003ctd\u003e5n+3\u003c/td\u003e\n\u003ctd\u003e2.500\u003c/td\u003e\n\u003ctd\u003e1.00\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\n\n","slug":"SICP 問題 5.46"},{"data":{"title":"SICP 問題 5.45","published":"2016/02/10","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eした階乗計算，積極制御評価器の階乗計算，特殊目的計算機のプッシュ数，最大スタック深さを調べて比較する．\u003c/p\u003e\n\n\u003cp\u003eまずは\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eしたものから\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-and-go\n       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e= n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e- n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\nok\n\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e11\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e24\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e13\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e120\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e15\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e720\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e17\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e12\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e5040\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e19\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e14\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e40320\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e21\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e362880\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e23\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e18\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e3628800\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eプッシュ数は2n+3\u003cbr/\u003e\n最大スタック深さは2n-2\u003cbr/\u003e\n　\u003cbr/\u003e\n次に積極制御評価器で計測する．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\nok\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e48\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e13\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e80\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e18\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e112\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e23\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e24\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e144\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e28\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e120\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e176\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e33\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e720\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e208\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e38\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e5040\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e240\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e43\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e40320\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e272\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e48\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e362880\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eec-factorial \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e304\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e53\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; EC-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e3628800\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eプッシュ数は32n-16\u003cbr/\u003e\n最大スタック深さは5n+3\u003cbr/\u003e\n　\u003cbr/\u003e\n最後に階乗計算のための特殊計算機で計測する．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e fact  \u003cspan class=\"synComment\"\u003e;; 二回目以降の初期化は省略\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-machine\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e= \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e- \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003econtroller\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           fact-loop\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop =\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel base-case\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop -\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-fact\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           after-fact\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop *\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           base-case\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           fact-done\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop print-stack-statistics\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\nfact\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e24\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e120\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e720\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e12\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e12\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e5040\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e14\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e14\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e40320\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e16\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e362880\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-register-contents! fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003en \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ndone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003estart fact\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etotal-pushes \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e18\u003c/span\u003e maximum-depth \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e18\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003edone\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-register-contents fact \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e3628800\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eプッシュ数が2n-2\n最大スタック深さが2n-2．\u003c/p\u003e\n\n\u003cp\u003e比べると，積極制御評価器は\u003cbr/\u003e\ntotal: 32n-16\u003cbr/\u003e\nmax: 5n+3\u003cbr/\u003e\n　\u003cbr/\u003e\n翻訳系は\u003cbr/\u003e\ntotal: 2n+3\u003cbr/\u003e\nmax: 2n-2\u003cbr/\u003e\n　\u003cbr/\u003e\n階乗計算機は\u003cbr/\u003e\ntotal: 2n-2\u003cbr/\u003e\nmax: 2n-2\u003cbr/\u003e\n　\u003cbr/\u003e\n本来はここで翻訳系と階乗計算機のほうがはるかに優れていることを確認するはずが\u003cbr/\u003e\nここまでの問題で最適化したため，ほとんど性能差がなくなっている．\u003cbr/\u003e\n比率を出すと積極制御評価器とは\u003cbr/\u003e\ntotalが1:16\u003cbr/\u003e\nmaxは2:5の性能差になる．\u003c/p\u003e\n\n\u003cp\u003eここで本当に翻訳系が2nで収まっているのか確認のために\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eした命令列を出力させる．\u003cbr/\u003e\nsaveしているところを確認する．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile\n       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e= n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e- n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-lambda2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        entry1\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003en\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop false?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel false-branch4\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        true-branch3\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        false-branch4\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;; false-branchのcontinue\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e          \u003cspan class=\"synComment\"\u003e;; false-branchのenv\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop get-global-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst factorial\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch6\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        compiled-branch7\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel proc-return9\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        proc-return9\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call8\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        primitive-branch6\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        after-call8\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        after-if5\n        after-lambda2\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop define-variable!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst factorial\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003efalse-branchでcontinueとenvをsaveしているだけなので最大スタック深さが2n-2なのは確かなようだ．\u003cbr/\u003e\nプッシュ数が2n+3なのは(factorial 1)でも5回プッシュされてるところを見ると，\u003cbr/\u003e\n引数を適用する段階でされているのでこれ以上は無理だろう．\u003cbr/\u003e\nfactorialは基本計算しか使っていないので，open-code最適化がかなり効いてるためのこれだけ性能がよくなってると思われる．\u003c/p\u003e\n\n","slug":"SICP 問題 5.45"},{"data":{"title":"SICP 問題 5.44","published":"2016/02/09","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e基本手続きの名前を含む式の正しいコードを翻訳するため，翻訳時環境を調べるようにする．\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e  (cond ((self-evaluating? exp)\n         (compile-self-evaluating exp target linkage))\n        ((variable? exp)\n         (compile-variable exp target linkage ct-env))\n        ((quoted? exp) (compile-quoted exp target linkage))\n        ((assignment? exp)\n         (compile-assignment exp target linkage ct-env))\n        ((definition? exp)\n         (compile-definition exp target linkage ct-env))\n        ((if? exp) (compile-if exp target linkage ct-env))\n        ((lambda? exp)\n         (compile-lambda exp target linkage ct-env))\n        ((let? exp)\n         (compile (let-\u0026gt;combination exp) target linkage ct-env))\n        ((begin? exp)\n         (compile-sequence (begin-actions exp)\n                           target linkage ct-env))\n        ((cond? exp) (compile (cond-\u0026gt;if exp) target linkage ct-env))\n        ((open-code? exp ct-env)           ;ct-envも渡して翻訳時環境に上書きされていないか調べる\n         (compile-open-code exp target linkage ct-env))\n        ((application? exp)\n         (compile-application exp target linkage ct-env))\n        (else\n         (error \u0026#34;Unknown expression type -- COMPILE\u0026#34; exp))))\n\n(define (not-overwrite? op ct-env)\n  (let ((address (find-variable op ct-env )))\n    (eq? address \u0026#39;not-found)))\n\n(define (open-code? exp ct-env)\n  (and (memq (car exp) \u0026#39;(= * - +))\n       (not-overwrite? (car exp) ct-env)))\u003c/pre\u003e\n\n\n\u003cp\u003etest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry14\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-lambda15\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  entry14\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a b x y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a b x y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;ここで+を探すのにct-envの中身から探しているので成功.open-codeになっていない．\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a b x y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a b x y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a b x y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch19\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  compiled-branch20\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call21\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  primitive-branch19\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-call21\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a b x y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a b x y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a b x y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch16\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  compiled-branch17\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call18\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  primitive-branch16\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-call18\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch22\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  compiled-branch23\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  primitive-branch22\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-call24\n  after-lambda15\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.44"},{"data":{"title":"SICP 問題 5.43","published":"2016/02/09","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e内部定義を吐き出して\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003eする．\u003cbr/\u003e\nまず4.16で作ったscan-out-definesがこれ．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-defines proc-body defines non-defines\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e defines\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e non-defines\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-defines \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e defines\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e non-defines\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-defines \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e defines \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e non-defines\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esplits \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-defines body \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefines \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e splits\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enon-defines \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e splits\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e defines\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          non-defines\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                              defines\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                                      defines\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                 non-defines\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\nこれをcompile-lambda-bodyで使う\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-lambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e proc-entry ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eformals \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n      \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eenv proc argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n      \u003cspan class=\"synSpecial\"\u003e`(,\u003c/span\u003eproc-entry\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eformals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n     \u003cspan class=\"synComment\"\u003e;; ここでscan-out-definesでlambda-bodyを変換してからcompile-sequenceに渡す\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereturn \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e formals ct-env\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　　\u003cbr/\u003e\nこれはletに変換するのでcompileにletを追加する．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-self-evaluating \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-quoted \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-lambda \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                           \u003cspan class=\"synComment\"\u003e; letの追加\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u0026gt;combination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u0026gt;if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eopen-code? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e               \u003cspan class=\"synComment\"\u003e;open-code?でdispatch\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-application \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown expression type -- COMPILE\u0026quot;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003etest\nまずはscan-out-definesから．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine x \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ey c\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ x c\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ a b y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ey \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e x \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e y \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ec\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e x c\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b y\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\n期待通りに動いている．\u003cbr/\u003e\n次にcompile．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB\"\u003eコンパイル\u003c/a\u003e後の命令列を追ったのでコメントをつけた．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'((\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine x \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ey c\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ x c\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ a b \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ey \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv proc argl continue val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"synComment\"\u003e;; procにentry56の手続き\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry56\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-lambda57\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        entry56\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; (a b)を(5 6)に対応して拡張\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; proc: entry58\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry58\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-lambda59\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        entry58\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; (x y)に(*unassigned* *unassigned*)を対応付け\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; x のオブジェクトを1にする\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-set!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; val: entry60\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry60\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-lambda61\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        entry60\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; ((c) (6))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ec\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; arg1: 1\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ec\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; arg2: 2\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ec\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synComment\"\u003e;; val: (+ 1 2) = 3\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        after-lambda61\n        \u003cspan class=\"synComment\"\u003e;; y \u0026lt;= entry60\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-set!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                 \u003cspan class=\"synComment\"\u003e;aftercall71\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;(+ a b) =\u0026gt;(+ 5 6) =\u0026gt; 11\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;argl: (2)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch62\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        compiled-branch63\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel proc-return65\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;continue: proc-return65\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        proc-return65\n        \u003cspan class=\"synComment\"\u003e;; arg2: 7\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call64\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        primitive-branch62\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        after-call64\n        \u003cspan class=\"synComment\"\u003e;; val: (+ 11 3) = 14\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassin val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e              \u003cspan class=\"synComment\"\u003e;aftercall71\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        after-lambda59\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;argl: (*unassigned* *unassigned*)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch66\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        compiled-branch67\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;val: entry58\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        primitive-branch66\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        after-call68\n        after-lambda57\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e          \u003cspan class=\"synComment\"\u003e;val: 6\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;argl: (6)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e          \u003cspan class=\"synComment\"\u003e;val: 5\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;argl: (5 6)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;no\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch69\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        compiled-branch70\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call71\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;continue: aftercall71\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;val: entry56\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        primitive-branch69\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        after-call71                    \u003cspan class=\"synComment\"\u003e;val 14\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e期待通りに内部定義を吐き出してlambdaで\u003cem\u003eunassigned\u003c/em\u003eとして受け取り，\u003cbr/\u003e\nbodyで実際の値（手続き）にset!している．\u003c/p\u003e\n\n","slug":"SICP 問題 5.43"},{"data":{"title":"SICP 問題 5.42","published":"2016/02/09","tags":["scheme","SICP"]},"content":"\n\u003cp\u003ecompile-variableとcompile-assignmentを文面アドレスを使った検索に対応\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eaddress \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efind-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e ct-env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eend-with-linkage\n     linkage\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e address \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enot-found\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n          \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synComment\"\u003e;; targetなら変更しても問題ないので一時的に帯域環境を入れる\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop get-global-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eexp\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n          \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eaddress\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evar \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-value-code                 \u003cspan class=\"synComment\"\u003e;valを求めるための命令．\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext ct-env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eaddress \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efind-variable var ct-env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eend-with-linkage\n      linkage\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n                  get-value-code \u003cspan class=\"synComment\"\u003e;代入する値を求め，valに代入される．seq1\u003c/span\u003e\n                  \u003cspan class=\"synComment\"\u003e;; valに代入された値をvarに代入する．seq2\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e address \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enot-found\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n                       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eenv val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       \u003cspan class=\"synComment\"\u003e;; 一度targetにglobal-environmentを代入してからsetする\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign target \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop get-global-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop set-variable-value!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003evar\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n                       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eenv val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-set!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eaddress\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))))))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003etest\u003cbr/\u003e\nこの\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/scheme\"\u003escheme\u003c/a\u003eの式自体はバグってる．\u003cbr/\u003e\nただし，test自体は出来るのでそのまま\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile\n       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ x a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* y b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset! x a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; +の中でset!してるので 'okが返ってバグる\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset! z b\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval\n       \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\n       \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry24\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-lambda25\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  entry24\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry26\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  entry26\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-set!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; arg2 = ok\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; (+ arg1 ok)なのでバグる\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lexical-address-lookup\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop get-global-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop set-variable-value!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassin val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-lambda27\n  after-lambda25\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.42"},{"data":{"title":"SICP 問題 5.41","published":"2016/02/09","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e翻訳時環境に対する変数の文面アドレスを返す手続きfind-variableの実装\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efind-variable var ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop frame-address env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan variable-address frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e frame-address \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e frame-address variable-address\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e variable-address \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enot-found\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003etest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efind-variable \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ec \u003cspan class=\"synSpecial\"\u003e'((\u003c/span\u003ey z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c d e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efind-variable \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ex \u003cspan class=\"synSpecial\"\u003e'((\u003c/span\u003ey z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c d e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efind-variable \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ew \u003cspan class=\"synSpecial\"\u003e'((\u003c/span\u003ey z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c d e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\nnot-found\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.41"},{"data":{"title":"SICP 問題 5.40","published":"2016/02/09","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e翻訳時環境を維持し，compile-lambda-bodyで拡張するように変更する．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-lambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e proc-entry ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; ct-envを追加\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eformals \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n      \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eenv proc argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n      \u003cspan class=\"synSpecial\"\u003e`(,\u003c/span\u003eproc-entry\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eformals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereturn \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e formals ct-env\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; ct-envを拡張\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e後はcompileするときに引数にct-envを取るように書く手続きを変更する．\u003c/p\u003e\n\n","slug":"SICP 問題 5.40"},{"data":{"title":"SICP 問題 5.39","published":"2016/02/09","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e文面アドレスと実行時環境とり値を検索するlexical-address-lookupと\n値を変更するlexical-address-set!を実装する．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;;; 文面アドレスを使って変数の値を探す\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-lookup lex-add r-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist-ref\u003c/span\u003e r-env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lex-add\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist-ref\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e lex-add\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e val \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;*Unassigned* variable\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          val\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; 文面アドレスにある値を変更する\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-set! lex-add val r-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist-ref\u003c/span\u003e r-env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lex-add\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter frame count\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003ebegin\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e frame val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e lex-add\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003etest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e my-env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e the-global-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\nmy-env\ngosh\u0026gt; my-env\n\u003cspan class=\"synSpecial\"\u003e(((\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efalse true \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\n  \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e car\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e cdr\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e cons\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e null?\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u0026gt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e \u003cspan class=\"synError\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e \u003cspan class=\"synError\"\u003e+\u0026gt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e *\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e /\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e \u0026gt;\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive \u003cspan class=\"synError\"\u003e#\u0026lt;subr\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026lt;\u0026gt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-lookup \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e my-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-lookup \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e my-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-lookup \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e my-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-lookup \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e my-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-set! \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003escheme my-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\nok\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-lookup \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e my-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\nscheme\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-set! \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eSICP my-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\nok\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elexical-address-lookup \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e my-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\nSICP\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.39"},{"data":{"title":"SICP 問題 5.38d","published":"2016/02/08","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e+と*について任意個の被\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B1%E9%BB%BB%BB%D2\"\u003e演算子\u003c/a\u003eの式が使えるように拡張する．\u003cbr/\u003e\n　\u003cbr/\u003e\nここに書いた手続きを変更もしくは追加する．\u003cbr/\u003e\n３つ以上の引数の時はarg1に畳み込んで計算していく．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code-operand \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e*\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code-operand-2\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;invalid application: \u0026quot;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code-operand \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eargs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003espread-arguments \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e ct-env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eend-with-linkage linkage\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epreserving\n                       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       \u003cspan class=\"synComment\"\u003e;; co-arg2がopen-code式だった場合にarg1が上書きされるので退避させる．\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epreserving\n                        \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1 env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n                         \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1 arg2 env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e)))))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; operandが無くてprocが+なら1を，*なら0をtargetに代入．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; operandが一つだけならそのままの値をtargetに入れる．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; operandが３つ以上なら\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code-operand-2 proc operands target linkage ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e operands\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-self-evaluating \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;+なら0\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-self-evaluating \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;*なら1\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e operands\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eend-with-linkage linkage\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e target \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext ct-env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e                           \u003cspan class=\"synComment\"\u003e;引数が３つ以上ならこちらで処理\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eoperand \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003espread-arguments operands ct-env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eend-with-linkage\n            linkage\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code-operand-3 proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; ここに渡されるseqはコンパイルされた引数のリスト．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; last-seqだとarg1を保護しながら最後の引数をarg2に代入して\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; 最後にarg1, arg2をprocした結果をvalに代入する．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; まだ残っているときはarg1を保護しながら引数をarg2に代入して\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; arg1とarg2をprocした結果をarg1に代入する\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code-operand-3 proc seq target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elast-seq? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epreserving\n       \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1 env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n        \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1 arg2 env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassin \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epreserving\n        \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1 env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1 arg2 env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                   \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code-operand-3 proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; operandが0または1以外の時はここでcompileする．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;; 一つ目だけarg1に代入し，残りはarg2に代入する．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003espread-arguments operand ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eoperand \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eresult \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003earg1 \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext ct-env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003earg2 \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext ct-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elast-seq? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003etest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e+\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e*\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e+ \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003earg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econt \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e* \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003earg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econt \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e+ \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg1 arg2 val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e* \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg1 arg2 val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e+ \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg1 arg2 val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassin target \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e+ \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg1 arg2 val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassin target \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e+ \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg1 arg2 val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassin target \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e* \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg1 arg2 val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassin target \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eおかしいところはなく動いている．\u003c/p\u003e\n\n","slug":"SICP 問題 5.38d"},{"data":{"title":"SICP 問題 5.38c","published":"2016/02/08","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e元のcompileによる出力と5.38abでcompile-open-codeを追加した\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%E9\"\u003eコンパイラ\u003c/a\u003eの出力を比べる．\u003cbr/\u003e\n命令列が約半分になっている．\u003c/p\u003e\n\n\u003cp\u003ecompile-open-codeを追加した\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%D1%A5%A4%A5%E9\"\u003eコンパイラ\u003c/a\u003eの出力\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-lambda2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  entry1\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003en\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop false?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel false-branch4\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  true-branch3\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  false-branch4\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst factorial\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch6\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  compiled-branch7\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel proc-return9\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  proc-return9\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call8\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  primitive-branch6\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-call8\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-if5\n  after-lambda2\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop define-variable!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst factorial\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e元のcompileによる出力\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eenv\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eval\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop make-compiled-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel entry1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-lambda2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  entry1\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign env \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop extend-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003en\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch6\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  compiled-branch7\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call8\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  primitive-branch6\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-call8\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop false?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel false-branch4\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  true-branch3\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  false-branch4\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst factorial\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop lookup-variable-value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch9\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  compiled-branch10\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call11\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  primitive-branch9\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-call11\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch12\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  compiled-branch13\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-call14\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  primitive-branch12\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-call14\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore argl\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign argl \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop primitive-procedure?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel primitive-branch15\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  compiled-branch16\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop compiled-procedure-entry\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  primitive-branch15\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop apply-primitive-procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg argl\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-call17\n  after-if5\n  after-lambda2\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eperform \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop define-variable!\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst factorial\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst ok\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.38c"},{"data":{"title":"SICP 問題 5.38ab","published":"2016/02/08","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e+ - * = はopen-codeとして\n(reg val (op +)  (reg arg1) (reg arg2))\nの形で処理できるようにする．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eopen-code? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ememq\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e= * - +\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-self-evaluating \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-quoted \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-lambda \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u0026gt;if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eopen-code? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e               \u003cspan class=\"synComment\"\u003e;open-code?でdispatch\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-application \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown expression type -- COMPILE\u0026quot;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003espread-arguments operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e      \u003cspan class=\"synComment\"\u003e;それぞれコンパイルしてリストにして返す\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eco-arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003earg1 \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eco-arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e operand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003earg2 \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e co-arg1 co-arg2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile-open-code \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e target linkage\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eargs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003espread-arguments \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eend-with-linkage linkage\n                          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eappend-instruction-sequences\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"synComment\"\u003e;; co-arg2がopen-code式だった場合にarg1が上書きされるので退避させる．\u003c/span\u003e\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epreserving\n                            \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-instruction-sequence\n                             \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003earg1 arg2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             \u003cspan class=\"synSpecial\"\u003e`((\u003c/span\u003eassign \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003etarget \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synSpecial\"\u003e,\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;require 2 operand\u0026quot;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003etest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompile \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e+ \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eval \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enext\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg1 arg2 val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg1 arg2 val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign arg2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg arg2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 5.38ab"}],"currentPage":3,"pages":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},"__N_SSG":true},"page":"/posts/pages/[page]","query":{"page":"3"},"buildId":"A1Wu7EQPosfnUh_uET58m","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>