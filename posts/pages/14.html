<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Posts | (wat-aro)</title><meta name="title" content="(wat-aro)"/><meta name="description"/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="(wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/images/profile.jpg"/><meta property="og:url" content="https://wat-aro.dev/posts/pages/14"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="(wat-aro)"/><meta name="twitter:description"/><meta name="twitter:image" content="https://wat-aro.dev/images/profile.jpg"/><meta name="next-head-count" content="17"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/02ced8e6983f7546.css" as="style"/><link rel="stylesheet" href="/_next/static/css/02ced8e6983f7546.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d3eeee857401101e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/pages/%5Bpage%5D-da379a09c6772a61.js" defer=""></script><script src="/_next/static/MwAZdhrPfcr2hZiH7rGrL/_buildManifest.js" defer=""></script><script src="/_next/static/MwAZdhrPfcr2hZiH7rGrL/_ssgManifest.js" defer=""></script><script src="/_next/static/MwAZdhrPfcr2hZiH7rGrL/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full  flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li><li class="h-full  flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts/pages/1">Blog</a></li></ul></div><div class="flex md:justify-center justify-between w-full"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><h1 class="text-3xl mb-4">Posts</h1><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.13"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.13</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/19</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.12"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.12</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/19</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.10"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.10</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/19</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.09"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.09</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/19</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.08"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.08</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/11</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.07"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.07</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/07</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.5"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.5</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/06</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.4"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.4</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/06</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.06"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.06</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/06</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.3"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.3</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/05</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.2"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.2</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/05</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%203.1"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 3.1</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/05</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.91"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.91</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/05</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.89"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.89</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/05</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.88"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.88</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/04</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.87"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.87</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/04</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.86"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.86</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/04</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.85"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.85</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/03</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.84"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.84</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/02</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.83"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.83</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/01</div></div></a></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"data":{"title":"SICP 問題 3.13","published":"2015/11/19","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-cycle x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elast-pair x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  s\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e z \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-cycle \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eb \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ec\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003ezのポインタ図．\u003c/p\u003e\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003ca href=\"http://f.hatena.ne.jp/wat-aro/20151119224757\" class=\"hatena-fotolife\" itemprop=\"url\"\u003e\u003cimg src=\"http://cdn-ak.f.st-hatena.com/images/fotolife/w/wat-aro/20151119/20151119224757.jpg\" alt=\"f:id:wat-aro:20151119224757j:image\" title=\"f:id:wat-aro:20151119224757j:image\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/a\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003e(last-pair z)\u003c/code\u003eを計算しようとするとlast-pair?が#tになることがないので終わらない．\u003c/p\u003e\n\n","slug":"SICP 問題 3.13"},{"data":{"title":"SICP 問題 3.12","published":"2015/11/19","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003ca href=\"http://f.hatena.ne.jp/wat-aro/20151119223928\" class=\"hatena-fotolife\" itemprop=\"url\"\u003e\u003cimg src=\"http://cdn-ak.f.st-hatena.com/images/fotolife/w/wat-aro/20151119/20151119223928.jpg\" alt=\"f:id:wat-aro:20151119223928j:image\" title=\"f:id:wat-aro:20151119223928j:image\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/a\u003e\u003c/span\u003e\u003c/p\u003e\n\n","slug":"SICP 問題 3.12"},{"data":{"title":"SICP 問題 3.10","published":"2015/11/19","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e w1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-withdraw \u003cspan class=\"synConstant\"\u003e100\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; E2(balance:100)-\u0026gt;E1(initial-amount:100)-\u0026gt;global\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ew1 \u003cspan class=\"synConstant\"\u003e50\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; E3-\u0026gt;(amount:50)-\u0026gt;E2(balance:50)-\u0026gt;E1(initial-amount:100)-\u0026gt;global\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ew2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-withdraw \u003cspan class=\"synConstant\"\u003e100\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; E5(balance:100)-\u0026gt;E4(initial-amount:100)-\u0026gt;global\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 3.10"},{"data":{"title":"SICP 問題 3.09","published":"2015/11/19","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e階乗を計算する手続き\u003ccode\u003e(factorial 6)\u003c/code\u003eの環境構造を示す．\u003c/p\u003e\n\n\u003cp\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactorial \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"http://cdn-ak.f.st-hatena.com/images/fotolife/w/wat-aro/20151119/20151119211757.jpg\" alt=\"f:id:wat-aro:20151119211757j:plain\" title=\"f:id:wat-aro:20151119211757j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003e \n \n反復\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e factorial\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003en\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact-iter \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e fact-iter\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproduct counter max-count\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e counter max-count\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\nproduct\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efact-iter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e counter product\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e counter \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\nmax-count\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"http://cdn-ak.f.st-hatena.com/images/fotolife/w/wat-aro/20151119/20151119211800.jpg\" alt=\"f:id:wat-aro:20151119211800j:plain\" title=\"f:id:wat-aro:20151119211800j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n","slug":"SICP 問題 3.09"},{"data":{"title":"SICP 問題 3.08","published":"2015/11/11","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e f\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e a \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      a\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e(f 0) (f 1)の順に評価したら0,0が返り，(f 1) (f 0)の順に評価すると1, 0 が返ってくれば題意を満たしたことになる．\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; (define f\n  (let ((a 1))\n    (lambda (x)\n      (set! a (* a x))\n      a)))\nf\ngosh\u0026gt; (f 0)\n0\ngosh\u0026gt; (f 1)\n0\ngosh\u0026gt; (define f\n  (let ((a 1))\n    (lambda (x)\n      (set! a (* a x))\n      a)))\nf\ngosh\u0026gt; (f 1)\n1\ngosh\u0026gt; (f 0)\n0\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; letをlambdaで書き換えてみた\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e f\n  \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e a \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e a x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      a\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 3.08"},{"data":{"title":"SICP 問題 3.07","published":"2015/11/07","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-account balance password\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ewithdraw amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;=\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003ebegin\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e balance \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               balance\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synConstant\"\u003e\u0026quot;Insufficient funds\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edeposit amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e balance \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    balance\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elogin-error amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;Incorrect password\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edispatch pass m\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e pass password\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e m \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ewithdraw\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e withdraw\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e m \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edeposit\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e deposit\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown request: MAKE-ACCOUNT\u0026quot;\u003c/span\u003e\n                           m\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        login-error\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  dispatch\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-joint account password new-account-password\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edispatch entered-pass m\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e entered-pass new-account-password\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaccount password m\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synConstant\"\u003e\u0026quot;Incorrect password\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  dispatch\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; (define peter-acc\n  (make-account 100 \u0026#39;open-sesame))\npeter-acc\ngosh\u0026gt; (define paul-acc\n  (make-joint peter-acc \u0026#39;open-sesame \u0026#39;rosebud))\npaul-acc\ngosh\u0026gt; ((paul-acc \u0026#39;rosebud \u0026#39;deposit) 30)\n130\ngosh\u0026gt; ((paul-acc \u0026#39;rosebud \u0026#39;withdraw) 50)\n80\ngosh\u0026gt; ((peter-acc \u0026#39;open-sesame \u0026#39;withdraw) 50)\n30\u003c/pre\u003e\n\n\n\u003cp\u003e意図したように動いてくれてます．\u003cbr/\u003e\npaul-accで 80まで減らしてpeterが50引き出すと残り30ってことは両方のアカウントが同じものを指してるってことですからね．\u003cbr/\u003e\nただdefineで口座の指定をすると参照先のアカウントのパスワードが間違ってた場合に,make-jointする時点でエラー返したいですよね．\u003cbr/\u003e\nこのやりかたじゃそれができないっていうのが気になります．\u003c/p\u003e\n\n","slug":"SICP 問題 3.07"},{"data":{"title":"SICP 問題 3.5","published":"2015/11/06","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euse srfi-27\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erandom-in-range low high\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003erange \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e high low\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e low \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erandom-real\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e range\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; 問題分には(+ low (random range))となっている．\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eestimate-integral P x1 x2 y1 y2 trials\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex-length \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e x2 x1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ey-length \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e y2 y1\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esquare-area \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e x-length y-length\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e square-area \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emonte-carlo trials\n                                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eP \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erandom-in-range x1 x2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erandom-in-range y1 y2\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eestimate-integral \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                   \u003cspan class=\"synConstant\"\u003e-1.0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e-1.0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10000\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; 3.1436\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ccode\u003eestimate-integral\u003c/code\u003eの中で\u003ccode\u003e(random-in-range x1 x2)\u003c/code\u003eと\u003ccode\u003e(random-in-range x1 x2)\u003c/code\u003eをletで束縛して\u003ccode\u003emonte-carlo\u003c/code\u003eに渡していたためなかなかうまくいきまんでした．\u003c/p\u003e\n\n","slug":"SICP 問題 3.5"},{"data":{"title":"SICP 問題 3.4","published":"2015/11/06","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-account balance password\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecounter \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ewithdraw amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;=\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003ebegin\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e balance \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                 balance\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synConstant\"\u003e\u0026quot;Insufficient funds\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edeposit amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e balance \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      balance\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elogin-error amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e counter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e counter\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;=\u003c/span\u003e counter \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoll-the-cop\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synConstant\"\u003e\u0026quot;Incorrect password\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecall-the-cops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synConstant\"\u003e\u0026quot;110\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edispatch pass m\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e pass password\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e m \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ewithdraw\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e counter \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 withdraw\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e m \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edeposit\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e counter \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 deposit\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown request: MAKE-ACCOUNT\u0026quot;\u003c/span\u003e\n                             m\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          login-error\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    dispatch\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 3.4"},{"data":{"title":"SICP 問題 3.06","published":"2015/11/06","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; オリジナルのrand\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e rand \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex random-init\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erand-update x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                 x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 'generateで乱数生成，'resetで引数の数字で初期化するrand\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e rand\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ex random-init\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereset new-rand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e x new-rand\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egenerate\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erand-update x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edispatch m\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e m \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereset\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             reset\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e m \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003egenerate\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egenerate\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown argument -- RAND\u0026quot;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e m\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    dispatch\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 3.06"},{"data":{"title":"SICP 問題 3.3","published":"2015/11/05","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-account balance password\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ewithdraw amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;=\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003ebegin\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e balance \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               balance\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synConstant\"\u003e\u0026quot;Insufficient funds\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edeposit amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e balance \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e balance amount\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    balance\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elogin-error amount\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;Incorrect password\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edispatch pass m\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e pass password\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e m \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ewithdraw\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e withdraw\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e m \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edeposit\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e deposit\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown request: MAKE-ACCOUNT\u0026quot;\u003c/span\u003e\n                           m\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        login-error\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  dispatch\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; (define acc (make-account 100 \u0026#39;secret-password))\nacc\ngosh\u0026gt; ((acc \u0026#39;secret-password \u0026#39;withdraw) 50)\n50\ngosh\u0026gt; ((acc \u0026#39;some-password \u0026#39;deposit) 40)\n\u0026#34;Incorrect password\u0026#34;\u003c/pre\u003e\n\n\n","slug":"SICP 問題 3.3"},{"data":{"title":"SICP 問題 3.2","published":"2015/11/05","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-monitored f\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003emf \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ein\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e in \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ehow-many-calls?\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e mf\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e in \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereset-count\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e mf \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e mf \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e mf\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef in\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; (define s (make-monitored sqrt))\ns\ngosh\u0026gt; (s 100)\n10\ngosh\u0026gt; (s \u0026#39;how-many-calls?)\n1\ngosh\u0026gt; (s \u0026#39;reset-count)\n0\ngosh\u0026gt; (s \u0026#39;how-many-calls?)\n0\u003c/pre\u003e\n\n\n","slug":"SICP 問題 3.2"},{"data":{"title":"SICP 問題 3.1","published":"2015/11/05","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-accumulator n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esum n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enum\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eset!\u003c/span\u003e sum \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e sum num\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      sum\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; (define A (make-accumulator 5))\nA\ngosh\u0026gt; (A 10)\n15\ngosh\u0026gt; (A 10)\n25\u003c/pre\u003e\n\n\n","slug":"SICP 問題 3.1"},{"data":{"title":"SICP 問題 2.91","published":"2015/11/05","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ediv-terms L1 L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eempty-termlist? L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethe-empty-termlist\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethe-empty-termlist\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003et1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethe-empty-termlist\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enew-c \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ediv \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoeff t1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoeff t2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enew-o \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003erest-of-result\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ediv-terms \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-terms L1\n                                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emul-terms L2\n                                                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-term new-o\n                                                                 new-c\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                                L2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-terms \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-term new-o new-c\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e rest-of-result\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e rest-of-result\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ediv-poly p1 p2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-variable? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evariable p1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evariable p2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-poly \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evariable p1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ediv \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eterm-list p1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eterm-list p2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Polys not in same var -- DIV POLY\u0026quot;\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e p1 p2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.91"},{"data":{"title":"SICP 問題 2.89","published":"2015/11/05","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; 2.89\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; 濃い多項式に適している実装\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-polynomial valiable term-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e valiable term-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evaliable p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eterm-list p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evaliable? v\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e v\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-valiable? v1 v2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evaliable? v1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evaliable? v2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e v1 v2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e=zero-term? L\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eL1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eterm-list L\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eempty-termlist? L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e=zero? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoeff \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst L1\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e=zero-term? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L1\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term term term-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e term term-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eempty-termlist\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term term-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e term-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms term-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e term-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eempty-termlist? term-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e term-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-term order coeff\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e coeff \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiota order \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder term\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms term\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoeff term\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term term\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-terms L\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eempty-termlist? L\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      empty-termlist\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaddjoin-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst term\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-terms \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-terms L1 L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eempty-termlist? L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eempty-termlist? L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003et1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eo1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder L1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eo2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder L2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e o1 o2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term t1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-terms \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e o1 o2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term t2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-terms L1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaddjoin-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd t1 t2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-terms \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L2\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-terms L1 L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eempty-termlist? L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eempty-termlist? L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-terms L1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003et1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eo1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder L1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eo2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder L2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e o1 o2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term t1\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-terms \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e o1 o2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative t2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-terms L1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub t1 t2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-terms \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L2\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emul-terms L1 L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eempty-termlist? L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethe-empty-termlist\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eempty-termlist? L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethe-empty-termlist\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-terms\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emul-term-by-all-terms\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiota \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emul-terms \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L2\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emul-term-by-all-terms t L\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eempty-termlist L\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms t\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-join-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emul \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term t\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emul-term-by-all-terms t \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.89"},{"data":{"title":"SICP 問題 2.88","published":"2015/11/04","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; polynominal-package\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e=zero? p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoeff p\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=zero? \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003epolynominal\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e=zero? p\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; 2.88\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enegative x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; scheme-number\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-integer x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-integer x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; rational\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-rational x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-rational \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enumer x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edenom x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003erational\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-raitonal x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; real\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-real x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-real \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ereal\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-real x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; complex\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; rect-angler\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-rectangler x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-complex-from-mag-ang \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e180\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eangle\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003erectangler\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-rectangler x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; real-imag\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-polar x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-complex-from-real-imag \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003epolar\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-polar x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; polynomial\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-term p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emul-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-term \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e-1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-terms L1 L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eempty-termlist? L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eempty-termlist? L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-term L2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003et1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-term L2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term\n                   t1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-terms L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e L2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-term L2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-term L1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-term L2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-term\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eorder t1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoeff t1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoeff t2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-term \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-term L1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-term L2\u003cspan class=\"synSpecial\"\u003e)))))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enegative \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003epolynomil\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enegative-term x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esub \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003epolynomiial \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esub-terms L1 L2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.88"},{"data":{"title":"SICP 問題 2.87","published":"2015/11/04","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; polynominal-package\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e=zero? p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecoeff p\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=zero? \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003epolynominal\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e=zero? p\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.87"},{"data":{"title":"SICP 問題 2.86","published":"2015/11/04","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare-root x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare-root x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esine x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esine x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecosine x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecosine x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eatangent x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eatangent x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; scheme-number\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e x x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare-root \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esqrt\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esine \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esin\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecosine \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecos\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eatangent \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eatan\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; rational\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003erational\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-rat \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enumer x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edenom x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare-root \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003erational\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-real \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esqrt\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproject x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esine \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003erational \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-real \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esin\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproject x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;real\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecosine \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003erational \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-real \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecos\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproject x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;real\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eatangent \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003erational \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-real \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eatan\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproject x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;real\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; real\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ereal\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare-root \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ereal\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esqrt\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esine \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ereal\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esin\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecosine \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ereal\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecos\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eatangent \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ereal\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eatan\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; complex\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-complex-from-real-imag \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eimag\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esquare-root \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-complex-from-mag-ang \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esqrt\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eangle\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003esine \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-complex-from-real-imag \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esin\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esin\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecosine \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-complex-from-real-imag \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecos\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecos\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eatangent \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-complex-from-real-imag \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eatan\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eatan\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.86"},{"data":{"title":"SICP 問題 2.85","published":"2015/11/03","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einstall-project-packege\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproject x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eproject x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eproject \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecomplex \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-real \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eproject \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereal \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003erational \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003einexact-\u0026gt;exact\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-rational \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumerator\u003c/span\u003e rational\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edenominator\u003c/span\u003e rational\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eproject \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003erational \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-scheme-number \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eround\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enumer x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edenom x\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edone\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edrop x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprojected \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eproject \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eraised \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag projected\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e projected\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eequ? x raised\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edrop projected\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        x\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype-tags \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e type-tag args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etower \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex real rational scheme-number\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-type? a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag b\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-\u0026lt; a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esame-type? a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e tower\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e tower\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-\u0026lt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag a\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag b\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e b\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ehighest-type lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eresult \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype-\u0026lt; result \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter result \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-highest-type high lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etarget x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e high target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             target\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag target\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                    target\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n           lst\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget op types\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e proc\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edrop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e contents args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;drop\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enew-args \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-highest-type \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ehighest-type args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                             args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget op \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e new-args\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e proc\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edorp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e contents new-args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;drop\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Nomethod for these types\u0026quot;\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e op type-tags\u003cspan class=\"synSpecial\"\u003e)))))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.85"},{"data":{"title":"SICP 問題 2.84","published":"2015/11/02","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype-tags \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e type-tag args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etower \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex real rational scheme-number\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; 同じタイプか調べる述語\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-type? a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag b\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; aよりもbのほうが階層が高いか調べる述語\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; 両方をraiseしながらcomplexに先になったほうが階層が高い\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-\u0026lt; a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esame-type? a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e tower\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e tower\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-\u0026lt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag a\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag b\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e b\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; リストの中でもっとも高い階層の型を調べる\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ehighest-type lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eresult \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype-\u0026lt; result \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter result \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; リストの要素すべてを最も階層の高い型highまでraiseする\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-highest-type high lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etarget x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e high target\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             target\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag target\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                    target\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n           lst\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget op types\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e proc\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e contents args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enew-args \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-highest-type \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ehighest-type args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                             args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget op \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e new-args\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e proc\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e contents new-args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Nomethod for these types\u0026quot;\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e op type-tags\u003cspan class=\"synSpecial\"\u003e)))))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.84"},{"data":{"title":"SICP 問題 2.83","published":"2015/11/01","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eraise x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; scheme-numberパッケージで\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escheme-number-\u0026gt;rational n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-rational n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003escheme-number scheme-number-\u0026gt;rational\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; rationalパッケージで\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erational-\u0026gt;real x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enumer x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edenom x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003erational rational-\u0026gt;real\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; real-numberパッケージで\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereal-\u0026gt;complex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-complex-from-real-imag x \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eraise \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereal-number real-\u0026gt;complex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.83"}],"page":14},"__N_SSG":true},"page":"/posts/pages/[page]","query":{"page":"14"},"buildId":"MwAZdhrPfcr2hZiH7rGrL","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>