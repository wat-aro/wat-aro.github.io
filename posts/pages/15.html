<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Posts | (wat-aro)</title><meta name="title" content="(wat-aro)"/><meta name="description"/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="(wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/images/profile.jpg"/><meta property="og:url" content="https://wat-aro.dev/posts/pages/15"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="(wat-aro)"/><meta name="twitter:description"/><meta name="twitter:image" content="https://wat-aro.dev/images/profile.jpg"/><meta name="next-head-count" content="17"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/7c83ce157486acf1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7c83ce157486acf1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f557e2d34bba2226.js" defer=""></script><script src="/_next/static/chunks/pages/posts/pages/%5Bpage%5D-c3e4d8daf70d966d.js" defer=""></script><script src="/_next/static/vDqnfS-2Qy9jo2afqVhBT/_buildManifest.js" defer=""></script><script src="/_next/static/vDqnfS-2Qy9jo2afqVhBT/_ssgManifest.js" defer=""></script><script src="/_next/static/vDqnfS-2Qy9jo2afqVhBT/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full  flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li><li class="h-full  flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts/pages/1">Blog</a></li></ul></div><div class="flex md:justify-center justify-between w-full"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><h1 class="text-3xl mb-4">Posts</h1><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.82"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.82</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/11/01</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.81"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.81</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/31</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.80"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.80</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/31</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.79"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.79</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/31</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.78"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.78</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/31</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.77"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.77</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/31</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.76"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.76</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/30</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.75"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.75</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/30</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.74"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.74</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/30</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/%E3%82%A8%E3%83%A9%E3%83%88%E3%82%B9%E3%83%86%E3%83%8D%E3%82%B9%E3%81%AE%E7%AF%A9"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">エラトステネスの篩</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/28</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.73"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.73</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/28</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.71"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.71</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.70"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.70</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.69"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.69</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.68"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.68</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.67"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.67</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.66"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.66</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.65"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.65</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.64"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.64</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><a class="border-b-2 border-gray-200 border-opacity-0 hover:border-opacity-100" href="/posts/SICP%20%E5%95%8F%E9%A1%8C%202.58b"><div class="flex pt-2 pb-1 justify-between"><div class="text-xl md:w-5/6 w-9/12">SICP 問題 2.58b</div><div class="text-gray-500 md:w-1/6 w-3/12 flex justify-end">2015/10/27</div></div></a><div class="flex gap-4 py-4 justify-center"><a href="/posts/pages/1">1<!-- --></a><a href="/posts/pages/2">2<!-- --></a><a href="/posts/pages/3">3<!-- --></a><a href="/posts/pages/4">4<!-- --></a><a href="/posts/pages/5">5<!-- --></a><a href="/posts/pages/6">6<!-- --></a><a href="/posts/pages/7">7<!-- --></a><a href="/posts/pages/8">8<!-- --></a><a href="/posts/pages/9">9<!-- --></a><a href="/posts/pages/10">10<!-- --></a><a href="/posts/pages/11">11<!-- --></a><a href="/posts/pages/12">12<!-- --></a><a href="/posts/pages/13">13<!-- --></a><a href="/posts/pages/14">14<!-- --></a><div class="font-bold">15<!-- --></div><a href="/posts/pages/16">16<!-- --></a><a href="/posts/pages/17">17<!-- --></a><a href="/posts/pages/18">18<!-- --></a><a href="/posts/pages/19">19<!-- --></a><a href="/posts/pages/20">20<!-- --></a><a href="/posts/pages/21">21<!-- --></a><a href="/posts/pages/22">22<!-- --></a></div></div></div><div class="flex md:justify-center w-full"><div class="flex flex-col md:max-w-4xl w-full"><hr/><div class="flex justify-center pt-4 pb-8">© 2022 wat-aro</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"data":{"title":"SICP 問題 2.82","published":"2015/11/01","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype-tags \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e type-tag args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etry-coercion args tags\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e tags\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Nomethod for these types\u0026quot;\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e op type-tags\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enew-args \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-coercion \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e tags\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                               args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enew-type-tags \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e type-tag new-args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eperoc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget op \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enew-type-tags\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e proc\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtents new-args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etry-coercion new-args \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e tags\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003epero \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget op types\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e proc\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e contents args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etry-coercion args typep-tags\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.82"},{"data":{"title":"SICP 問題 2.81","published":"2015/10/31","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; a\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype-tags \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e type-tag args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget op type-tags\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e proc \u003cspan class=\"synComment\"\u003e;;false\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e contents args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e type-tags\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e type-tags\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003et1-\u0026gt;t2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-coercion type1 type2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2-\u0026gt;t1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-coercion type2 type1\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et1-\u0026gt;t2 \u003cspan class=\"synComment\"\u003e;;true\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et1-\u0026gt;t2 a1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e a2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;complex-\u0026gt;complex\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2-\u0026gt;t1\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op a1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2-\u0026gt;t1 a2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;No method for these types\u0026quot;\u003c/span\u003e\n                                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e op type-tags\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Nomethod for these types\u0026quot;\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e op type-tags\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 引数に二つの複素数を持ってexpを呼び出すと，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; procがfalseになり，complexからcomplexへの変換を無限ループする\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; b\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; 無限ループに陥るのでLouisはまちがっている\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; c\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype-tags \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e type-tag args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget op type-tags\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e proc\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e contents args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e type-tags\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e type-tags\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;同じtype-tagならエラーになる\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etype1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e type-tags\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e type-tags\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003et1-\u0026gt;t2 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-coercion type1 type2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2-\u0026gt;t1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-coercion type2 type1\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et1-\u0026gt;t2\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et1-\u0026gt;t2 a1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e a2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2-\u0026gt;t1\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic op a1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003et2-\u0026gt;t1 a2\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;No method for these types\u0026quot;\u003c/span\u003e\n                                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e op type-tags\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Nomethod for these types\u0026quot;\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e op type-tags\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.81"},{"data":{"title":"SICP 問題 2.80","published":"2015/10/31","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e=zero? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=zero? x y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; scheme-numberパッケージに追加\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=zero? \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e x \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; rationalパッケージに追加\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=zero? \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003erational\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enumer x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; complexパッケージに追加\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=zero? \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.80"},{"data":{"title":"SICP 問題 2.79","published":"2015/10/31","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; scheme-numberパッケージに追加\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eequ? \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003escheme-number scheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etag \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e x y\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; rationalパッケージに追加\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eequ? \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003erational rational\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enumer x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enumer y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edenom x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edenom y\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; complexパッケージに追加\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eequ \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex complex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e y\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eequ? x y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eequ? x y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.79"},{"data":{"title":"SICP 問題 2.78","published":"2015/10/31","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eattach-tag type-tag contents\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e type-tag \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      contents\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e type-tag contents\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etype-tag datum\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e datum\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e datum\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e datum\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Bad tagged datum -- TYPE-TAG\u0026quot;\u003c/span\u003e datum\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtents datum\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e datum\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003escheme-number\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e datum\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e datum\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Bad tagged datum -- CONTENTS\u0026quot;\u003c/span\u003e datum\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.78"},{"data":{"title":"SICP 問題 2.77","published":"2015/10/31","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereal-part \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ereal-part\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eimag-part \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eimag-part\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003emagnitude \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eangle \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eangle\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; magnitudeはcomplex型を知らないのでerrorを返す．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; なので表にcomplex型を追加すれば動く．\u003c/span\u003e\n\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecomplex ractangular \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecomplex ractangular \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003emagnitude \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ecomplex\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eractangular \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eractangular \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-generic \u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eractangular \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003emagnitude \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003eractangular\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emagnitude\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esqrt\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esquare \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;=\u0026gt;\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.77"},{"data":{"title":"SICP 問題 2.76","published":"2015/10/30","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e;; 明示的ディスパッチによる\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B8%A5%A7%A5%CD%A5%EA%A5%C3%A5%AF\"\u003eジェネリック\u003c/a\u003e演算\nデータの型が追加されるたびに各演算にその型用の演算を追加していく．\n新しい演算が追加されたときはそれを追加するだけ．\u003c/p\u003e\n\n\u003cp\u003e;; データ主導スタイル\nデータの型が追加されると，それらをパッケージを作ってputする．\n各型パッケージにその演算を追加する．\u003c/p\u003e\n\n\u003cp\u003e;; メッセージパッシングスタイル\nデータが追加されたときは特になし\n新しい演算が追加されたときは，各データ型に演算を追加する．\u003c/p\u003e\n\n\u003cp\u003eデータ新しい型がよく追加されるならメッセージパッシングスタイルが向いている．\n新しい演算が追加されるときには明示的ディスパッチが向いている．\u003c/p\u003e\n\n","slug":"SICP 問題 2.76"},{"data":{"title":"SICP 問題 2.75","published":"2015/10/30","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-from-mag-ang r a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edispatch op\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e op \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003emagnitude\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e r\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e op \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eangle\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e a\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e op \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ereal-part\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e r \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecos\u003c/span\u003e a\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e op \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eimag-part\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e r \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esin\u003c/span\u003e a\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown op -- MAKE-FROM-MAG-ANG\u0026quot;\u003c/span\u003e op\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n  dispatch\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.75"},{"data":{"title":"SICP 問題 2.74","published":"2015/10/30","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; a\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; 各事業所ごとに従業員ファイルを作っていると考え，person-fileのcar部に\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; 従業所を識別するコードを入れるようにする．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-record name  person-file\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eget-record \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edivision person-file\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e name file\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edivision file\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e file\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; b\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; ここではrecordが(name salary age)となってると考える．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; この事業所のrecordからsalaryを取り出すにはcadrを取れば良い\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget-salary name record\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eget-salary \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eidentifying person-file\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e record\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; c\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efind-employee-record name division-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e division-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      false\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eserch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eget-record \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edivision x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e name x\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eserch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e division-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eserch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e division-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efind-employee-record name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e division-list\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; d\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; その新しく合併した会社の従業員レコードから情報を得るget-recordとget-salaryなどの\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; 必要な手続きを作りパッケージを作成し，本社の表にputすればよい．\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.74"},{"data":{"title":"エラトステネスの篩","published":"2015/10/28","tags":["scheme"]},"content":"\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003eで\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeratosthenes n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erecur lis\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erecur\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003efilter\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emodulo\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                        lis\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erecur \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiota \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eround\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e繰り返しで\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeratosthenes n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter lis result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        result\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003efilter\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emodulo\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                      lis\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e result \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiota \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eできるだけ元の論理通りにやってみました．\u003cbr/\u003e\nあの斜線つけるやつね．\u003c/p\u003e\n\n","slug":"エラトステネスの篩"},{"data":{"title":"SICP 問題 2.73","published":"2015/10/28","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esame-variable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e;; a\n元のプログラムと違うのはelseの行．\u003cbr/\u003e\noperatorの型に合わせたderivが呼ばれ残りの要素を処理する．\u003cbr/\u003e\nnumberとvariableはリストでないので型を持たないため，データ主導の振り分けに吸収できない．\u003c/p\u003e\n\n\u003cp\u003e;; b\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einstall-deriv-sum-package\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv-sum \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-sum \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaddend \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaugend \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-sum a1 a2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e a1 \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e a2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e a2 \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e a1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e a1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e a2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a1 a2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ a1 a2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaddend x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaugend x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ deriv-sum\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003emake \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ make-sum\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edone\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einstall-deriv-product-package\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv-product \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eget \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003emake-sum \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-product \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emultiplier \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emultiplicand \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-product \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emultiplicand \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emultiplier \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-product m1 m2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e m1 \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e m2 \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e m1 \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e m2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e m2 \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e m1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eand\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e m1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e m2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e m1 m2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* m1 m2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emultiplier x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emultiplicand x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* deriv-product\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003emake \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* make-product\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edone\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e;; c\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einstall-exponent-package\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv-exponent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003emake-product \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eget make \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e*\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-product\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-product \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexponent x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-exponentiation \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebase x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexponent x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebase x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexponent x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebase x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-exponent b e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e b \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e** b e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ederiv \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e** deriv-exponent\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eput \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003emake \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e** make-exponent\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edone\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e;; d\nputの演算と型を入れ替える\u003c/p\u003e\n\n","slug":"SICP 問題 2.73"},{"data":{"title":"SICP 問題 2.71","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"http://cdn-ak.f.st-hatena.com/images/fotolife/w/wat-aro/20151027/20151027213831.jpg\" alt=\"f:id:wat-aro:20151027213831j:plain\" title=\"f:id:wat-aro:20151027213831j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\n\u003cspan itemscope itemtype=\"http://schema.org/Photograph\"\u003e\u003cimg src=\"http://cdn-ak.f.st-hatena.com/images/fotolife/w/wat-aro/20151027/20151027213854.jpg\" alt=\"f:id:wat-aro:20151027213854j:plain\" title=\"f:id:wat-aro:20151027213854j:plain\" class=\"hatena-fotolife\" itemprop=\"image\"\u003e\u003c/span\u003e\u003c/p\u003e\n\n\u003cp\u003en = 5のとき，最高頻度の記号には4bit.最低頻度の記号には1bit必要．\nn = 10のとき，最高頻度の記号には9bit.最低頻度の記号には1bit必要．\u003c/p\u003e\n\n","slug":"SICP 問題 2.71"},{"data":{"title":"SICP 問題 2.70","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; (define q-pairs \u0026#39;((A 2) (BOOM 1) (GET 2) (JOB 2) (NA 16) (SHA 3)\n                       (YIP 9) (WAH 1)))\nq-pairs\ngosh\u0026gt; (define q-tree\n  (successive-merge (make-leaf-set q-pairs)))\nq-tree\ngosh\u0026gt; (define message\n  \u0026#39;(GET A JOB\n    SHA NA NA NA NA NA NA NA NA\n    GET A JOB\n    SHA NA NA NA NA NA NA NA NA\n    WAH YIP YIP YIP YIP YIP YIP YIP YIP YIP\n    SHA BOOM))\nmessage\ngosh\u0026gt; (encode message q-tree)\n(1 1 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 \n 0 0 0 0 0 0 0 0 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 1 0 1 1 0 1 1)\ngosh\u0026gt; (length (encode message q-tree))\n84\ngosh\u0026gt; (decode (encode message q-tree) q-tree)\n(GET A JOB SHA NA NA NA NA NA NA NA NA GET A JOB \n SHA NA NA NA NA NA NA NA NA WAH YIP YIP YIP YIP YIP YIP YIP YIP YIP SHA BOOM)\u003c/pre\u003e\n\n\n\u003cp\u003e符号化には84bit必要．\n八記号アルファベットの固定長符号の場合は\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt;(length message)\n36\u003c/pre\u003e\n\n\n\u003cp\u003e36 * (log2 8) = 108\nなので108bit必要．\u003c/p\u003e\n\n","slug":"SICP 問題 2.70"},{"data":{"title":"SICP 問題 2.69","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egenerate-huffman-tree pairs\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esuccessive-merge \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-leaf-set pairs\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; pairsは昇順に並んでいるので先頭の2要素をmake-code-pairsする．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; それを(cddr pairs)にadjoin-setすればまた昇順に並んだpairsができるのでそれを繰り返す．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esuccessive-merge pairs\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e pairs\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e pairs\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esuccessive-merge \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-set \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-code-pairs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e pairs\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e pairs\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e pairs\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.69"},{"data":{"title":"SICP 問題 2.68","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eencode message tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e message\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eencode-symbol \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e message\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eencode \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e message\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eencode-symbol msg tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleaf? tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ememq\u003c/span\u003e msg \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esymbols \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleft-branch tree\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eencode-symbol msg \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleft-branch tree\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ememq\u003c/span\u003e msg \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esymbols \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eright-branch tree\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eencode-symbol msg \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eright-branch tree\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror symbol \u003cspan class=\"synConstant\"\u003e\u0026quot;is not Found\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; (encode \u0026#39;(A D A B B C A) sample-tree)\n(0 1 1 0 0 1 0 1 0 1 1 1 0)\ngosh\u0026gt; (decode (encode \u0026#39;(A D A B B C A) sample-tree) sample-tree)\n(A D A B B C A)\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.68"},{"data":{"title":"SICP 問題 2.67","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; Huffman木\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-leaf symbol weight\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eleaf symbol weight\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleaf? object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eleaf\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esymbol-leaf x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eweight-leaf x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-code-tree left right\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e left\n        right\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esymbols left\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esymbols right\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eweight left\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eweight right\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleft-branch tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eright-branch tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esymbols tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleaf? tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esymbol-leaf tree\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eweight tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleaf? tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eweight-leaf tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; bitが0なら左，1なら右の枝をたどっていき，leafにたどり着くと，そのシンボルをconsして次にいく．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edecode bits tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edecode-1 bits current-branch\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e bits\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enext-branch\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003echoose-branch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e bits\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e current-branch\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleaf? next-branch\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esymbol-leaf next-branch\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edecode-1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e bits\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edecode-1 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e bits\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e next-branch\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edecode-1 bits tree\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; bitが左ならleft-branch,bitが右ならright-branchを選択\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003echoose-branch bit branch\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e bit \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleft-branch branch\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e bit \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eright-branch branch\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;bad bit -- CHOOSE-BRANCH\u0026quot;\u003c/span\u003e bit\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; weightで昇順に順序づけられた集合に要素を追加する\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-set x set\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e set\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eweight x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eweight \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e set\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e x set\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e set\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-set x \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e set\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; pairsからweightの昇順にleafの集合を作る．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-leaf-set pairs\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e pairs\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003epair \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e pairs\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadjoin-set \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-leaf \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e pair\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e pair\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-leaf-set \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e pairs\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003egosh\u0026gt; (define sample-tree\n        (make-code-tree (make-leaf \u0026#39;A 4)\n                        (make-code-tree\n                         (make-leaf \u0026#39;B 2)\n                         (make-code-tree (make-leaf \u0026#39;D 1)\n                                         (make-leaf \u0026#39;C 1)))))\nsample-tree\ngosh\u0026gt; (define sample-message\n        \u0026#39;(0 1 1 0 0 1 0 1 0 1 1 1 0))\nsample-message\ngosh\u0026gt; (decode sample-message sample-tree)\n(A D A B B C A)\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.67"},{"data":{"title":"SICP 問題 2.66","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-tree given-key set-of-records\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ekey-record \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ekey \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e set-of-records\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e set-of-records\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e given-key key-record\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e set-of-records\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e given-key key-record\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-tree given-key \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eleft-branch set-of-records\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e key-record given-key\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-tree given-key \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eright-branch set-of-records\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.66"},{"data":{"title":"SICP 問題 2.65","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eunion-tree s t\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-\u0026gt;tree\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eunion-set \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etree-\u0026gt;list-2 s\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etree-\u0026gt;list-2 t\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintersection-tree s t\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-\u0026gt;tree\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintersection-set-local \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etree-\u0026gt;list-2 s\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etree-\u0026gt;list-2 t\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.65"},{"data":{"title":"SICP 問題 2.64","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e;a\n先頭から(n-1)/2番目までをleft-treeとしてpartial-treeにかける．\u003cbr/\u003e\n残ったリストの先頭をthis-entryとしてこの木の分岐点におく．\u003cbr/\u003e\nそのcdrをright-treeとしてpartial-treeにかける．\u003cbr/\u003e\nこれを繰り返して木を作る．\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e      5\n   /     \\\n1         9\n  \\       /   \\\n   3    7    11\u003c/pre\u003e\n\n\n\u003cp\u003e;b\nO(n)\u003c/p\u003e\n\n","slug":"SICP 問題 2.64"},{"data":{"title":"SICP 問題 2.58b","published":"2015/10/27","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e2.58b は解けそうになかったので解答を見てできるかぎり解説を入れてみました．\u003cbr/\u003e\n一部修正しています．\n解答は↓から\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/sarabander/p2pu-sicp/blob/master/2.3/2.58.scm\"\u003ep2pu-sicp/2.58.scm at master \u0026middot; sarabander/p2pu-sicp \u0026middot; GitHub\u003c/a\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; partには'beforeか'afterが入り，symbolの位置でexpを前後に分ける．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract part symbol \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter subexp remaining\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e remaining\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e remaining\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e remaining\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e symbol\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e part \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebefore\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e subexp\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e part \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eafter\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e remaining\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unclear, do you mean 'before or after?\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e subexp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e remaining\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e remaining\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eresult \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter nil \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        result\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; リストにシンボルが入っているかを問う述語\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtains? symbol lis\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e symbol \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtains? symbol \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e lis\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; sum\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esum? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtains? \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaddend s\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebefore \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ s\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eaugend s\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eafter \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ s\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; product\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproduct? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtains? \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* x\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emultiplier p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebefore \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emultiplicand p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eafter \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; exponentiation\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexponentiation? e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtains? \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e** e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebase e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebefore \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e** e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexponent e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eafter \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e** e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e;; 簡約\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; かっこを外す\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efringe tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efringe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efringe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e tree\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 演算子で分けられたリストに分ける．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-by op polynome\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e polynome\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e polynome\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtains? op polynome\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;追加．これがないと最後の項がシングルトン以外の場合空リストになる．\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e polynome\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebefore op polynome\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-by op \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextract \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eafter op polynome\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esummands polynome\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-by \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ polynome\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efactors polynome\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-by \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* polynome\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; リストの要素の間にopを入れる\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einfix op lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e op\n                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einfix op \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einfix-add s\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einfix \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ s\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einfix-multiply p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003einfix \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; リストの先頭のリストにだけopを適用する．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-car op lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e op \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-car+ s\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-car \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e s\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-car* p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-car \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; (6)を6といった具合に数一つだけのリストをnumberにする\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erelease-singleton e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 数だけを先頭にあつめてリストにする\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egroup lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003efilter\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003efilter\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003en\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                      lst\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; リストの先頭を最後にもっていく．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eshift-left lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e lst\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; まずfringeでかっこを外し，summandsを使い，＋の位置で分けたリストに変換する．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; そのリストに対してmapで各要素にfactors,group,apply-car*,release-singletonの順に手続きを適用する．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; つまり，*でわけたリストに変換し，数字のみのリストをcarにもってきて，それに*を適用し，要素の間に＊をいれ，シングルトンがあれば，それを数字にする．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; これが全要素に完了した後に出来たリストに対して，group,apply-car+,shift-left,infix-add,fringeを順に適用する．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; 先頭に数字のみでできたリストを作り，それらを足し，リストの最後に移す．このリストの要素の間に＋を挿入し，かっこを取り払う．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esimplify polynome\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompose fringe\n            infix-add\n            shift-left\n            apply-car+\n            group\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompose release-singleton\n                 infix-multiply\n                 apply-car*\n                 group\n                 factors\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esummands \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efringe polynome\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 2.58b"}],"currentPage":15,"pages":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]},"__N_SSG":true},"page":"/posts/pages/[page]","query":{"page":"15"},"buildId":"vDqnfS-2Qy9jo2afqVhBT","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>