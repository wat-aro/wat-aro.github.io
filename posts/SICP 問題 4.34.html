<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>SICP 問題 4.34 | (wat-aro)</title><meta name="title" content="SICP 問題 4.34 | (wat-aro)"/><meta name="description" content="&lt;p&gt;遅延対とリストを正当に印字できるようにする．&lt;br/&gt;consへのタグづけがどうしてもうまくいかなくてここを参考にしました．&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://wqzhang.wordpress.com/2010/04/21/sicp-exercise-4-34/&quot;&gt;SICP Exercise 4.3"/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="SICP 問題 4.34 | (wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/og-images/SICP 問題 4.34.png"/><meta property="og:url" content="https://wat-aro.dev/posts/SICP%20%E5%95%8F%E9%A1%8C%204.34"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="SICP 問題 4.34 | (wat-aro)"/><meta name="twitter:description" content="&lt;p&gt;遅延対とリストを正当に印字できるようにする．&lt;br/&gt;consへのタグづけがどうしてもうまくいかなくてここを参考にしました．&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://wqzhang.wordpress.com/2010/04/21/sicp-exercise-4-34/&quot;&gt;SICP Exercise 4.3"/><meta name="twitter:image" content="https://wat-aro.dev/og-images/SICP 問題 4.34.png"/><meta name="next-head-count" content="17"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/0eb8a090dcab400d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0eb8a090dcab400d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e01e12084fc1c257.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-1a9f77230ec721b1.js" defer=""></script><script src="/_next/static/jBdsbeX94AlqfuENdlazh/_buildManifest.js" defer=""></script><script src="/_next/static/jBdsbeX94AlqfuENdlazh/_ssgManifest.js" defer=""></script><script src="/_next/static/jBdsbeX94AlqfuENdlazh/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full  flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li><li class="h-full  flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts">Blog</a></li></ul></div><div class="flex md:justify-center justify-between w-full flex-grow"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><article class="flex max-w-4xl w-full"><div class="py-4 w-full"><div class="mr-2 text-xs font-bold">2016/01/10</div><h1 class="font-bold text-3xl text-black">SICP 問題 4.34</h1><nav class="flex mt-2 mb-2 items-start text-gray-500 text-xs"><div class="flex flex-nowrap max-w-full overflow-x-auto"><a href="/tags/scheme"><p class="mr-1 rounded-full px-2 py-1 border leading-none">scheme</p></a><a href="/tags/SICP"><p class="mr-1 rounded-full px-2 py-1 border leading-none">SICP</p></a></div></nav><div class="znc"><p>遅延対とリストを正当に印字できるようにする．<br>
consへのタグづけがどうしてもうまくいかなくてここを参考にしました．</p>
<p><a href="https://wqzhang.wordpress.com/2010/04/21/sicp-exercise-4-34/">SICP Exercise 4.34 | Weiqun Zhang's Blog</a></p>
<p>前回からの変更箇所のみ</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>self-evaluating? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">((</span>variable? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>lookup-variable-value <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>quoted? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-quote <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>assignment? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-assignment <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>definition? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-definition <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>if? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-if <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>make-procedure <span class="synSpecial">(</span>lambda-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>lambda-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>list-lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synComment">;;list-lambda?とmake-list-procedureの追加</span>
</span><span class="code-line">         <span class="synSpecial">(</span>make-list-procedure <span class="synSpecial">(</span>lambda-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                              <span class="synSpecial">(</span>lambda-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                              env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>let? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>let->combination <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>let*? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>let*->nested-lets <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>letrec? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>letrec->let <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>begin? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>eval-sequence <span class="synSpecial">(</span>begin-actions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>cond? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>cond->if <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>and? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-and <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>or? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-or <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>application? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>my-apply <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>operator <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">                   <span class="synSpecial">(</span>operands <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                   env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span>
</span><span class="code-line">         <span class="synSpecial">(</span>error <span class="synConstant">"Unknown expression type --EVAL"</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 追加</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>list-lambda<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-list-procedure parameters body env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>list-proc parameters <span class="synSpecial">(</span>scan-out-defines body<span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; list-procに対応</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>compound-procedure? p<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">or</span> <span class="synSpecial">(</span>tagged-list? p <span class="synSpecial">'</span>procedure<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span>tagged-list? p <span class="synSpecial">'</span>list-proc<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; cons,car,cdrを削除</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> primitive-procedures
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>null? <span class="synIdentifier">null?</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>= <span class="synIdentifier">=</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>- <span class="synIdentifier">-</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>+ <span class="synIdentifier">+</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>* <span class="synIdentifier">*</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>/ <span class="synIdentifier">/</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>newline <span class="synIdentifier">newline</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>display <span class="synIdentifier">display</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'()</span> <span class="synSpecial">'())))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; list-procの時はlist-display</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>user-print object<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>tagged-list? object <span class="synSpecial">'</span>list-proc<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>list-display <span class="synSpecial">(</span>match-to object<span class="synSpecial">)))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>compound-procedure? object<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>compound-procedure
</span><span class="code-line">                        <span class="synSpecial">(</span>procedure-parameters object<span class="synSpecial">)</span>
</span><span class="code-line">                        <span class="synSpecial">(</span>procedure-body object<span class="synSpecial">)</span>
</span><span class="code-line">                        <span class="synSpecial">'</span><span class="synConstant">&#x3C;procedure-env></span><span class="synSpecial">)))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span><span class="synIdentifier">display</span> object<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 以下はlist-displayのための手続き</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>match-to obj<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>match obj
</span><span class="code-line">    <span class="synSpecial">((</span>procedure <span class="synSpecial">(</span>m<span class="synSpecial">)</span> body <span class="synSpecial">((</span>parameters exp1 exp2<span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synIdentifier">cons</span> exp1 exp2<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>first-list-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synSpecial">(</span>force-it <span class="synSpecial">(</span><span class="synIdentifier">car</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-display <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>list-display-iter <span class="synIdentifier">exp</span> <span class="synConstant">10</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-display-iter <span class="synIdentifier">exp</span> n<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">=</span> n <span class="synConstant">0</span><span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">"...)"</span><span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>when <span class="synSpecial">(</span><span class="synIdentifier">=</span> n <span class="synConstant">10</span><span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">"("</span><span class="synSpecial">))</span>
</span><span class="code-line">              <span class="synSpecial">(</span>continue-display <span class="synIdentifier">exp</span> n<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>continue-display <span class="synIdentifier">exp</span> n<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>first-list-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>second <span class="synSpecial">(</span>force-it <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> second<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">")"</span><span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">((</span><span class="synStatement">or</span> <span class="synSpecial">(</span>self-evaluating? second<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> second<span class="synSpecial">))</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">" . "</span><span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">display</span> second<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">")"</span><span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">" "</span><span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>list-display-iter <span class="synSpecial">(</span>match-to second<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">-</span> n <span class="synConstant">1</span><span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 遅延リスト用の手続き</span>
</span><span class="code-line"><span class="synSpecial">(</span>actual-value
</span><span class="code-line"> <span class="synSpecial">'(</span>begin <span class="synSpecial">(</span>define <span class="synSpecial">(</span>cons x y<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>list-lambda <span class="synSpecial">(</span>m<span class="synSpecial">)</span> <span class="synSpecial">(</span>m x y<span class="synSpecial">)))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>car z<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>z <span class="synSpecial">(</span>lambda <span class="synSpecial">(</span>p q<span class="synSpecial">)</span> p<span class="synSpecial">)))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>cdr z<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>z <span class="synSpecial">(</span>lambda <span class="synSpecial">(</span>p q<span class="synSpecial">)</span> q<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>list-ref items n<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>if <span class="synSpecial">(</span>= n <span class="synConstant">0</span><span class="synSpecial">)</span>
</span><span class="code-line">               <span class="synSpecial">(</span>car items<span class="synSpecial">)</span>
</span><span class="code-line">               <span class="synSpecial">(</span>list-ref <span class="synSpecial">(</span>cdr items<span class="synSpecial">)</span> <span class="synSpecial">(</span>- n <span class="synConstant">1</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>map proc items<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>if <span class="synSpecial">(</span>null? items<span class="synSpecial">)</span>
</span><span class="code-line">               <span class="synSpecial">'()</span>
</span><span class="code-line">               <span class="synSpecial">(</span>cons <span class="synSpecial">(</span>proc <span class="synSpecial">(</span>car items<span class="synSpecial">))</span>
</span><span class="code-line">                     <span class="synSpecial">(</span>map proc <span class="synSpecial">(</span>cdr items<span class="synSpecial">)))))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>scale-list items factor<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>map <span class="synSpecial">(</span>lambda <span class="synSpecial">(</span>x<span class="synSpecial">)</span> <span class="synSpecial">(</span>* x factor<span class="synSpecial">))</span>
</span><span class="code-line">                items<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>add-lists list1 list2<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>cond <span class="synSpecial">((</span>null? list1<span class="synSpecial">)</span> list2<span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">((</span>null? list2<span class="synSpecial">)</span> list1<span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">(</span>else <span class="synSpecial">(</span>cons <span class="synSpecial">(</span>+ <span class="synSpecial">(</span>car list1<span class="synSpecial">)</span> <span class="synSpecial">(</span>car list2<span class="synSpecial">))</span>
</span><span class="code-line">                             <span class="synSpecial">(</span>add-lists <span class="synSpecial">(</span>cdr list1<span class="synSpecial">)</span> <span class="synSpecial">(</span>cdr list2<span class="synSpecial">))))))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>define ones <span class="synSpecial">(</span>cons <span class="synConstant">1</span> ones<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define integers <span class="synSpecial">(</span>cons <span class="synConstant">0</span> <span class="synSpecial">(</span>add-lists ones integers<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>integral integrand initial-value dt<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>define int
</span><span class="code-line">             <span class="synSpecial">(</span>cons initial-value
</span><span class="code-line">                   <span class="synSpecial">(</span>add-lists <span class="synSpecial">(</span>scale-list integrand dt<span class="synSpecial">)</span>
</span><span class="code-line">                              int<span class="synSpecial">)))</span>
</span><span class="code-line">           int<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>solve f y0 dt<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>define y <span class="synSpecial">(</span>integral dy y0 dt<span class="synSpecial">))</span>
</span><span class="code-line">           <span class="synSpecial">(</span>define dy <span class="synSpecial">(</span>map f y<span class="synSpecial">))</span>
</span><span class="code-line">           y<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">)</span>
</span><span class="code-line"> the-global-environment<span class="synSpecial">)</span>
</span></code></pre>
<p>test</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line">ones
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synConstant">1</span> <span class="synConstant">1</span> <span class="synConstant">1</span> <span class="synConstant">1</span> <span class="synConstant">1</span> <span class="synConstant">1</span> <span class="synConstant">1</span> <span class="synConstant">1</span> <span class="synConstant">1</span> <span class="synConstant">1</span> ...<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synConstant">1</span> <span class="synConstant">2</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synConstant">1</span> <span class="synSpecial">.</span> <span class="synConstant">2</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>a <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>b <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>c <span class="synSpecial">'</span>d<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synSpecial">(</span>a b c <span class="synSpecial">.</span> d<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>a <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>b <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>c <span class="synSpecial">'())))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synSpecial">(</span>a b c<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line">integers
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synConstant">0</span> <span class="synConstant">1</span> <span class="synConstant">2</span> <span class="synConstant">3</span> <span class="synConstant">4</span> <span class="synConstant">5</span> <span class="synConstant">6</span> <span class="synConstant">7</span> <span class="synConstant">8</span> <span class="synConstant">9</span> ...<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line"><span class="synSpecial">'(</span><span class="synConstant">1</span> <span class="synConstant">2</span> <span class="synConstant">3</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synConstant">1</span> <span class="synConstant">2</span> <span class="synConstant">3</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line"><span class="synSpecial">'()</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synSpecial">()</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'()</span> <span class="synSpecial">'())</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synSpecial">(())</span>
</span></code></pre>
<p>以下がこの遅延評価器の全文</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synSpecial">(</span>use util.match<span class="synSpecial">)</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> true <span class="synConstant">#t</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> false <span class="synConstant">#f</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>self-evaluating? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">((</span>variable? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>lookup-variable-value <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>quoted? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-quote <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>assignment? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-assignment <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>definition? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-definition <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>if? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-if <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>make-procedure <span class="synSpecial">(</span>lambda-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>lambda-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>list-lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synComment">;;list-lambda?とmake-list-procedureの追加</span>
</span><span class="code-line">         <span class="synSpecial">(</span>make-list-procedure <span class="synSpecial">(</span>lambda-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                              <span class="synSpecial">(</span>lambda-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                              env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>let? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>let->combination <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>let*? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>let*->nested-lets <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>letrec? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>letrec->let <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>begin? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>eval-sequence <span class="synSpecial">(</span>begin-actions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>cond? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>cond->if <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>and? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-and <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>or? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-or <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>application? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>my-apply <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>operator <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">                   <span class="synSpecial">(</span>operands <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                   env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span>
</span><span class="code-line">         <span class="synSpecial">(</span>error <span class="synConstant">"Unknown expression type --EVAL"</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; メモ化する評価器</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>force-it obj<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>thunk? obj<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>result <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>thunk-exp obj<span class="synSpecial">)</span>
</span><span class="code-line">                                     <span class="synSpecial">(</span>thunk-env obj<span class="synSpecial">))))</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> obj <span class="synSpecial">'</span>evaluated-thunk<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> obj<span class="synSpecial">)</span> result<span class="synSpecial">)</span> <span class="synComment">;;expをその値で置き換える</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">set-cdr!</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> obj<span class="synSpecial">)</span> <span class="synSpecial">'())</span>    <span class="synComment">;;必要のなくなったenvを忘れる</span>
</span><span class="code-line">           result<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>evaluated-thunk? obj<span class="synSpecial">)</span> <span class="synSpecial">(</span>thunk-value obj<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> obj<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>delay-it <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>thunk <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>thunk? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>thunk<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>thunk-exp thunk<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> thunk<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>thunk-env thunk<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> thunk<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>evaluated-thunk? obj<span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? obj <span class="synSpecial">'</span>evaluated-thunk<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>thunk-value evaluated-thunk<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> evaluated-thunk<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>actual-value <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>force-it <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synIdentifier">exp</span> env<span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>foo bar<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>bar <span class="synSpecial">'</span>a<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; apply</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>my-apply procedure arguments env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>primitive-procedure? procedure<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>apply-primitive-procedure
</span><span class="code-line">          procedure
</span><span class="code-line">          <span class="synSpecial">(</span>list-of-arg-values arguments env<span class="synSpecial">)))</span> <span class="synComment">; changed</span>
</span><span class="code-line">        <span class="synSpecial">((</span>compound-procedure? procedure<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>eval-sequence
</span><span class="code-line">          <span class="synSpecial">(</span>procedure-body procedure<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">(</span>extend-environment <span class="synSpecial">(</span>procedure-parameters procedure<span class="synSpecial">)</span>
</span><span class="code-line">                              <span class="synSpecial">(</span>list-of-delayed-args arguments env<span class="synSpecial">)</span> <span class="synComment">; changed</span>
</span><span class="code-line">                              <span class="synSpecial">(</span>procedure-environment procedure<span class="synSpecial">))))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>error <span class="synConstant">"Unknown procedure type: APPLY"</span> procedure<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-of-arg-values exps env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>no-operands? exps<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">'()</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>first-operand exps<span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">            <span class="synSpecial">(</span>list-of-arg-values <span class="synSpecial">(</span>rest-operands exps<span class="synSpecial">)</span> env<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-of-delayed-args exps env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>no-operands? exps<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">'()</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span>delay-it <span class="synSpecial">(</span>first-operand exps<span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">            <span class="synSpecial">(</span>list-of-delayed-args <span class="synSpecial">(</span>rest-operands exps<span class="synSpecial">)</span> env<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-if <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>true? <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>if-predicate <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>if-consequent <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>if-alternative <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 並び</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-sequence exps env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>last-exp? exps<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>first-exp exps<span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>first-exp exps<span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">              <span class="synSpecial">(</span>eval-sequence <span class="synSpecial">(</span>rest-exps exps<span class="synSpecial">)</span> env<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 代入</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-assignment <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>set-variable-value! <span class="synSpecial">(</span>assignment-variable <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                       <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>assignment-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">                       env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">'</span>ok<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 定義</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-definition <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>define-variable!
</span><span class="code-line">    <span class="synSpecial">(</span>definition-variable <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>definition-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">    env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">'</span>ok<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 自己評価式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>self-evaluating? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">number?</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span> true<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">((</span><span class="synIdentifier">string?</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span> true<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> false<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 変数</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>variable? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; クオート</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>quoted? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>quote<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-quote obj<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>quote obj<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>quote-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-quote <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>obj <span class="synSpecial">(</span>quote-body <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> obj<span class="synSpecial">)</span> obj<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">((</span><span class="synIdentifier">symbol?</span> obj<span class="synSpecial">)</span> obj<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">((</span>self-evaluating? obj<span class="synSpecial">)</span> obj<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>quote->cons obj<span class="synSpecial">)</span> env<span class="synSpecial">)))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>quote->cons obj<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> obj<span class="synSpecial">)</span> <span class="synSpecial">(</span>make-quote obj<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span><span class="synIdentifier">symbol?</span> obj<span class="synSpecial">)</span> <span class="synSpecial">(</span>make-quote obj<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>cons <span class="synSpecial">(</span>make-quote <span class="synSpecial">(</span><span class="synIdentifier">car</span> obj<span class="synSpecial">))</span>
</span><span class="code-line">                    <span class="synSpecial">(</span>quote->cons <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> obj<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> tag<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">pair?</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span> tag<span class="synSpecial">)</span>
</span><span class="code-line">      false<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 代入</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>assignment? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>set!<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>assignment-variable <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>assignment-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 定義</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>definition? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>define<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>definition-variable <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">caadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>definition-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span>make-lambda <span class="synSpecial">(</span><span class="synIdentifier">cdadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synComment">;;仮パラメタ</span>
</span><span class="code-line">                   <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span> <span class="synComment">;;本体</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; lambda式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>lambda<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-lambda parameters body<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>lambda <span class="synSpecial">(</span><span class="synIdentifier">cons</span> parameters body<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>def-body-list proc-body<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>proc-body proc-body<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>def <span class="synSpecial">'())</span>
</span><span class="code-line">             <span class="synSpecial">(</span>body <span class="synSpecial">'()))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> proc-body<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> def<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> body<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">((</span>definition? <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">))</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                                               <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> def<span class="synSpecial">)</span>
</span><span class="code-line">                                               body<span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                      def
</span><span class="code-line">                      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> body<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>list-lambda<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-list-procedure parameters body env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>list-proc parameters <span class="synSpecial">(</span>scan-out-defines body<span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 4.17</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>scan-out-defines body<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>split-def-body proc-body<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>proc-body proc-body<span class="synSpecial">)</span>
</span><span class="code-line">               <span class="synSpecial">(</span>def <span class="synSpecial">'())</span>
</span><span class="code-line">               <span class="synSpecial">(</span>body <span class="synSpecial">'()))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> proc-body<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> def<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> body<span class="synSpecial">)))</span>
</span><span class="code-line">            <span class="synSpecial">((</span>definition? <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">))</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                                                 <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> def<span class="synSpecial">)</span>
</span><span class="code-line">                                                 body<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                        def
</span><span class="code-line">                        <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> body<span class="synSpecial">))))))</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let*</span> <span class="synSpecial">((</span>def-body-list <span class="synSpecial">(</span>split-def-body body<span class="synSpecial">))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>def-list <span class="synSpecial">(</span><span class="synIdentifier">car</span> def-body-list<span class="synSpecial">))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>body-list <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> def-body-list<span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> def-list<span class="synSpecial">)</span>
</span><span class="code-line">        body
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">append</span>  <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>x<span class="synSpecial">)</span> <span class="synSpecial">(</span>make-definition <span class="synSpecial">(</span>definition-variable x<span class="synSpecial">)</span> <span class="synSpecial">''</span><span class="synConstant">*unassigned*</span><span class="synSpecial">))</span>
</span><span class="code-line">                    def-list<span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>x<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>set! <span class="synSpecial">(</span>definition-variable x<span class="synSpecial">)</span>
</span><span class="code-line">                                        <span class="synSpecial">(</span>definition-value x<span class="synSpecial">)))</span>
</span><span class="code-line">                      def-list<span class="synSpecial">)</span>
</span><span class="code-line">                 body-list<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; if</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>if? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>if<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>if-predicate <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>if-consequent <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>if-alternative <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">not</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cadddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">'</span>false<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-if predicate consequent alternative<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>if predicate consequent alternative<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; begin</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>begin? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>begin<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>begin-actions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>last-exp? seq<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> seq<span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>first-exp seq<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> seq<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>rest-exps seq<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> seq<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>sequence->exp seq<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> seq<span class="synSpecial">)</span> seq<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">((</span>last-exp? seq<span class="synSpecial">)</span> <span class="synSpecial">(</span>first-exp seq<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>make-begin seq<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-begin seq<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>begin seq<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 任意の合成式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>application? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">pair?</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>operator <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>operands <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>no-operands? ops<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> ops<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>first-operand ops<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> ops<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>rest-operands ops<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> ops<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 派生式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>cond<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond-else-clause? clause<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> <span class="synSpecial">(</span>cond-predicate clause<span class="synSpecial">)</span> <span class="synSpecial">'</span>else<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond-predicate clause<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> clause<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond-actions clause<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clause<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond->if <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>expand-clauses <span class="synSpecial">(</span>cond-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>expand-clauses clauses<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> clauses<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">'</span>false
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>first <span class="synSpecial">(</span><span class="synIdentifier">car</span> clauses<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span>rest <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">)))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>cond-else-clause? first<span class="synSpecial">)</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> rest<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>sequence->exp <span class="synSpecial">(</span>cond-actions first<span class="synSpecial">))</span>
</span><span class="code-line">                <span class="synSpecial">(</span>error <span class="synConstant">"ELSE clause isn't last -- COND->IF"</span> clauses<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>action <span class="synSpecial">(</span>cond-actions first<span class="synSpecial">))</span>
</span><span class="code-line">                  <span class="synSpecial">(</span>predicate <span class="synSpecial">(</span>cond-predicate first<span class="synSpecial">)))</span>
</span><span class="code-line">              <span class="synSpecial">(</span>make-if predicate
</span><span class="code-line">                       <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> action<span class="synSpecial">)</span> <span class="synSpecial">'</span>=><span class="synSpecial">)</span>
</span><span class="code-line">                           <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> action<span class="synSpecial">)</span> predicate<span class="synSpecial">)</span>
</span><span class="code-line">                           <span class="synSpecial">(</span>sequence->exp action<span class="synSpecial">))</span>
</span><span class="code-line">                       <span class="synSpecial">(</span>expand-clauses rest<span class="synSpecial">)))))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; and</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>and? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>and<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>and-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-and <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>clauses <span class="synSpecial">(</span>and-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> clauses<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">'</span>true
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>first <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> clauses<span class="synSpecial">)</span> env<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">))</span> first<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>first <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">)))</span>
</span><span class="code-line">                <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">'</span>false<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; or</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>or? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>or<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>or-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-or <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>clauses <span class="synSpecial">(</span>or-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> clauses<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">'</span>false
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>first <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> clauses<span class="synSpecial">)</span> env<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">))</span> first<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>first <span class="synSpecial">'</span>true<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">))))))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; let</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>let<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> <span class="synSpecial">(</span>let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">cadr</span> <span class="synSpecial">(</span>let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let->combination <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span> <span class="synComment">;; 2番目の要素がシンボルならnamed-let</span>
</span><span class="code-line">      <span class="synSpecial">(</span>named-let->define <span class="synSpecial">(</span>named-let-func-name <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>named-let-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>named-let-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>named-let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span>make-lambda <span class="synSpecial">(</span>let-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                     <span class="synSpecial">(</span>let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span>let-expressions <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; let*</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>let*<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> <span class="synSpecial">(</span>let*-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">cadr</span> <span class="synSpecial">(</span>let*-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-let parameters bodys<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>let <span class="synSpecial">(</span><span class="synIdentifier">cons</span> parameters bodys<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*->nested-lets <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>expand-lets <span class="synSpecial">(</span>let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>expand-lets parameters bodys<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> parameters<span class="synSpecial">)</span> <span class="synSpecial">(</span>error <span class="synConstant">"EXPAND-LETS required pair, but "</span> parameters<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> parameters<span class="synSpecial">))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>make-let <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> parameters<span class="synSpecial">))</span>
</span><span class="code-line">                   bodys<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>make-let <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> parameters<span class="synSpecial">))</span>
</span><span class="code-line">                        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span>expand-lets <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> parameters<span class="synSpecial">)</span> bodys<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; named-let</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-func-name <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> <span class="synSpecial">(</span>named-let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">cadr</span> <span class="synSpecial">(</span>named-let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-definition variable value<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>define variable value<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let->define func-name variables expressions bodys<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>make-begin <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span>make-definition func-name <span class="synSpecial">(</span>make-lambda variables bodys<span class="synSpecial">))</span>
</span><span class="code-line">                    <span class="synSpecial">(</span><span class="synIdentifier">cons</span> func-name expressions<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 4.20</span>
</span><span class="code-line"><span class="synComment">;; 選択子</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>letrec<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> <span class="synSpecial">(</span>letrec-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">cadr</span> <span class="synSpecial">(</span>letrec-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec->let <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>make-let <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>x<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> x <span class="synSpecial">''</span><span class="synConstant">*unassigned*</span><span class="synSpecial">))</span>
</span><span class="code-line">                 <span class="synSpecial">(</span>letrec-variables <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synIdentifier">append</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>x y<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>set! x y<span class="synSpecial">))</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>letrec-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>letrec-expressions <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">                    <span class="synSpecial">(</span>letrec-body <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 術後のテスト</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>true? x<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">not</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> x <span class="synSpecial">'</span><span class="synConstant">#f</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>false? x<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> x <span class="synSpecial">'</span><span class="synConstant">#f</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 手続きの表現</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-procedure parameters body env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>procedure parameters <span class="synSpecial">(</span>scan-out-defines body<span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>compound-procedure? p<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">or</span> <span class="synSpecial">(</span>tagged-list? p <span class="synSpecial">'</span>procedure<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span>tagged-list? p <span class="synSpecial">'</span>list-proc<span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>procedure-parameters p<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> p<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>procedure-body p<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> p<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>procedure-environment p<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadddr</span> p<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 環境に対する操作</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>enclosing-environment env<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> env<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>first-frame env<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> env<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> the-empty-environment <span class="synSpecial">'())</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; フレーム</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-frame variables <span class="synIdentifier">values</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">cons</span> variables <span class="synIdentifier">values</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> frame<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> frame<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>add-binding-to-frame! var val frame<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> frame <span class="synSpecial">(</span><span class="synIdentifier">cons</span> var <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)))</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">set-cdr!</span> frame <span class="synSpecial">(</span><span class="synIdentifier">cons</span> val <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 変数を値に対応づける新しいフレーム</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>extend-environment vars vals base-env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">=</span> <span class="synSpecial">(</span><span class="synIdentifier">length</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">length</span> vals<span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span>make-frame vars vals<span class="synSpecial">)</span> base-env<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">&#x3C;</span> <span class="synSpecial">(</span><span class="synIdentifier">length</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">length</span> vals<span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">(</span>error <span class="synConstant">"Too many arguments supplied"</span> vars vals<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">(</span>error <span class="synConstant">"Too few arguments supplied"</span> vars vals<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lookup-variable-value var env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>env-loop env<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>scan vars vals<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> vars<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>env-loop <span class="synSpecial">(</span>enclosing-environment env<span class="synSpecial">)))</span>
</span><span class="code-line">            <span class="synSpecial">((</span><span class="synIdentifier">eq?</span> var <span class="synSpecial">(</span><span class="synIdentifier">car</span> vars<span class="synSpecial">))</span>
</span><span class="code-line">             <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> vals<span class="synSpecial">)</span> <span class="synSpecial">'</span><span class="synConstant">*unassigned*</span><span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">(</span>error <span class="synConstant">"*Unassigned* variable"</span> var<span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">(</span><span class="synIdentifier">car</span> vals<span class="synSpecial">)))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>scan <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vals<span class="synSpecial">)))))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> env the-empty-environment<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span>error <span class="synConstant">"Unbound variable"</span> var<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>frame <span class="synSpecial">(</span>first-frame env<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">(</span>scan <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">)))))</span>
</span><span class="code-line">  <span class="synSpecial">(</span>env-loop env<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>set-variable-value! var val env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>env-loop env<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>scan vars vals<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> vars<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>env-loop <span class="synSpecial">(</span>enclosing-environment env<span class="synSpecial">)))</span>
</span><span class="code-line">            <span class="synSpecial">((</span><span class="synIdentifier">eq?</span> var <span class="synSpecial">(</span><span class="synIdentifier">car</span> vars<span class="synSpecial">))</span>
</span><span class="code-line">             <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> vals val<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>scan <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vals<span class="synSpecial">)))))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> env the-empty-environment<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span>error <span class="synConstant">"Unbound variable -- SET!"</span> var<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>frame <span class="synSpecial">(</span>first-frame env<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">(</span>scan <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">)))))</span>
</span><span class="code-line">  <span class="synSpecial">(</span>env-loop env<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>define-variable! var val env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>frame <span class="synSpecial">(</span>first-frame env<span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>scan vars vals<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> vars<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>add-binding-to-frame! var val frame<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">((</span><span class="synIdentifier">eq?</span> var <span class="synSpecial">(</span><span class="synIdentifier">car</span> vars<span class="synSpecial">))</span>
</span><span class="code-line">             <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> vals val<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>scan <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vals<span class="synSpecial">)))))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>scan <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>primitive-procedure? proc<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? proc <span class="synSpecial">'</span>primitive<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>primitive-implementation proc<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> proc<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> primitive-procedures
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>null? <span class="synIdentifier">null?</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>= <span class="synIdentifier">=</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>- <span class="synIdentifier">-</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>+ <span class="synIdentifier">+</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>* <span class="synIdentifier">*</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>/ <span class="synIdentifier">/</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>newline <span class="synIdentifier">newline</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>display <span class="synIdentifier">display</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'()</span> <span class="synSpecial">'())))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>primitive-procedure-names<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> primitive-procedures<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>primitive-procedure-objects<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>proc<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>primitive <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> proc<span class="synSpecial">)))</span>
</span><span class="code-line">       primitive-procedures<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>apply-primitive-procedure proc args<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>apply-in-underlying-scheme
</span><span class="code-line">   <span class="synSpecial">(</span>primitive-implementation proc<span class="synSpecial">)</span> args<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> apply-in-underlying-scheme <span class="synIdentifier">apply</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 環境</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>setup-environment<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>initial-env
</span><span class="code-line">         <span class="synSpecial">(</span>extend-environment <span class="synSpecial">(</span>primitive-procedure-names<span class="synSpecial">)</span>
</span><span class="code-line">                             <span class="synSpecial">(</span>primitive-procedure-objects<span class="synSpecial">)</span>
</span><span class="code-line">                             the-empty-environment<span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>define-variable! <span class="synSpecial">'</span>true <span class="synConstant">#t</span> initial-env<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>define-variable! <span class="synSpecial">'</span>false <span class="synConstant">#f</span> initial-env<span class="synSpecial">)</span>
</span><span class="code-line">    initial-env<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> the-global-environment <span class="synSpecial">(</span>setup-environment<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> input-prompt <span class="synConstant">";;; M-Eval input:"</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> output-prompt <span class="synConstant">";;; M-Eval value:"</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>driver-loop<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>prompt-for-input input-prompt<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>input <span class="synSpecial">(</span><span class="synIdentifier">read</span><span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>output <span class="synSpecial">(</span>actual-value input the-global-environment<span class="synSpecial">)))</span>
</span><span class="code-line">      <span class="synSpecial">(</span>announce-output output-prompt<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span>user-print output<span class="synSpecial">)))</span>
</span><span class="code-line">  <span class="synSpecial">(</span>driver-loop<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>prompt-for-input <span class="synIdentifier">string</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synIdentifier">string</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>announce-output <span class="synIdentifier">string</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synIdentifier">string</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>user-print object<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>tagged-list? object <span class="synSpecial">'</span>list-proc<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>list-display <span class="synSpecial">(</span>match-to object<span class="synSpecial">)))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>compound-procedure? object<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>compound-procedure
</span><span class="code-line">                        <span class="synSpecial">(</span>procedure-parameters object<span class="synSpecial">)</span>
</span><span class="code-line">                        <span class="synSpecial">(</span>procedure-body object<span class="synSpecial">)</span>
</span><span class="code-line">                        <span class="synSpecial">'</span><span class="synConstant">&#x3C;procedure-env></span><span class="synSpecial">)))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span><span class="synIdentifier">display</span> object<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>match-to obj<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>match obj
</span><span class="code-line">    <span class="synSpecial">((</span>procedure <span class="synSpecial">(</span>m<span class="synSpecial">)</span> body <span class="synSpecial">((</span>parameters exp1 exp2<span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synIdentifier">cons</span> exp1 exp2<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>first-list-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synSpecial">(</span>force-it <span class="synSpecial">(</span><span class="synIdentifier">car</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-display <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>list-display-iter <span class="synIdentifier">exp</span> <span class="synConstant">10</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-display-iter <span class="synIdentifier">exp</span> n<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">=</span> n <span class="synConstant">0</span><span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">"...)"</span><span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>when <span class="synSpecial">(</span><span class="synIdentifier">=</span> n <span class="synConstant">10</span><span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">"("</span><span class="synSpecial">))</span>
</span><span class="code-line">              <span class="synSpecial">(</span>continue-display <span class="synIdentifier">exp</span> n<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>continue-display <span class="synIdentifier">exp</span> n<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>first-list-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>second <span class="synSpecial">(</span>force-it <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> second<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">")"</span><span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">((</span><span class="synStatement">or</span> <span class="synSpecial">(</span>self-evaluating? second<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> second<span class="synSpecial">))</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">" . "</span><span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">display</span> second<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">")"</span><span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synConstant">" "</span><span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>list-display-iter <span class="synSpecial">(</span>match-to second<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">-</span> n <span class="synConstant">1</span><span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>actual-value
</span><span class="code-line"> <span class="synSpecial">'(</span>begin <span class="synSpecial">(</span>define <span class="synSpecial">(</span>cons x y<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>list-lambda <span class="synSpecial">(</span>m<span class="synSpecial">)</span> <span class="synSpecial">(</span>m x y<span class="synSpecial">)))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>car z<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>z <span class="synSpecial">(</span>lambda <span class="synSpecial">(</span>p q<span class="synSpecial">)</span> p<span class="synSpecial">)))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>cdr z<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>z <span class="synSpecial">(</span>lambda <span class="synSpecial">(</span>p q<span class="synSpecial">)</span> q<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>list-ref items n<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>if <span class="synSpecial">(</span>= n <span class="synConstant">0</span><span class="synSpecial">)</span>
</span><span class="code-line">               <span class="synSpecial">(</span>car items<span class="synSpecial">)</span>
</span><span class="code-line">               <span class="synSpecial">(</span>list-ref <span class="synSpecial">(</span>cdr items<span class="synSpecial">)</span> <span class="synSpecial">(</span>- n <span class="synConstant">1</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>map proc items<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>if <span class="synSpecial">(</span>null? items<span class="synSpecial">)</span>
</span><span class="code-line">               <span class="synSpecial">'()</span>
</span><span class="code-line">               <span class="synSpecial">(</span>cons <span class="synSpecial">(</span>proc <span class="synSpecial">(</span>car items<span class="synSpecial">))</span>
</span><span class="code-line">                     <span class="synSpecial">(</span>map proc <span class="synSpecial">(</span>cdr items<span class="synSpecial">)))))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>scale-list items factor<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>map <span class="synSpecial">(</span>lambda <span class="synSpecial">(</span>x<span class="synSpecial">)</span> <span class="synSpecial">(</span>* x factor<span class="synSpecial">))</span>
</span><span class="code-line">                items<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>add-lists list1 list2<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>cond <span class="synSpecial">((</span>null? list1<span class="synSpecial">)</span> list2<span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">((</span>null? list2<span class="synSpecial">)</span> list1<span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">(</span>else <span class="synSpecial">(</span>cons <span class="synSpecial">(</span>+ <span class="synSpecial">(</span>car list1<span class="synSpecial">)</span> <span class="synSpecial">(</span>car list2<span class="synSpecial">))</span>
</span><span class="code-line">                             <span class="synSpecial">(</span>add-lists <span class="synSpecial">(</span>cdr list1<span class="synSpecial">)</span> <span class="synSpecial">(</span>cdr list2<span class="synSpecial">))))))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>define ones <span class="synSpecial">(</span>cons <span class="synConstant">1</span> ones<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define integers <span class="synSpecial">(</span>cons <span class="synConstant">0</span> <span class="synSpecial">(</span>add-lists ones integers<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>integral integrand initial-value dt<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>define int
</span><span class="code-line">             <span class="synSpecial">(</span>cons initial-value
</span><span class="code-line">                   <span class="synSpecial">(</span>add-lists <span class="synSpecial">(</span>scale-list integrand dt<span class="synSpecial">)</span>
</span><span class="code-line">                              int<span class="synSpecial">)))</span>
</span><span class="code-line">           int<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">(</span>define <span class="synSpecial">(</span>solve f y0 dt<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span>define y <span class="synSpecial">(</span>integral dy y0 dt<span class="synSpecial">))</span>
</span><span class="code-line">           <span class="synSpecial">(</span>define dy <span class="synSpecial">(</span>map f y<span class="synSpecial">))</span>
</span><span class="code-line">           y<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">         <span class="synSpecial">)</span>
</span><span class="code-line"> the-global-environment<span class="synSpecial">)</span>
</span></code></pre></div></div></article></div></div><div class="flex md:justify-center w-full"><div class="flex flex-col md:max-w-4xl w-full"><hr/><div class="flex justify-center pt-4 pb-8">© 2022 wat-aro</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"data":{"title":"SICP 問題 4.34","published":"2016/01/10","tags":["scheme","SICP"]},"content":"\n\u003cp\u003e遅延対とリストを正当に印字できるようにする．\u003cbr/\u003e\nconsへのタグづけがどうしてもうまくいかなくてここを参考にしました．\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://wqzhang.wordpress.com/2010/04/21/sicp-exercise-4-34/\"\u003eSICP Exercise 4.34 | Weiqun Zhang\u0026#39;s Blog\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e前回からの変更箇所のみ\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-quote \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elist-lambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;list-lambda?とmake-list-procedureの追加\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-list-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u0026gt;combination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u0026gt;nested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u0026gt;let \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u0026gt;if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown expression type --EVAL\u0026quot;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 追加\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-lambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-lambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-list-procedure parameters body env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc parameters \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; list-procに対応\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-procedure? p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; cons,car,cdrを削除\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e primitive-procedures\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enull? \u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e= \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e- \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e/ \u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enewline \u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edisplay \u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; list-procの時はlist-display\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etagged-list? object \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to object\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompound-procedure? object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompound-procedure\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026lt;procedure-env\u0026gt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e object\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 以下はlist-displayのための手続き\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch obj\n    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprocedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eparameters exp1 exp2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e exp1 exp2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-list-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;...)\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ewhen \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;(\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtinue-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtinue-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-list-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esecond \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;)\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eself-evaluating? second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot; . \u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;)\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot; \u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 遅延リスト用の手続き\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value\n \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ebegin \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs x y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em x y\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ez \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep q\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ez \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep q\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e q\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-ref items n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e= n \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-ref \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e- n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap proc items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enull? items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar items\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr items\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escale-list items factor\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* x factor\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                items\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists list1 list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enull? list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enull? list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eelse \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar list2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr list2\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine ones \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e ones\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine integers \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists ones integers\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintegral integrand initial-value dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine int\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs initial-value\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escale-list integrand dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              int\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           int\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esolve f y0 dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine y \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintegral dy y0 dt\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine dy \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap f y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\n         \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n the-global-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003etest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\nones\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eb \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ec \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ed\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e d\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eb \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ec \u003cspan class=\"synSpecial\"\u003e'())))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\nintegers\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(())\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e以下がこの遅延評価器の全文\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euse util.match\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e true \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e false \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-quote \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elist-lambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;list-lambda?とmake-list-procedureの追加\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-list-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u0026gt;combination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u0026gt;nested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u0026gt;let \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u0026gt;if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown expression type --EVAL\u0026quot;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; メモ化する評価器\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ethunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eresult \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-exp obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-env obj\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e obj \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eevaluated-thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;expをその値で置き換える\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;;必要のなくなったenvを忘れる\u003c/span\u003e\n           result\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eevaluated-thunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-value obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edelay-it \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ethunk \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ethunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-exp thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-env thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eevaluated-thunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? obj \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eevaluated-thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-value evaluated-thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e evaluated-thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efoo bar\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebar \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; apply\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply procedure arguments env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprimitive-procedure? procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-primitive-procedure\n          procedure\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values arguments env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e; changed\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompound-procedure? procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args arguments env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e; changed\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-environment procedure\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown procedure type: APPLY\u0026quot;\u003c/span\u003e procedure\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edelay-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 並び\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elast-exp? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-exps exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 代入\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-variable-value! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 定義\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable!\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 自己評価式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003estring?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 変数\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; クオート\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003equote\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-quote obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003equote obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-quote \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eobj \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-\u0026gt;cons obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-\u0026gt;cons obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-quote obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-quote obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-quote \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-\u0026gt;cons \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e tag\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e tag\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      false\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 代入\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset!\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 定義\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edefine\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;仮パラメタ\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;本体\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; lambda式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda parameters body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-body-list proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                               body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                      def\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-lambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-lambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-list-procedure parameters body env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc parameters \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 4.17\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-def-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                 body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        def\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet*\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edef-body-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-def-body body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e def-body-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e def-body-list\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        body\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                      def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 body-list\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; if\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eif\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-if predicate consequent alternative\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eif predicate consequent alternative\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; begin\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebegin\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elast-exp? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-exps seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u0026gt;exp seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elast-exp? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin seq\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebegin seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; 任意の合成式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 派生式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003econd\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-else-clause? clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eelse\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clause\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clause\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u0026gt;if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-else-clause? first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u0026gt;exp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions first\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;ELSE clause isn't last -- COND-\u0026gt;IF\u0026quot;\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eaction \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions first\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epredicate \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate first\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-if predicate\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e action\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e action\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e predicate\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u0026gt;exp action\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses rest\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; and\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eand\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eclauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; or\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eor\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eclauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; let\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u0026gt;combination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; 2番目の要素がシンボルならnamed-let\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-\u0026gt;define \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-func-name \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; let*\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet*\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let parameters bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters bodys\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u0026gt;nested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets parameters bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;EXPAND-LETS required pair, but \u0026quot;\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                   bodys\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e bodys\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; named-let\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-func-name \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition variable value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edefine variable value\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-\u0026gt;define func-name variables expressions bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition func-name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda variables bodys\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e func-name expressions\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 4.20\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; 選択子\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eletrec\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u0026gt;let \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! x y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 術後のテスト\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efalse? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 手続きの表現\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure parameters body env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure parameters \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-procedure? p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-environment p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 環境に対する操作\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e the-empty-environment \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; フレーム\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-frame variables \u003cspan class=\"synIdentifier\"\u003evalues\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e variables \u003cspan class=\"synIdentifier\"\u003evalues\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-binding-to-frame! var val frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 変数を値に対応づける新しいフレーム\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment vars vals base-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-frame vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e base-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Too many arguments supplied\u0026quot;\u003c/span\u003e vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Too few arguments supplied\u0026quot;\u003c/span\u003e vars vals\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value var env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;*Unassigned* variable\u0026quot;\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e env the-empty-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unbound variable\u0026quot;\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-variable-value! var val env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e vals val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e env the-empty-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unbound variable -- SET!\u0026quot;\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! var val env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-binding-to-frame! var val frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e vals val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure? proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? proc \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-implementation proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e primitive-procedures\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enull? \u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e= \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e- \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e/ \u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enewline \u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edisplay \u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-names\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e primitive-procedures\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-objects\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e proc\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n       primitive-procedures\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-primitive-procedure proc args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-in-underlying-scheme\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-implementation proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e apply-in-underlying-scheme \u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 環境\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einitial-env\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-names\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-objects\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             the-empty-environment\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e initial-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e initial-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    initial-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e the-global-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e input-prompt \u003cspan class=\"synConstant\"\u003e\u0026quot;;;; M-Eval input:\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e output-prompt \u003cspan class=\"synConstant\"\u003e\u0026quot;;;; M-Eval value:\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprompt-for-input input-prompt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einput \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eread\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eoutput \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value input the-global-environment\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eannounce-output output-prompt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print output\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprompt-for-input \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eannounce-output \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etagged-list? object \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to object\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompound-procedure? object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompound-procedure\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026lt;procedure-env\u0026gt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e object\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch obj\n    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprocedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eparameters exp1 exp2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e exp1 exp2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-list-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;...)\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ewhen \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;(\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtinue-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtinue-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-list-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esecond \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;)\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eself-evaluating? second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot; . \u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;)\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot; \u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value\n \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ebegin \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs x y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em x y\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ez \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep q\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ez \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep q\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e q\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-ref items n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e= n \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-ref \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e- n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap proc items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enull? items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar items\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr items\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escale-list items factor\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* x factor\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                items\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists list1 list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enull? list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enull? list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eelse \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar list2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr list2\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine ones \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e ones\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine integers \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists ones integers\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintegral integrand initial-value dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine int\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs initial-value\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escale-list integrand dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              int\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n           int\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esolve f y0 dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine y \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintegral dy y0 dt\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine dy \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap f y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n           y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\n         \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n the-global-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"SICP 問題 4.34"},"content":"\u003cp\u003e遅延対とリストを正当に印字できるようにする．\u003cbr\u003e\nconsへのタグづけがどうしてもうまくいかなくてここを参考にしました．\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://wqzhang.wordpress.com/2010/04/21/sicp-exercise-4-34/\"\u003eSICP Exercise 4.34 | Weiqun Zhang's Blog\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e前回からの変更箇所のみ\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-quote \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elist-lambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;list-lambda?とmake-list-procedureの追加\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-list-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u003ecombination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u003enested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u003elet \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u003eif \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unknown expression type --EVAL\"\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 追加\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-lambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-lambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-list-procedure parameters body env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc parameters \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; list-procに対応\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-procedure? p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; cons,car,cdrを削除\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e primitive-procedures\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enull? \u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e= \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e- \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e/ \u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enewline \u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edisplay \u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; list-procの時はlist-display\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etagged-list? object \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to object\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompound-procedure? object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompound-procedure\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026#x3C;procedure-env\u003e\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e object\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 以下はlist-displayのための手続き\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch obj\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprocedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eparameters exp1 exp2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e exp1 exp2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-list-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"...)\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ewhen \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"(\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtinue-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtinue-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-list-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esecond \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\")\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eself-evaluating? second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\" . \"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\")\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\" \"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 遅延リスト用の手続き\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ebegin \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs x y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em x y\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ez \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep q\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ez \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep q\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e q\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-ref items n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e= n \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-ref \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e- n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap proc items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enull? items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar items\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr items\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escale-list items factor\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* x factor\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                items\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists list1 list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enull? list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enull? list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eelse \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar list2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr list2\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine ones \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e ones\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine integers \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists ones integers\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintegral integrand initial-value dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine int\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs initial-value\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escale-list integrand dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              int\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           int\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esolve f y0 dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine y \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintegral dy y0 dt\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine dy \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap f y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e the-global-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003etest\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003eones\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eb \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ec \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ed\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c \u003cspan class=\"synSpecial\"\u003e.\u003c/span\u003e d\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eb \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ec \u003cspan class=\"synSpecial\"\u003e'())))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003eintegers\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e8\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e9\u003c/span\u003e ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(())\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e以下がこの遅延評価器の全文\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euse util.match\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e true \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e false \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-quote \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elist-lambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;list-lambda?とmake-list-procedureの追加\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-list-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u003ecombination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u003enested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u003elet \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u003eif \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unknown expression type --EVAL\"\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; メモ化する評価器\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ethunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eresult \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-exp obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-env obj\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e obj \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eevaluated-thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;expをその値で置き換える\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;;必要のなくなったenvを忘れる\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           result\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eevaluated-thunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-value obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edelay-it \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ethunk \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ethunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-exp thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-env thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eevaluated-thunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? obj \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eevaluated-thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-value evaluated-thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e evaluated-thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efoo bar\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebar \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; apply\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply procedure arguments env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprimitive-procedure? procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-primitive-procedure\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          procedure\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values arguments env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e; changed\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompound-procedure? procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args arguments env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e; changed\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-environment procedure\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unknown procedure type: APPLY\"\u003c/span\u003e procedure\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edelay-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 並び\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elast-exp? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-exps exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 代入\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-variable-value! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                       env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 定義\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable!\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 自己評価式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003estring?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 変数\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; クオート\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003equote\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-quote obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003equote obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-quote \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eobj \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-\u003econs obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-\u003econs obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-quote obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-quote obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-quote \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equote-\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e tag\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e tag\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      false\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 代入\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset!\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 定義\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edefine\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;仮パラメタ\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;本体\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; lambda式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda parameters body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-body-list proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                               body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                      def\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-lambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-lambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-list-procedure parameters body env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc parameters \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 4.17\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-def-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                                 body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        def\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet*\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edef-body-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-def-body body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e def-body-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e def-body-list\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        body\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                    def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                      def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 body-list\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; if\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eif\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-if predicate consequent alternative\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eif predicate consequent alternative\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; begin\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebegin\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elast-exp? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-exps seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u003eexp seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elast-exp? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin seq\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebegin seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 任意の合成式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 派生式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003econd\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-else-clause? clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eelse\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clause\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clause\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u003eif \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-else-clause? first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u003eexp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions first\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"ELSE clause isn't last -- COND-\u003eIF\"\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eaction \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions first\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epredicate \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate first\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-if predicate\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e action\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e action\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e predicate\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u003eexp action\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses rest\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; and\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eand\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eclauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; or\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eor\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eclauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; let\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u003ecombination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; 2番目の要素がシンボルならnamed-let\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-func-name \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; let*\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet*\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let parameters bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters bodys\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u003enested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets parameters bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"EXPAND-LETS required pair, but \"\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   bodys\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e bodys\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; named-let\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-func-name \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition variable value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edefine variable value\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-\u003edefine func-name variables expressions bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition func-name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda variables bodys\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e func-name expressions\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 4.20\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 選択子\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eletrec\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u003elet \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! x y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 術後のテスト\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efalse? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 手続きの表現\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure parameters body env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure parameters \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-procedure? p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-environment p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 環境に対する操作\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e the-empty-environment \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; フレーム\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-frame variables \u003cspan class=\"synIdentifier\"\u003evalues\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e variables \u003cspan class=\"synIdentifier\"\u003evalues\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-binding-to-frame! var val frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 変数を値に対応づける新しいフレーム\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment vars vals base-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-frame vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e base-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Too many arguments supplied\"\u003c/span\u003e vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Too few arguments supplied\"\u003c/span\u003e vars vals\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value var env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"*Unassigned* variable\"\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e env the-empty-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unbound variable\"\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-variable-value! var val env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e vals val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e env the-empty-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unbound variable -- SET!\"\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! var val env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-binding-to-frame! var val frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e vals val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure? proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? proc \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-implementation proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e primitive-procedures\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enull? \u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e= \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e- \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e/ \u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enewline \u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edisplay \u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-names\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e primitive-procedures\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-objects\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e proc\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       primitive-procedures\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-primitive-procedure proc args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-in-underlying-scheme\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-implementation proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e apply-in-underlying-scheme \u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 環境\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einitial-env\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-names\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-objects\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             the-empty-environment\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e initial-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e initial-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    initial-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e the-global-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e input-prompt \u003cspan class=\"synConstant\"\u003e\";;; M-Eval input:\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e output-prompt \u003cspan class=\"synConstant\"\u003e\";;; M-Eval value:\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprompt-for-input input-prompt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einput \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eread\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eoutput \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value input the-global-environment\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eannounce-output output-prompt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print output\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprompt-for-input \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eannounce-output \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003etagged-list? object \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elist-proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to object\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompound-procedure? object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompound-procedure\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026#x3C;procedure-env\u003e\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e object\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch obj\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprocedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eparameters exp1 exp2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e exp1 exp2\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-list-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"...)\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ewhen \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"(\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtinue-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtinue-display \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-list-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003esecond \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\")\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eor\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eself-evaluating? second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\" . \"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\")\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\" \"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-display-iter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ematch-to second\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e \u003cspan class=\"synSpecial\"\u003e'(\u003c/span\u003ebegin \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs x y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003em x y\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ez \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep q\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr z\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ez \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ep q\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e q\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-ref items n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e= n \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-ref \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e- n \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap proc items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enull? items\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar items\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap proc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr items\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escale-list items factor\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e* x factor\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                items\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists list1 list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enull? list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003enull? list2\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eelse \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e+ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecar list2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr list1\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecdr list2\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine ones \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e ones\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine integers \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists ones integers\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintegral integrand initial-value dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine int\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econs initial-value\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-lists \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escale-list integrand dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              int\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           int\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esolve f y0 dt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine y \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eintegral dy y0 dt\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine dy \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emap f y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e the-global-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"SICP 問題 4.34"},"buildId":"jBdsbeX94AlqfuENdlazh","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>