<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>define-curryを書いてみた | (wat-aro)</title><meta name="title" content="define-curryを書いてみた | (wat-aro)"/><meta name="description" content="&lt;p&gt;カリー化や部分適用の話が&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Twitter&quot;&gt;Twitter&lt;/a&gt;で流れてきたのでマクロの練習として書いてみました．&lt;/p&gt;&lt;pre class=&quot;code lang-scheme&quot; data-lang=&quot;"/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="define-curryを書いてみた | (wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/og-images/define-curryを書いてみた.png"/><meta property="og:url" content="https://wat-aro.dev/posts/define-curry%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%BF%E3%81%9F"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="define-curryを書いてみた | (wat-aro)"/><meta name="twitter:description" content="&lt;p&gt;カリー化や部分適用の話が&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/Twitter&quot;&gt;Twitter&lt;/a&gt;で流れてきたのでマクロの練習として書いてみました．&lt;/p&gt;&lt;pre class=&quot;code lang-scheme&quot; data-lang=&quot;"/><meta name="twitter:image" content="https://wat-aro.dev/og-images/define-curryを書いてみた.png"/><meta name="next-head-count" content="17"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/cef7709dba1aabcc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cef7709dba1aabcc.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-e7be5a2ce3007f17.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-847cc7a6659a518e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-5a221d7c4dbc914e.js" defer=""></script><script src="/_next/static/Q8fC0uqSTU4naW5qMLiKY/_buildManifest.js" defer=""></script><script src="/_next/static/Q8fC0uqSTU4naW5qMLiKY/_ssgManifest.js" defer=""></script><script src="/_next/static/Q8fC0uqSTU4naW5qMLiKY/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts">Blog</a></li><li class="h-full flex flex-col justify-end border-black pb-4"><a href="/slides">Slide</a></li><li class="h-full flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li></ul></div><div class="flex md:justify-center justify-between w-full flex-grow"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><article class="flex max-w-4xl w-full"><div class="py-4 w-full"><div class="mr-2 text-xs font-bold">2016/01/06</div><h1 class="font-bold text-3xl text-black">define-curryを書いてみた</h1><nav class="flex mt-2 mb-2 items-start text-gray-500 text-xs"><div class="flex flex-wrap max-w-full overflow-x-auto gap-2"><a href="/tags/scheme"><p class="mr-1 rounded-full px-2 py-1 border leading-none">scheme</p></a></div></nav><div class="znc"><p>カリー化や部分適用の話が<a class="keyword" href="http://d.hatena.ne.jp/keyword/Twitter">Twitter</a>で流れてきたのでマクロの練習として書いてみました．</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synComment">;; lambda式を引数に取り，カリー化されたlambda式を返す</span>
</span><span class="code-line"><span class="synComment">;; いらなかった</span>
</span><span class="code-line"><span class="synComment">;; (define-syntax curry</span>
</span><span class="code-line"><span class="synComment">;;   (syntax-rules (lambda) ;; 修正</span>
</span><span class="code-line"><span class="synComment">;;     [(_ (lambda (arg) body ...))</span>
</span><span class="code-line"><span class="synComment">;;      (lambda (arg) body ...)]</span>
</span><span class="code-line"><span class="synComment">;;     [(_ (lambda (first rest ...) body ...))</span>
</span><span class="code-line"><span class="synComment">;;      (lambda (first) (curry (lambda (rest ...) body ...)))]))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define-syntax</span> lambda-curry
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">syntax-rules</span> <span class="synSpecial">()</span>
</span><span class="code-line">    <span class="synSpecial">[(</span>_ <span class="synSpecial">()</span> body ...<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">()</span> body ...<span class="synSpecial">)]</span> <span class="synComment">;; 修正：引数が０個の手続きに対応</span>
</span><span class="code-line">    <span class="synSpecial">[(</span>_ <span class="synSpecial">(</span>arg<span class="synSpecial">)</span> body ...<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>arg<span class="synSpecial">)</span> body ...<span class="synSpecial">)]</span>
</span><span class="code-line">    <span class="synSpecial">[(</span>_ <span class="synSpecial">(</span>first rest ...<span class="synSpecial">)</span> body ...<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">letrec</span> <span class="synSpecial">((</span>func <span class="synSpecial">(</span>case-lambda
</span><span class="code-line">                     <span class="synSpecial">[()</span> func<span class="synSpecial">]</span>
</span><span class="code-line">                     <span class="synSpecial">[(</span>arg<span class="synSpecial">)</span> <span class="synSpecial">((</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>first<span class="synSpecial">)</span> <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>rest ...<span class="synSpecial">)</span> body ...<span class="synSpecial">))</span> arg<span class="synSpecial">)]</span>
</span><span class="code-line">                     <span class="synSpecial">[</span>args <span class="synSpecial">((</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>first<span class="synSpecial">)</span>
</span><span class="code-line">                              <span class="synSpecial">(</span><span class="synIdentifier">apply</span> <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>rest ...<span class="synSpecial">)</span> body ...<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> args<span class="synSpecial">)))</span>
</span><span class="code-line">                            <span class="synSpecial">(</span><span class="synIdentifier">car</span> args<span class="synSpecial">))])))</span>
</span><span class="code-line">       func<span class="synSpecial">)]))</span> <span class="synComment">;;このfuncがなくてもなぜか動く．</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define-syntax</span> define-curry
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">syntax-rules</span> <span class="synSpecial">()</span>
</span><span class="code-line">    <span class="synComment">;; lambda-curryが0引数に対応したのでいらない</span>
</span><span class="code-line">    <span class="synComment">;; [(_ (func-name) body ...)</span>
</span><span class="code-line">    <span class="synComment">;;  (define (func-name) body ...)]</span>
</span><span class="code-line">    <span class="synSpecial">[(</span>_ <span class="synSpecial">(</span>func-name args ...<span class="synSpecial">)</span> body ...<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">define</span> func-name <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>args ...<span class="synSpecial">)</span> body ...<span class="synSpecial">))]</span>
</span><span class="code-line">    <span class="synSpecial">[(</span>_ var val<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">define</span> var val<span class="synSpecial">)]))</span>
</span></code></pre>
<p>　<br>
清書</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define-syntax</span> lambda-curry
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">syntax-rules</span> <span class="synSpecial">()</span>
</span><span class="code-line">    <span class="synSpecial">((</span>_ <span class="synSpecial">()</span> b0 b1 ...<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">()</span> b0 b1 ...<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">((</span>_ <span class="synSpecial">(</span>arg<span class="synSpecial">)</span> b0 b1 ...<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>arg<span class="synSpecial">)</span> b0 b1 ...<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">((</span>_ <span class="synSpecial">(</span>first rest ...<span class="synSpecial">)</span> b0 b1 ...<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">letrec</span> <span class="synSpecial">((</span>func <span class="synSpecial">(</span>case-lambda
</span><span class="code-line">                     <span class="synSpecial">(()</span> func<span class="synSpecial">)</span>
</span><span class="code-line">                     <span class="synSpecial">((</span>arg<span class="synSpecial">)</span> <span class="synSpecial">((</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>first<span class="synSpecial">)</span> <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>rest ...<span class="synSpecial">)</span> b0 b1 ...<span class="synSpecial">))</span> arg<span class="synSpecial">))</span>
</span><span class="code-line">                     <span class="synSpecial">(</span>args <span class="synSpecial">((</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>first<span class="synSpecial">)</span>
</span><span class="code-line">                              <span class="synSpecial">(</span><span class="synIdentifier">apply</span> <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>rest ...<span class="synSpecial">)</span> b0 b1 ...<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> args<span class="synSpecial">)))</span>
</span><span class="code-line">                            <span class="synSpecial">(</span><span class="synIdentifier">car</span> args<span class="synSpecial">))))))</span>
</span><span class="code-line">       func<span class="synSpecial">))))</span> <span class="synComment">;;このfuncがなくてもなぜか動く．</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define-syntax</span> define-curry
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">syntax-rules</span> <span class="synSpecial">()</span>
</span><span class="code-line">    <span class="synSpecial">((</span>_ <span class="synSpecial">(</span>func-name args ...<span class="synSpecial">)</span> b0 b1 ...<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">define</span> func-name <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>args ...<span class="synSpecial">)</span> b0 b1 ...<span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">((</span>_ var val<span class="synSpecial">)</span>
</span><span class="code-line">     <span class="synSpecial">(</span><span class="synStatement">define</span> var val<span class="synSpecial">))))</span>
</span></code></pre>
<p>test</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line">gosh> <span class="synSpecial">(</span><span class="synStatement">define</span> f <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>a b<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">/</span> a b<span class="synSpecial">)))</span>
</span><span class="code-line">f
</span><span class="code-line">gosh> <span class="synSpecial">(</span>f <span class="synConstant">1</span> <span class="synConstant">2</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">1/2</span>
</span><span class="code-line">gosh> <span class="synSpecial">(</span><span class="synStatement">define</span> g <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>a b c<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">+</span> a b c<span class="synSpecial">)))</span>
</span><span class="code-line">g
</span><span class="code-line">gosh> <span class="synSpecial">(</span>g <span class="synConstant">1</span> <span class="synConstant">2</span> <span class="synConstant">3</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">6</span>
</span><span class="code-line">gosh> <span class="synError">#&#x3C;undef></span>
</span><span class="code-line">gosh> <span class="synSpecial">(</span><span class="synStatement">define</span> f <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>a b<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">/</span> a b<span class="synSpecial">)))</span>
</span><span class="code-line">f
</span><span class="code-line">gosh> <span class="synSpecial">(</span>f <span class="synConstant">1</span> <span class="synConstant">2</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">1/2</span>
</span><span class="code-line">gosh> <span class="synError">#&#x3C;undef></span>
</span><span class="code-line">gosh> <span class="synSpecial">(</span>define-curry <span class="synSpecial">(</span>f a b<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">/</span> a b<span class="synSpecial">))</span>
</span><span class="code-line">f
</span><span class="code-line">gosh> <span class="synSpecial">(</span>f <span class="synConstant">1</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synError">#&#x3C;closure</span> <span class="synSpecial">(</span><span class="synConstant">#f</span> <span class="synConstant">#f</span><span class="synSpecial">)</span><span class="synIdentifier">></span>
</span><span class="code-line">gosh> <span class="synSpecial">((</span>f <span class="synConstant">1</span><span class="synSpecial">)</span> <span class="synConstant">2</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">1/2</span>
</span><span class="code-line">gosh> <span class="synSpecial">(</span>f <span class="synConstant">1</span> <span class="synConstant">2</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">1/2</span>
</span><span class="code-line">gosh> <span class="synSpecial">(</span>define-curry <span class="synSpecial">(</span>g a b c<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">+</span> a b c<span class="synSpecial">))</span>
</span><span class="code-line">g
</span><span class="code-line">gosh> <span class="synSpecial">(</span>g <span class="synConstant">1</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synError">#&#x3C;closure</span> <span class="synSpecial">(</span><span class="synConstant">#f</span> <span class="synConstant">#f</span><span class="synSpecial">)</span><span class="synIdentifier">></span>
</span><span class="code-line">gosh> <span class="synSpecial">((</span>g <span class="synConstant">1</span><span class="synSpecial">)</span> <span class="synConstant">2</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synError">#&#x3C;closure</span> <span class="synSpecial">(</span><span class="synConstant">#f</span> <span class="synConstant">#f</span> <span class="synConstant">#f</span><span class="synSpecial">)</span><span class="synIdentifier">></span>
</span><span class="code-line">gosh> <span class="synSpecial">(((</span>g <span class="synConstant">1</span><span class="synSpecial">)</span> <span class="synConstant">2</span> <span class="synSpecial">)</span> <span class="synConstant">3</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">6</span>
</span><span class="code-line">gosh> <span class="synSpecial">((</span>g <span class="synConstant">1</span><span class="synSpecial">)</span> <span class="synConstant">2</span> <span class="synConstant">3</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">6</span>
</span><span class="code-line">gosh> <span class="synSpecial">((</span>g <span class="synConstant">1</span> <span class="synConstant">2</span><span class="synSpecial">)</span> <span class="synConstant">3</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">6</span>
</span><span class="code-line">gosh> <span class="synSpecial">(</span>g <span class="synConstant">1</span> <span class="synConstant">2</span> <span class="synConstant">3</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">6</span>
</span></code></pre>
<p>修正1
</p><blockquote class="twitter-tweet" lang="HASH(0xa7a3470)"><p lang="ja" dir="ltr">curry の定義は (syntax-rules (lambda) ...) にしないと (curry (foo (x) x)) とかでも動いてしましそう
<a href="https://t.co/DUJHFogOQg">https://t.co/DUJHFogOQg</a></p>— でこれき (@dico_leque) <a href="https://twitter.com/dico_leque/status/684596402043813888">January 6, 2016</a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
　<br>
　<br>
修正2<p></p>
<p></p><blockquote class="twitter-tweet" lang="HASH(0xa7a3470)"><p lang="ja" dir="ltr">引数がゼロ個の手続きはこのマクロでは作れないな。
(lambda-curry () (* 1 2)) みたいなの。
それができたからといって使いどころもないけど。</p>— 齊藤敦志 (@SaitoAtsushi) <a href="https://twitter.com/SaitoAtsushi/status/684595362833694720">January 6, 2016</a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p></p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line">gosh> <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">()</span> <span class="synSpecial">(</span><span class="synIdentifier">+</span> <span class="synConstant">1</span> <span class="synConstant">2</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synError">#&#x3C;closure</span> <span class="synError">#f></span>
</span><span class="code-line">gosh> <span class="synSpecial">((</span>lambda-curry <span class="synSpecial">()</span> <span class="synSpecial">(</span><span class="synIdentifier">+</span> <span class="synConstant">1</span> <span class="synConstant">2</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synConstant">3</span>
</span></code></pre>
<p>　<br>
修正3
</p><blockquote class="twitter-tweet" lang="HASH(0xa7a3470)"><p lang="ja" dir="ltr">lambda-curryのletrecは要らない気がする。define-curryの最初のパターンもlambda-curryが0引数対応したなら要らない気がする。 <a href="https://t.co/h4ClDCC5ev">https://t.co/h4ClDCC5ev</a></p>— Kei (@tk_riple) <a href="https://twitter.com/tk_riple/status/684665486274093056">January 6, 2016</a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p></p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line">gosh> <span class="synSpecial">(</span><span class="synStatement">define</span> f <span class="synSpecial">(</span>lambda-curry <span class="synSpecial">(</span>a b<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">/</span> a b<span class="synSpecial">)))</span>
</span><span class="code-line">f
</span><span class="code-line">gosh> <span class="synSpecial">(</span>f <span class="synConstant">1</span> <span class="synConstant">2</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">1/2</span>
</span><span class="code-line">gosh> <span class="synSpecial">((</span>f <span class="synConstant">3</span><span class="synSpecial">)</span> <span class="synConstant">4</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">3/4</span>
</span><span class="code-line">gosh> <span class="synSpecial">(</span>define-curry <span class="synSpecial">(</span>f<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">+</span> <span class="synConstant">1</span> <span class="synConstant">1</span><span class="synSpecial">))</span>
</span><span class="code-line">f
</span><span class="code-line">gosh> <span class="synSpecial">(</span>f<span class="synSpecial">)</span>
</span><span class="code-line"><span class="synConstant">2</span>
</span></code></pre></div></div></article></div></div><div class="flex md:justify-center w-full"><div class="flex flex-col md:max-w-4xl w-full"><hr/><div class="flex justify-center pt-4 pb-8">© 2022 wat-aro</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"define-curryを書いてみた","published":"2016/01/06","tags":["scheme"],"content":"\n\u003cp\u003eカリー化や部分適用の話が\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Twitter\"\u003eTwitter\u003c/a\u003eで流れてきたのでマクロの練習として書いてみました．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; lambda式を引数に取り，カリー化されたlambda式を返す\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; いらなかった\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; (define-syntax curry\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;   (syntax-rules (lambda) ;; 修正\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;     [(_ (lambda (arg) body ...))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;      (lambda (arg) body ...)]\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;     [(_ (lambda (first rest ...) body ...))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;      (lambda (first) (curry (lambda (rest ...) body ...)))]))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine-syntax\u003c/span\u003e lambda-curry\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003esyntax-rules\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)]\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; 修正：引数が０個の手続きに対応\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)]\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst rest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eletrec\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efunc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecase-lambda\n                     \u003cspan class=\"synSpecial\"\u003e[()\u003c/span\u003e func\u003cspan class=\"synSpecial\"\u003e]\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e arg\u003cspan class=\"synSpecial\"\u003e)]\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e[\u003c/span\u003eargs \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))])))\u003c/span\u003e\n       func\u003cspan class=\"synSpecial\"\u003e)]))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;このfuncがなくてもなぜか動く．\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine-syntax\u003c/span\u003e define-curry\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003esyntax-rules\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; lambda-curryが0引数に対応したのでいらない\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; [(_ (func-name) body ...)\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;;  (define (func-name) body ...)]\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efunc-name args ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e func-name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eargs ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e))]\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ var val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e var val\u003cspan class=\"synSpecial\"\u003e)]))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\n清書\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine-syntax\u003c/span\u003e lambda-curry\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003esyntax-rules\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst rest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eletrec\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efunc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecase-lambda\n                     \u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e func\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e arg\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eargs \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n       func\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;このfuncがなくてもなぜか動く．\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine-syntax\u003c/span\u003e define-curry\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003esyntax-rules\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efunc-name args ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e func-name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eargs ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ var val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e var val\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003etest\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e f \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\nf\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e g \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b c\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\ng\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synError\"\u003e#\u0026lt;undef\u0026gt;\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e f \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\nf\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synError\"\u003e#\u0026lt;undef\u0026gt;\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\nf\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synError\"\u003e#\u0026lt;closure\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg a b c\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b c\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\ng\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synError\"\u003e#\u0026lt;closure\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synError\"\u003e#\u0026lt;closure\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026gt;\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(((\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e修正1\n\u003cblockquote class=\"twitter-tweet\" lang=\"HASH(0xa7a3470)\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003ecurry の定義は (syntax-rules (lambda) ...) にしないと (curry (foo (x) x)) とかでも動いてしましそう\u0026#10;\u003ca href=\"https://t.co/DUJHFogOQg\"\u003ehttps://t.co/DUJHFogOQg\u003c/a\u003e\u003c/p\u003e\u0026mdash; でこれき (@dico_leque) \u003ca href=\"https://twitter.com/dico_leque/status/684596402043813888\"\u003eJanuary 6, 2016\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n　\u003cbr/\u003e\n　\u003cbr/\u003e\n修正2\u003c/p\u003e\n\n\u003cp\u003e\u003cblockquote class=\"twitter-tweet\" lang=\"HASH(0xa7a3470)\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003e引数がゼロ個の手続きはこのマクロでは作れないな。\u0026#10;(lambda-curry () (* 1 2)) みたいなの。\u0026#10;それができたからといって使いどころもないけど。\u003c/p\u003e\u0026mdash; 齊藤敦志 (@SaitoAtsushi) \u003ca href=\"https://twitter.com/SaitoAtsushi/status/684595362833694720\"\u003eJanuary 6, 2016\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synError\"\u003e#\u0026lt;closure\u003c/span\u003e \u003cspan class=\"synError\"\u003e#f\u0026gt;\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e　\u003cbr/\u003e\n修正3\n\u003cblockquote class=\"twitter-tweet\" lang=\"HASH(0xa7a3470)\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003elambda-curryのletrecは要らない気がする。define-curryの最初のパターンもlambda-curryが0引数対応したなら要らない気がする。 \u003ca href=\"https://t.co/h4ClDCC5ev\"\u003ehttps://t.co/h4ClDCC5ev\u003c/a\u003e\u003c/p\u003e\u0026mdash; Kei (@tk_riple) \u003ca href=\"https://twitter.com/tk_riple/status/684665486274093056\"\u003eJanuary 6, 2016\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003egosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e f \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\nf\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e3/4\u003c/span\u003e\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\nf\ngosh\u0026gt; \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"define-curryを書いてみた"},"content":"\u003cp\u003eカリー化や部分適用の話が\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Twitter\"\u003eTwitter\u003c/a\u003eで流れてきたのでマクロの練習として書いてみました．\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; lambda式を引数に取り，カリー化されたlambda式を返す\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; いらなかった\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; (define-syntax curry\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;   (syntax-rules (lambda) ;; 修正\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;     [(_ (lambda (arg) body ...))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;      (lambda (arg) body ...)]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;     [(_ (lambda (first rest ...) body ...))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;      (lambda (first) (curry (lambda (rest ...) body ...)))]))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine-syntax\u003c/span\u003e lambda-curry\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003esyntax-rules\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)]\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; 修正：引数が０個の手続きに対応\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst rest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eletrec\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efunc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecase-lambda\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e[()\u003c/span\u003e func\u003cspan class=\"synSpecial\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e arg\u003cspan class=\"synSpecial\"\u003e)]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e[\u003c/span\u003eargs \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))])))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       func\u003cspan class=\"synSpecial\"\u003e)]))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;このfuncがなくてもなぜか動く．\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine-syntax\u003c/span\u003e define-curry\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003esyntax-rules\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synComment\"\u003e;; lambda-curryが0引数に対応したのでいらない\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synComment\"\u003e;; [(_ (func-name) body ...)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synComment\"\u003e;;  (define (func-name) body ...)]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efunc-name args ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e func-name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eargs ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body ...\u003cspan class=\"synSpecial\"\u003e))]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e[(\u003c/span\u003e_ var val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e var val\u003cspan class=\"synSpecial\"\u003e)]))\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e　\u003cbr\u003e\n清書\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine-syntax\u003c/span\u003e lambda-curry\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003esyntax-rules\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst rest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eletrec\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efunc \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecase-lambda\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e(()\u003c/span\u003e func\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003earg\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e arg\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eargs \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       func\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;このfuncがなくてもなぜか動く．\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine-syntax\u003c/span\u003e define-curry\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003esyntax-rules\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efunc-name args ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e func-name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eargs ...\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e b0 b1 ...\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e_ var val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e var val\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003etest\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e f \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003ef\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e g \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b c\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b c\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003eg\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synError\"\u003e#\u0026#x3C;undef\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e f \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003ef\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synError\"\u003e#\u0026#x3C;undef\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003ef\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synError\"\u003e#\u0026#x3C;closure\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg a b c\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b c\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003eg\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synError\"\u003e#\u0026#x3C;closure\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synError\"\u003e#\u0026#x3C;closure\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(((\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eg \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e修正1\n\u003c/p\u003e\u003cblockquote class=\"twitter-tweet\" lang=\"HASH(0xa7a3470)\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003ecurry の定義は (syntax-rules (lambda) ...) にしないと (curry (foo (x) x)) とかでも動いてしましそう\n\u003ca href=\"https://t.co/DUJHFogOQg\"\u003ehttps://t.co/DUJHFogOQg\u003c/a\u003e\u003c/p\u003e— でこれき (@dico_leque) \u003ca href=\"https://twitter.com/dico_leque/status/684596402043813888\"\u003eJanuary 6, 2016\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n　\u003cbr\u003e\n　\u003cbr\u003e\n修正2\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e\u003c/p\u003e\u003cblockquote class=\"twitter-tweet\" lang=\"HASH(0xa7a3470)\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003e引数がゼロ個の手続きはこのマクロでは作れないな。\n(lambda-curry () (* 1 2)) みたいなの。\nそれができたからといって使いどころもないけど。\u003c/p\u003e— 齊藤敦志 (@SaitoAtsushi) \u003ca href=\"https://twitter.com/SaitoAtsushi/status/684595362833694720\"\u003eJanuary 6, 2016\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\u003cp\u003e\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synError\"\u003e#\u0026#x3C;closure\u003c/span\u003e \u003cspan class=\"synError\"\u003e#f\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e()\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e　\u003cbr\u003e\n修正3\n\u003c/p\u003e\u003cblockquote class=\"twitter-tweet\" lang=\"HASH(0xa7a3470)\"\u003e\u003cp lang=\"ja\" dir=\"ltr\"\u003elambda-curryのletrecは要らない気がする。define-curryの最初のパターンもlambda-curryが0引数対応したなら要らない気がする。 \u003ca href=\"https://t.co/h4ClDCC5ev\"\u003ehttps://t.co/h4ClDCC5ev\u003c/a\u003e\u003c/p\u003e— Kei (@tk_riple) \u003ca href=\"https://twitter.com/tk_riple/status/684665486274093056\"\u003eJanuary 6, 2016\u003c/a\u003e\u003c/blockquote\u003e\u003cscript async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\u003cp\u003e\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e f \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ea b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003ef\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e1/2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ef \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e3/4\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-curry \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003ef\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003egosh\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ef\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"define-curryを書いてみた"},"buildId":"Q8fC0uqSTU4naW5qMLiKY","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>