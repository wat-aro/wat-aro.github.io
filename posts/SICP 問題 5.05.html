<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>SICP 問題 5.05 | (wat-aro)</title><meta name="title" content="SICP 問題 5.05 | (wat-aro)"/><meta name="description" content="&lt;p&gt;階乗とFibonacci計算機を机上シミュレート.&lt;/p&gt;&lt;pre class=&quot;code lang-scheme&quot; data-lang=&quot;scheme&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;;; 再帰的な階乗計算を机上シミュレートする．&lt;/span&gt;&lt;span class="/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="SICP 問題 5.05 | (wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/og-images/SICP 問題 5.05.png"/><meta property="og:url" content="https://wat-aro.dev/posts/SICP%20%E5%95%8F%E9%A1%8C%205.05"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="SICP 問題 5.05 | (wat-aro)"/><meta name="twitter:description" content="&lt;p&gt;階乗とFibonacci計算機を机上シミュレート.&lt;/p&gt;&lt;pre class=&quot;code lang-scheme&quot; data-lang=&quot;scheme&quot; data-unlink&gt;&lt;span class=&quot;synComment&quot;&gt;;; 再帰的な階乗計算を机上シミュレートする．&lt;/span&gt;&lt;span class="/><meta name="twitter:image" content="https://wat-aro.dev/og-images/SICP 問題 5.05.png"/><meta name="next-head-count" content="17"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/efce62830f77489e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/efce62830f77489e.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d19aa426007499ce.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-0e1c4012a86ba0a9.js" defer=""></script><script src="/_next/static/QZKsZqEGdsUV5BYhsq3fI/_buildManifest.js" defer=""></script><script src="/_next/static/QZKsZqEGdsUV5BYhsq3fI/_ssgManifest.js" defer=""></script><script src="/_next/static/QZKsZqEGdsUV5BYhsq3fI/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full  flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li><li class="h-full  flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts">Blog</a></li></ul></div><div class="flex md:justify-center justify-between w-full"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><article class="flex max-w-4xl w-full"><div class="py-4 w-full"><div class="mr-2 text-xs font-bold">2016/01/23</div><h1 class="font-bold text-3xl text-black">SICP 問題 5.05</h1><nav class="flex mt-2 mb-2 items-start text-gray-500 text-xs"><div class="flex flex-nowrap max-w-full overflow-x-auto"><p class="mr-1 rounded-full px-2 py-1 border leading-none">scheme</p><p class="mr-1 rounded-full px-2 py-1 border leading-none">SICP</p></div></nav><div class="znc"><p>階乗とFibonacci計算機を机上シミュレート.</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synComment">;; 再帰的な階乗計算を机上シミュレートする．</span>
</span><span class="code-line"><span class="synSpecial">(</span>controller
</span><span class="code-line">    <span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label fact-done<span class="synSpecial">))</span>
</span><span class="code-line">  fact-loop
</span><span class="code-line">    <span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">=</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>branch <span class="synSpecial">(</span>label base-case<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synComment">;; nと continue を退避し再帰呼び出しを設定する．</span>
</span><span class="code-line">    <span class="synComment">;; 再帰呼び出しから戻るとき after-fact から</span>
</span><span class="code-line">    <span class="synComment">;; 計算が続行するように continue を設定</span>
</span><span class="code-line">    <span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>save n<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label after-fact<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fact-loop<span class="synSpecial">))</span>
</span><span class="code-line">  after-fact
</span><span class="code-line">    <span class="synSpecial">(</span>restore n<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>op <span class="synIdentifier">*</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>reg val<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>
</span><span class="code-line">  base-case
</span><span class="code-line">    <span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>
</span><span class="code-line">  fact-done<span class="synSpecial">)</span>
</span></code></pre>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synComment">;; (assign (reg n) (const 3))を既に実行済みであると仮定する．</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label fact-done<span class="synSpecial">))</span>     <span class="synComment">;continue &#x3C;= fact-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">=</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>         <span class="synComment">;(= 3 1) => #f</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>                         <span class="synComment">;fact-done => stack => fact-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save n<span class="synSpecial">)</span>                                <span class="synComment">;3 => stack => 3, fact-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>     <span class="synComment">;n &#x3C;= 2</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label after-fact<span class="synSpecial">))</span>    <span class="synComment">;continue &#x3C;= after-fact</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fact-loop<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">=</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>         <span class="synComment">;(= 2 1) => #f</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>                         <span class="synComment">;after-fact => stack => after-fact, 3, fact-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save n<span class="synSpecial">)</span>                                <span class="synComment">;2 => stack => 2, after-fact, 3, fact-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>     <span class="synComment">;n &#x3C;= 1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label after-fact<span class="synSpecial">))</span>    <span class="synComment">;continue &#x3C;= after-fact</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fact-loop<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">=</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>         <span class="synComment">;(= 1 1) => #t</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>branch <span class="synSpecial">(</span>label base-case<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>                  <span class="synComment">;val &#x3C;= 1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                   <span class="synComment">;goto after-fact</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore n<span class="synSpecial">)</span>                             <span class="synComment">;n &#x3C;= 2 | stack => after-fact, 3, fact-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>                      <span class="synComment">;continue &#x3C;= after-fact | stack => 3, fact-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>op <span class="synIdentifier">*</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>reg val<span class="synSpecial">))</span>   <span class="synComment">;val &#x3C;= 2 &#x3C;= (* 2 1)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                   <span class="synComment">;goto after-fact</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore n<span class="synSpecial">)</span>                             <span class="synComment">;n &#x3C;= 3 | stack fact-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>                      <span class="synComment">;continue &#x3C;= fact-done | stack => null</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>op <span class="synIdentifier">*</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>reg val<span class="synSpecial">))</span>   <span class="synComment">;n &#x3C;= 6 &#x3C;= (* 2 3)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                   <span class="synComment">;goto fact-done</span>
</span><span class="code-line">
</span><span class="code-line">fact-done
</span></code></pre>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synComment">;; 次はfibonacci計算を机上シミュレートする．</span>
</span><span class="code-line"><span class="synComment">;; Fibonacci 数を計算する計算機の制御器</span>
</span><span class="code-line"><span class="synSpecial">(</span>controller
</span><span class="code-line">    <span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label fib-done<span class="synSpecial">))</span>
</span><span class="code-line">  fib-loop
</span><span class="code-line">    <span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">&#x3C;</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>branch <span class="synSpecial">(</span>label immediate-answer<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synComment">;; Fib(n-1)を計算するよう設定</span>
</span><span class="code-line">    <span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label afterfib-n-1<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>save n<span class="synSpecial">)</span>                            <span class="synComment">;n の昔の値を退避</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span> <span class="synComment">;n を n-1 に変える</span>
</span><span class="code-line">    <span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fib-loop<span class="synSpecial">))</span>             <span class="synComment">;再帰呼び出しを実行</span>
</span><span class="code-line">  afterfib-n-1                          <span class="synComment">;戻った時 Fib(n-1) は val にある</span>
</span><span class="code-line">    <span class="synSpecial">(</span>restore n<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synComment">;; Fib(n-2)を計算するよう設定</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label afterfib-n-2<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>save val<span class="synSpecial">)</span>                          <span class="synComment">;Fib(n-1) を退避</span>
</span><span class="code-line">    <span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fib-loop<span class="synSpecial">))</span>
</span><span class="code-line">  afterfib-n-2                          <span class="synComment">;戻った時 Fib(n-2) の値は val にある</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>reg val<span class="synSpecial">))</span>                <span class="synComment">;n には Fib(n-2) がある</span>
</span><span class="code-line">    <span class="synSpecial">(</span>restore val<span class="synSpecial">)</span>                       <span class="synComment">;val には Fib(n-1) がある</span>
</span><span class="code-line">    <span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>assign val                         <span class="synComment">;Fib(n-1) + Fib(n-2)</span>
</span><span class="code-line">            <span class="synSpecial">(</span>op <span class="synIdentifier">+</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg val<span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                 <span class="synComment">;呼び出し側に戻る．答えは val にある</span>
</span><span class="code-line">  immediate-answer
</span><span class="code-line">    <span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>reg n<span class="synSpecial">))</span>                <span class="synComment">;基底の場合: Fib(n)=n</span>
</span><span class="code-line">    <span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>
</span><span class="code-line">    fib-done<span class="synSpecial">)</span>
</span></code></pre>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synComment">;; 階乗と同じく(assign n (const 3))を実行済みと仮定する</span>
</span><span class="code-line"><span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label fib-done<span class="synSpecial">))</span>      <span class="synComment">;continue &#x3C;= fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">&#x3C;</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>         <span class="synComment">;(&#x3C; 3 2) => #f</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>                         <span class="synComment">;fib-done => stack => fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label afterfib-n-1<span class="synSpecial">))</span>  <span class="synComment">;continue &#x3C;= afterfib-n-1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save n<span class="synSpecial">)</span>                                <span class="synComment">;3 => stack => 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>     <span class="synComment">;n &#x3C;= 2</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fib-loop<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">&#x3C;</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>         <span class="synComment">;(&#x3C; 2 2) => #f</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>                         <span class="synComment">;afterfib-n-1 => stack => afterfib-n-1, 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label afterfib-n-1<span class="synSpecial">))</span>  <span class="synComment">;continue &#x3C;= afterfib-n-1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save n<span class="synSpecial">)</span>                                <span class="synComment">;2 => stack => 2, afterfib-n-1, 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">1</span><span class="synSpecial">))</span>     <span class="synComment">;n &#x3C;= 1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fib-loop<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">&#x3C;</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>         <span class="synComment">;(&#x3C; 1 2) => #t</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>branch <span class="synSpecial">(</span>label immediate-answer<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>reg n<span class="synSpecial">))</span>                    <span class="synComment">;val &#x3C;= 1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                   <span class="synComment">;(goto afterfib-n-1)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore n<span class="synSpecial">)</span>                             <span class="synComment">;n &#x3C;= 2 | stack => afterfib-n-1, 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>                      <span class="synComment">;continue &#x3C;= afterfib-n-1 | stack => 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>     <span class="synComment">;n &#x3C;= 0</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>                         <span class="synComment">;afterfib-n-1 => stack =>afterfib-n-1, 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label afterfib-n-2<span class="synSpecial">))</span>  <span class="synComment">;continue &#x3C;= afterfib-n-2</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save val<span class="synSpecial">)</span>                              <span class="synComment">;1 => stack => 1, afterfib-n-1, 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fib-loop<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">&#x3C;</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>         <span class="synComment">;(&#x3C; 0 2) => #t</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>branch <span class="synSpecial">(</span>label immediate-answer<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>reg n<span class="synSpecial">))</span>                    <span class="synComment">;val &#x3C;= 0</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                   <span class="synComment">;(goto afterfib-n-2)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>reg val<span class="synSpecial">))</span>                    <span class="synComment">;n &#x3C;= 0</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore val<span class="synSpecial">)</span>                           <span class="synComment">;val &#x3C;= 1 | stack => afterfib-n-1, 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>                      <span class="synComment">;continue &#x3C;= afterfib-n-1 | stack => 3, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>op <span class="synIdentifier">+</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg val<span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">))</span>   <span class="synComment">;val &#x3C;= 1 &#x3C;= (+ 1 0)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                   <span class="synComment">;(goto afterfib-n-1)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore n<span class="synSpecial">)</span>                             <span class="synComment">;n &#x3C;= 3 | stack => fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>                      <span class="synComment">;continue &#x3C;= fib-done | stack => null</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>op <span class="synIdentifier">-</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>     <span class="synComment">;n &#x3C;= 1 &#x3C;= (- 3 2)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save continue<span class="synSpecial">)</span>                         <span class="synComment">;fib-done => stack => fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign continue <span class="synSpecial">(</span>label afterfib-n-2<span class="synSpecial">))</span>  <span class="synComment">;continue &#x3C;= afterfib-n-2</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>save val<span class="synSpecial">)</span>                              <span class="synComment">;1 => stack => 1, fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>label fib-loop<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>test <span class="synSpecial">(</span>op <span class="synIdentifier">&#x3C;</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">)</span> <span class="synSpecial">(</span>const <span class="synConstant">2</span><span class="synSpecial">))</span>         <span class="synComment">;(&#x3C; 1 2) => #t</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>brach <span class="synSpecial">(</span>label immediate-answer<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>reg n<span class="synSpecial">))</span>                    <span class="synComment">;val &#x3C;= 1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                   <span class="synComment">;(goto afterfib-n-2)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign n <span class="synSpecial">(</span>reg val<span class="synSpecial">))</span>                    <span class="synComment">;n &#x3C;= 1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore val<span class="synSpecial">)</span>                           <span class="synComment">;val &#x3C;= 1 | stack => fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>restore continue<span class="synSpecial">)</span>                      <span class="synComment">;continue &#x3C;= fib-done</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>assign val <span class="synSpecial">(</span>op <span class="synIdentifier">+</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>reg val<span class="synSpecial">)</span> <span class="synSpecial">(</span>reg n<span class="synSpecial">))</span>   <span class="synComment">;val &#x3C;= 2 &#x3C;= (+ 1 1)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span>goto <span class="synSpecial">(</span>reg continue<span class="synSpecial">))</span>                   <span class="synComment">;(goto fib-done)</span>
</span><span class="code-line">
</span><span class="code-line">fib-done
</span></code></pre></div></div></article></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"SICP 問題 5.05","published":"2016/01/23","tags":["scheme","SICP"],"content":"\u003cp\u003e階乗とFibonacci計算機を机上シミュレート.\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 再帰的な階乗計算を机上シミュレートする．\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtroller\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  fact-loop\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel base-case\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synComment\"\u003e;; nと continue を退避し再帰呼び出しを設定する．\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synComment\"\u003e;; 再帰呼び出しから戻るとき after-fact から\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synComment\"\u003e;; 計算が続行するように continue を設定\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-fact\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  after-fact\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  base-case\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  fact-done\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; (assign (reg n) (const 3))を既に実行済みであると仮定する．\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(= 3 1) =\u003e #f\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;fact-done =\u003e stack =\u003e fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                                \u003cspan class=\"synComment\"\u003e;3 =\u003e stack =\u003e 3, fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-fact\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= after-fact\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(= 2 1) =\u003e #f\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;after-fact =\u003e stack =\u003e after-fact, 3, fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                                \u003cspan class=\"synComment\"\u003e;2 =\u003e stack =\u003e 2, after-fact, 3, fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-fact\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= after-fact\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(= 1 1) =\u003e #t\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel base-case\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                  \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;goto after-fact\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                             \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 2 | stack =\u003e after-fact, 3, fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= after-fact | stack =\u003e 3, fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 2 \u0026#x3C;= (* 2 1)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;goto after-fact\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                             \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 3 | stack fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= fact-done | stack =\u003e null\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 6 \u0026#x3C;= (* 2 3)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;goto fact-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003efact-done\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 次はfibonacci計算を机上シミュレートする．\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; Fibonacci 数を計算する計算機の制御器\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtroller\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  fib-loop\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synComment\"\u003e;; Fib(n-1)を計算するよう設定\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                            \u003cspan class=\"synComment\"\u003e;n の昔の値を退避\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;n を n-1 に変える\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e             \u003cspan class=\"synComment\"\u003e;再帰呼び出しを実行\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  afterfib-n-1                          \u003cspan class=\"synComment\"\u003e;戻った時 Fib(n-1) は val にある\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synComment\"\u003e;; Fib(n-2)を計算するよう設定\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                          \u003cspan class=\"synComment\"\u003e;Fib(n-1) を退避\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  afterfib-n-2                          \u003cspan class=\"synComment\"\u003e;戻った時 Fib(n-2) の値は val にある\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                \u003cspan class=\"synComment\"\u003e;n には Fib(n-2) がある\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                       \u003cspan class=\"synComment\"\u003e;val には Fib(n-1) がある\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val                         \u003cspan class=\"synComment\"\u003e;Fib(n-1) + Fib(n-2)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                 \u003cspan class=\"synComment\"\u003e;呼び出し側に戻る．答えは val にある\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  immediate-answer\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                \u003cspan class=\"synComment\"\u003e;基底の場合: Fib(n)=n\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    fib-done\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 階乗と同じく(assign n (const 3))を実行済みと仮定する\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e      \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026#x3C; 3 2) =\u003e #f\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;fib-done =\u003e stack =\u003e fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= afterfib-n-1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                                \u003cspan class=\"synComment\"\u003e;3 =\u003e stack =\u003e 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026#x3C; 2 2) =\u003e #f\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;afterfib-n-1 =\u003e stack =\u003e afterfib-n-1, 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= afterfib-n-1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                                \u003cspan class=\"synComment\"\u003e;2 =\u003e stack =\u003e 2, afterfib-n-1, 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026#x3C; 1 2) =\u003e #t\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto afterfib-n-1)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                             \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 2 | stack =\u003e afterfib-n-1, 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= afterfib-n-1 | stack =\u003e 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 0\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;afterfib-n-1 =\u003e stack =\u003eafterfib-n-1, 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= afterfib-n-2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                              \u003cspan class=\"synComment\"\u003e;1 =\u003e stack =\u003e 1, afterfib-n-1, 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026#x3C; 0 2) =\u003e #t\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 0\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto afterfib-n-2)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 0\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                           \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 1 | stack =\u003e afterfib-n-1, 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= afterfib-n-1 | stack =\u003e 3, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 1 \u0026#x3C;= (+ 1 0)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto afterfib-n-1)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                             \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 3 | stack =\u003e fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= fib-done | stack =\u003e null\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 1 \u0026#x3C;= (- 3 2)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;fib-done =\u003e stack =\u003e fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= afterfib-n-2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                              \u003cspan class=\"synComment\"\u003e;1 =\u003e stack =\u003e 1, fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026#x3C; 1 2) =\u003e #t\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebrach \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto afterfib-n-2)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;n \u0026#x3C;= 1\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                           \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 1 | stack =\u003e fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026#x3C;= fib-done\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;val \u0026#x3C;= 2 \u0026#x3C;= (+ 1 1)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto fib-done)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003efib-done\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","slug":"SICP 問題 5.05","rawContent":"\n\u003cp\u003e階乗とFibonacci計算機を机上シミュレート.\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; 再帰的な階乗計算を机上シミュレートする．\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtroller\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  fact-loop\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel base-case\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; nと continue を退避し再帰呼び出しを設定する．\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; 再帰呼び出しから戻るとき after-fact から\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; 計算が続行するように continue を設定\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-fact\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  after-fact\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  base-case\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  fact-done\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; (assign (reg n) (const 3))を既に実行済みであると仮定する．\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= fact-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(= 3 1) =\u0026gt; #f\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;fact-done =\u0026gt; stack =\u0026gt; fact-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                                \u003cspan class=\"synComment\"\u003e;3 =\u0026gt; stack =\u0026gt; 3, fact-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 2\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-fact\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= after-fact\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(= 2 1) =\u0026gt; #f\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;after-fact =\u0026gt; stack =\u0026gt; after-fact, 3, fact-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                                \u003cspan class=\"synComment\"\u003e;2 =\u0026gt; stack =\u0026gt; 2, after-fact, 3, fact-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 1\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel after-fact\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= after-fact\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fact-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(= 1 1) =\u0026gt; #t\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel base-case\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                  \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 1\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;goto after-fact\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                             \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 2 | stack =\u0026gt; after-fact, 3, fact-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= after-fact | stack =\u0026gt; 3, fact-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 2 \u0026lt;= (* 2 1)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;goto after-fact\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                             \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 3 | stack fact-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= fact-done | stack =\u0026gt; null\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 6 \u0026lt;= (* 2 3)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;goto fact-done\u003c/span\u003e\n\nfact-done\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; 次はfibonacci計算を机上シミュレートする．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; Fibonacci 数を計算する計算機の制御器\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econtroller\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  fib-loop\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; Fib(n-1)を計算するよう設定\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                            \u003cspan class=\"synComment\"\u003e;n の昔の値を退避\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;n を n-1 に変える\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e             \u003cspan class=\"synComment\"\u003e;再帰呼び出しを実行\u003c/span\u003e\n  afterfib-n-1                          \u003cspan class=\"synComment\"\u003e;戻った時 Fib(n-1) は val にある\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synComment\"\u003e;; Fib(n-2)を計算するよう設定\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                          \u003cspan class=\"synComment\"\u003e;Fib(n-1) を退避\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n  afterfib-n-2                          \u003cspan class=\"synComment\"\u003e;戻った時 Fib(n-2) の値は val にある\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                \u003cspan class=\"synComment\"\u003e;n には Fib(n-2) がある\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                       \u003cspan class=\"synComment\"\u003e;val には Fib(n-1) がある\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val                         \u003cspan class=\"synComment\"\u003e;Fib(n-1) + Fib(n-2)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                 \u003cspan class=\"synComment\"\u003e;呼び出し側に戻る．答えは val にある\u003c/span\u003e\n  immediate-answer\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                \u003cspan class=\"synComment\"\u003e;基底の場合: Fib(n)=n\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    fib-done\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;; 階乗と同じく(assign n (const 3))を実行済みと仮定する\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-done\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e      \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026lt; 3 2) =\u0026gt; #f\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;fib-done =\u0026gt; stack =\u0026gt; fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= afterfib-n-1\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                                \u003cspan class=\"synComment\"\u003e;3 =\u0026gt; stack =\u0026gt; 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 2\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026lt; 2 2) =\u0026gt; #f\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;afterfib-n-1 =\u0026gt; stack =\u0026gt; afterfib-n-1, 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-1\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= afterfib-n-1\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                                \u003cspan class=\"synComment\"\u003e;2 =\u0026gt; stack =\u0026gt; 2, afterfib-n-1, 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 1\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026lt; 1 2) =\u0026gt; #t\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 1\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto afterfib-n-1)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                             \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 2 | stack =\u0026gt; afterfib-n-1, 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= afterfib-n-1 | stack =\u0026gt; 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 0\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;afterfib-n-1 =\u0026gt; stack =\u0026gt;afterfib-n-1, 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= afterfib-n-2\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                              \u003cspan class=\"synComment\"\u003e;1 =\u0026gt; stack =\u0026gt; 1, afterfib-n-1, 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026lt; 0 2) =\u0026gt; #t\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebranch \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 0\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto afterfib-n-2)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 0\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                           \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 1 | stack =\u0026gt; afterfib-n-1, 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= afterfib-n-1 | stack =\u0026gt; 3, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 1 \u0026lt;= (+ 1 0)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto afterfib-n-1)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                             \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 3 | stack =\u0026gt; fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= fib-done | stack =\u0026gt; null\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 1 \u0026lt;= (- 3 2)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                         \u003cspan class=\"synComment\"\u003e;fib-done =\u0026gt; stack =\u0026gt; fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign continue \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel afterfib-n-2\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e  \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= afterfib-n-2\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esave val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                              \u003cspan class=\"synComment\"\u003e;1 =\u0026gt; stack =\u0026gt; 1, fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel fib-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econst \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e;(\u0026lt; 1 2) =\u0026gt; #t\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebrach \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elabel immediate-answer\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 1\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto afterfib-n-2)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign n \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                    \u003cspan class=\"synComment\"\u003e;n \u0026lt;= 1\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                           \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 1 | stack =\u0026gt; fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erestore continue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e                      \u003cspan class=\"synComment\"\u003e;continue \u0026lt;= fib-done\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassign val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eop \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg val\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e   \u003cspan class=\"synComment\"\u003e;val \u0026lt;= 2 \u0026lt;= (+ 1 1)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003egoto \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ereg continue\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e                   \u003cspan class=\"synComment\"\u003e;(goto fib-done)\u003c/span\u003e\n\nfib-done\n\u003c/pre\u003e\n\n\n"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"SICP 問題 5.05"},"buildId":"QZKsZqEGdsUV5BYhsq3fI","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>