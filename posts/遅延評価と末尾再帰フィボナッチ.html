<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head=""></title><meta name="title" content="遅延評価と末尾再帰フィボナッチ | (wat-aro)" data-next-head=""/><meta name="description" content="&lt;p&gt;前回の&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/SICP&quot;&gt;SICP&lt;/a&gt;問題4.29で遅延評価する評価器でメモ化しない場合に，する場合と比べてはるかに遅くなるプログラムの例としてフィボナッチを書きました．&lt;br/&gt;ただ，あまりに差が大きくてな" data-next-head=""/><meta property="og:locale" content="ja_jp" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="og:site_name" content="(wat-aro)" data-next-head=""/><meta property="og:title" content="遅延評価と末尾再帰フィボナッチ | (wat-aro)" data-next-head=""/><meta property="og:image" content="https://wat-aro.dev/og-images/遅延評価と末尾再帰フィボナッチ.png" data-next-head=""/><meta property="og:url" content="https://wat-aro.dev/posts/%E9%81%85%E5%BB%B6%E8%A9%95%E4%BE%A1%E3%81%A8%E6%9C%AB%E5%B0%BE%E5%86%8D%E5%B8%B0%E3%83%95%E3%82%A3%E3%83%9C%E3%83%8A%E3%83%83%E3%83%81" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:site" content="@wat_aro" data-next-head=""/><meta name="twitter:creator" content="@wat_aro" data-next-head=""/><meta name="twitter:title" content="遅延評価と末尾再帰フィボナッチ | (wat-aro)" data-next-head=""/><meta name="twitter:description" content="&lt;p&gt;前回の&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/SICP&quot;&gt;SICP&lt;/a&gt;問題4.29で遅延評価する評価器でメモ化しない場合に，する場合と比べてはるかに遅くなるプログラムの例としてフィボナッチを書きました．&lt;br/&gt;ただ，あまりに差が大きくてな" data-next-head=""/><meta name="twitter:image" content="https://wat-aro.dev/og-images/遅延評価と末尾再帰フィボナッチ.png" data-next-head=""/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/chunks/438e15ddcfc89b34.css" as="style"/><link rel="stylesheet" href="/_next/static/chunks/438e15ddcfc89b34.css" data-n-g=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/0ebb6bea92c9c72b.js" defer=""></script><script src="/_next/static/chunks/c42201dc9ba41364.js" defer=""></script><script src="/_next/static/chunks/6309b00b4f2a972d.js" defer=""></script><script src="/_next/static/chunks/turbopack-95c7cb38503ae532.js" defer=""></script><script src="/_next/static/chunks/570512232d52dd38.js" defer=""></script><script src="/_next/static/chunks/turbopack-aa98065272bfd020.js" defer=""></script><script src="/_next/static/Vkket-G7K8unr3JM8zyxA/_ssgManifest.js" defer=""></script><script src="/_next/static/Vkket-G7K8unr3JM8zyxA/_buildManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><link rel="preload" as="image" href="/images/profile.jpg"/><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)</div></a><ul class="flex gap-3 h-full"><li class="h-full flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts">Blog</a></li><li class="h-full flex flex-col justify-end border-black pb-4"><a href="/slides">Slide</a></li><li class="h-full flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li></ul></div><div class="flex md:justify-center justify-between w-full flex-grow"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><article class="flex max-w-4xl w-full"><div class="py-4 w-full"><div class="mr-2 text-xs font-bold">2016/01/08</div><h1 class="font-bold text-3xl text-black">遅延評価と末尾再帰フィボナッチ</h1><nav class="flex mt-2 mb-2 items-start text-gray-500 text-xs"><div class="flex flex-wrap max-w-full overflow-x-auto gap-2"><a href="/tags/sicp"><p class="mr-1 rounded-full px-2 py-1 border leading-none">SICP</p></a><a href="/tags/scheme"><p class="mr-1 rounded-full px-2 py-1 border leading-none">scheme</p></a></div></nav><div class="znc"><p>前回の<a class="keyword" href="http://d.hatena.ne.jp/keyword/SICP">SICP</a>問題4.29で遅延評価する評価器でメモ化しない場合に，する場合と比べてはるかに遅くなるプログラムの例としてフィボナッチを書きました．<br>
ただ，あまりに差が大きくてなぜそうなるのかがわからなかったので考えてみました．<br>
評価器は最後に載せておきます．<br>
　<br>
フィボナッチの定義は以下の通り，末尾<a class="keyword" href="http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2">再帰</a>で書いています．</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>fib n<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>a <span class="synConstant">0</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>b <span class="synConstant">1</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>count n<span class="synSpecial">))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">=</span> count <span class="synConstant">0</span><span class="synSpecial">)</span>
</span><span class="code-line">        a
</span><span class="code-line">        <span class="synSpecial">(</span>iter b <span class="synSpecial">(</span><span class="synIdentifier">+</span> a b<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">-</span> count <span class="synConstant">1</span><span class="synSpecial">)))))</span>
</span></code></pre>
<p>メモ化した場合は</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synComment">;;; M-Eval input:</span>
</span><span class="code-line"><span class="synSpecial">(</span>fib <span class="synConstant">10000</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synComment">;(time (actual-value input the-global-environment))</span>
</span><span class="code-line"><span class="synComment">; real   0.190</span>
</span><span class="code-line"><span class="synComment">; user   0.190</span>
</span><span class="code-line"><span class="synComment">; sys    0.000</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;;; M-Eval value:</span>
</span><span class="code-line"><span class="synConstant">33644764876431783266621612005107543310302148460680063906564769974680081442166662368155595513633734025582065332680836159373734790483865268263040892463056431887354544369559827491606602099884183933864652731300088830269235673613135117579297437854413752130520504347701602264758318906527890855154366159582987279682987510631200575428783453215515103870818298969791613127856265033195487140214287532698187962046936097879900350962302291026368131493195275630227837628441540360584402572114334961180023091208287046088923962328835461505776583271252546093591128203925285393434620904245248929403901706233888991085841065183173360437470737908552631764325733993712871937587746897479926305837065742830161637408969178426378624212835258112820516370298089332099905707920064367426202389783111470054074998459250360633560933883831923386783056136435351892133279732908133732642652633989763922723407882928177953580570993691049175470808931841056146322338217465637321248226383092103297701648054726243842374862411453093812206564914032751086643394517512161526545361333111314042436854805106765843493523836959653428071768775328348234345557366719731392746273629108210679280784718035329131176778924659089938635459327894523777674406192240337638674004021330343297496902028328145933418826817683893072003634795623117103101291953169794607632737589253530772552375943788434504067715555779056450443016640119462580972216729758615026968443146952034614932291105970676243268515992834709891284706740862008587135016260312071903172086094081298321581077282076353186624611278245537208532365305775956430072517744315051539600905168603220349163222640885248852433158051534849622434848299380905070483482449327453732624567755879089187190803662058009594743150052402532709746995318770724376825907419939632265984147498193609285223945039707165443156421328157688908058783183404917434556270520223564846495196112460268313970975069382648706613264507665074611512677522748621598642530711298441182622661057163515069260029861704945425047491378115154139941550671256271197133252763631939606902895650288268608362241082050562430701794976171121233066073310059947366875</span>
</span></code></pre>
<p>メモ化していない場合は</p>
<pre class="code" data-lang="" data-unlink=""><code class="code-highlight"><span class="code-line">;;; M-Eval input:
</span><span class="code-line">(fib 30)
</span><span class="code-line">;(time (actual-value input the-global-environment))
</span><span class="code-line">; real   6.628
</span><span class="code-line">; user   6.620
</span><span class="code-line">; sys    0.010
</span><span class="code-line">
</span><span class="code-line">;;; M-Eval value:
</span><span class="code-line">832040</span></code></pre>
<p>メモ化していない場合になぜこれだけ遅いかを検証します．<br>
(<a class="keyword" href="http://d.hatena.ne.jp/keyword/iter">iter</a> 0 1 30)から考えます．</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">=</span> count <span class="synConstant">0</span><span class="synSpecial">)</span>
</span><span class="code-line">    a
</span><span class="code-line">    <span class="synSpecial">(</span>iter b <span class="synSpecial">(</span><span class="synIdentifier">+</span> a b<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">-</span> count <span class="synConstant">1</span><span class="synSpecial">)))</span>
</span></code></pre>
<p>なのでまずa b countはそれぞれ(thunk 0) (thunk 1) (thunk 30)となります．</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-if <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>true? <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>if-predicate <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>if-consequent <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>if-alternative <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)))</span>
</span></code></pre>
<p>なのでpredicateが評価され，countは30となります．<br>
次の<a class="keyword" href="http://d.hatena.ne.jp/keyword/iter">iter</a>が呼ばれます．この時のa b countは(thunk 1) (thunk (+ (thunk 0) (thunk 1))) (thunk (- 30 1))です．<br>
これがcountが0になるまで続けられます．<br>
countが0になるとifのconsequentが評価されます．<br>
ここで初めてaが評価されることになります．<br>
この時にはaには二つ上のthunkとさらに一つ上のthunkを足したものが<a class="keyword" href="http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2">再帰</a>的になったthunkが入っています．<br>
bには一つ上のthunkとさらに一つ上のthunkを足したものが<a class="keyword" href="http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2">再帰</a>的になったthunkが入っています．<br>
つまり，(+ (fib (- n 1)) (fib (- n 2)))を計算するのと同じような計算が必要になります．<br>
メモ化していない場合はこれらをすべて計算していくことになります．<br>
メモ化している場合はそれぞれの階層の<a class="keyword" href="http://d.hatena.ne.jp/keyword/iter">iter</a>の環境にbindされている手続きがevaluated-thunkと値に置き換えられていくので無駄な計算が生じません．<br>
遅延評価だと引数は必要になるまで評価されないので末尾<a class="keyword" href="http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2">再帰</a>で書いてもメモ化しない場合はあまり効率的にはなりません．</p>
<p>[評価器]</p>
<pre class="code lang-scheme" data-lang="scheme" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> true <span class="synConstant">#t</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> false <span class="synConstant">#f</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>self-evaluating? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">((</span>variable? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>lookup-variable-value <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>quoted? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>text-of-quotation <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>assignment? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-assignment <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>definition? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-definition <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>if? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-if <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>make-procedure <span class="synSpecial">(</span>lambda-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>lambda-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>let? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>let->combination <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>let*? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>let*->nested-lets <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>letrec? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>letrec->let <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span> <span class="synComment">;;letrecを追加</span>
</span><span class="code-line">        <span class="synSpecial">((</span>begin? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>eval-sequence <span class="synSpecial">(</span>begin-actions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>cond? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>cond->if <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>and? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-and <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>or? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>eval-or <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>application? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>my-apply <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>operator <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">                   <span class="synSpecial">(</span>operands <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                   env<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synComment">;; (my-apply (eval (operator exp) env)</span>
</span><span class="code-line">         <span class="synComment">;;           (list-of-values (operands exp) env))</span>
</span><span class="code-line">         <span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span>
</span><span class="code-line">         <span class="synSpecial">(</span>error <span class="synConstant">"Unknown expression type --EVAL"</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; メモ化する評価器</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>force-it obj<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>thunk? obj<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>result <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>thunk-exp obj<span class="synSpecial">)</span>
</span><span class="code-line">                                     <span class="synSpecial">(</span>thunk-env obj<span class="synSpecial">))))</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> obj <span class="synSpecial">'</span>evaluated-thunk<span class="synSpecial">)</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> obj<span class="synSpecial">)</span> result<span class="synSpecial">)</span> <span class="synComment">;;expをその値で置き換える</span>
</span><span class="code-line">           <span class="synSpecial">(</span><span class="synIdentifier">set-cdr!</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> obj<span class="synSpecial">)</span> <span class="synSpecial">'())</span>    <span class="synComment">;;必要のなくなったenvを忘れる</span>
</span><span class="code-line">           result<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span>evaluated-thunk? obj<span class="synSpecial">)</span> <span class="synSpecial">(</span>thunk-value obj<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> obj<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; メモ化しない評価器</span>
</span><span class="code-line"><span class="synComment">;; (define (force-it obj)</span>
</span><span class="code-line"><span class="synComment">;;   (if (thunk? obj)</span>
</span><span class="code-line"><span class="synComment">;;       (actual-value (thunk-exp obj) (thunk-env obj))</span>
</span><span class="code-line"><span class="synComment">;;       obj))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>delay-it <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>thunk <span class="synIdentifier">exp</span> env<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>thunk? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>thunk<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>thunk-exp thunk<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> thunk<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>thunk-env thunk<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> thunk<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>evaluated-thunk? obj<span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? obj <span class="synSpecial">'</span>evaluated-thunk<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>thunk-value evaluated-thunk<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> evaluated-thunk<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>actual-value <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>force-it <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synIdentifier">exp</span> env<span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>foo bar<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>bar <span class="synSpecial">'</span>a<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; apply</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>my-apply procedure arguments env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>primitive-procedure? procedure<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>apply-primitive-procedure
</span><span class="code-line">          procedure
</span><span class="code-line">          <span class="synSpecial">(</span>list-of-arg-values arguments env<span class="synSpecial">)))</span> <span class="synComment">; changed</span>
</span><span class="code-line">        <span class="synSpecial">((</span>compound-procedure? procedure<span class="synSpecial">)</span>
</span><span class="code-line">         <span class="synSpecial">(</span>eval-sequence
</span><span class="code-line">          <span class="synSpecial">(</span>procedure-body procedure<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">(</span>extend-environment <span class="synSpecial">(</span>procedure-parameters procedure<span class="synSpecial">)</span>
</span><span class="code-line">                              <span class="synSpecial">(</span>list-of-delayed-args arguments env<span class="synSpecial">)</span> <span class="synComment">; changed</span>
</span><span class="code-line">                              <span class="synSpecial">(</span>procedure-environment procedure<span class="synSpecial">))))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>error <span class="synConstant">"Unknown procedure type: APPLY"</span> procedure<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-of-arg-values exps env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>no-operands? exps<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">'()</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>first-operand exps<span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">            <span class="synSpecial">(</span>list-of-arg-values <span class="synSpecial">(</span>rest-operands exps<span class="synSpecial">)</span> env<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>list-of-delayed-args exps env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>no-operands? exps<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">'()</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span>delay-it <span class="synSpecial">(</span>first-operand exps<span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">            <span class="synSpecial">(</span>list-of-delayed-args <span class="synSpecial">(</span>rest-operands exps<span class="synSpecial">)</span> env<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-if <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>true? <span class="synSpecial">(</span>actual-value <span class="synSpecial">(</span>if-predicate <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>if-consequent <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>if-alternative <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-sequence exps env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span>last-exp? exps<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>first-exp exps<span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>first-exp exps<span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">              <span class="synSpecial">(</span>eval-sequence <span class="synSpecial">(</span>rest-exps exps<span class="synSpecial">)</span> env<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 代入</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-assignment <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>set-variable-value! <span class="synSpecial">(</span>assignment-variable <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                       <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>assignment-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">                       env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">'</span>ok<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 定義</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-definition <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>define-variable!
</span><span class="code-line">    <span class="synSpecial">(</span>definition-variable <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span>definition-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span> env<span class="synSpecial">)</span>
</span><span class="code-line">    env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">'</span>ok<span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 自己評価式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>self-evaluating? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">number?</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span> true<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">((</span><span class="synIdentifier">string?</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span> true<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> false<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 変数</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>variable? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; クオート</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>quoted? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>quote<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>text-of-quotation <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> tag<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">pair?</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span> tag<span class="synSpecial">)</span>
</span><span class="code-line">      false<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 代入</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>assignment? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>set!<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>assignment-variable <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>assignment-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 定義</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>definition? <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>define<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>definition-variable <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">caadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>definition-value <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span>make-lambda <span class="synSpecial">(</span><span class="synIdentifier">cdadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synComment">;;仮パラメタ</span>
</span><span class="code-line">                   <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))))</span> <span class="synComment">;;本体</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; lambda式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>lambda<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-lambda parameters body<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>lambda <span class="synSpecial">(</span><span class="synIdentifier">cons</span> parameters body<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>def-body-list proc-body<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>proc-body proc-body<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>def <span class="synSpecial">'())</span>
</span><span class="code-line">             <span class="synSpecial">(</span>body <span class="synSpecial">'()))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> proc-body<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> def<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> body<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">((</span>definition? <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">))</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                                               <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> def<span class="synSpecial">)</span>
</span><span class="code-line">                                               body<span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                      def
</span><span class="code-line">                      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> body<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; ((define u e1) (define v e2) e3 e4)</span>
</span><span class="code-line"><span class="synComment">;; => ((let ((u *unassigned*) (v *unassigned*)) (set! u e1) (set! v e2) e3 e4))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>scan-out-defines body<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>split-def-body proc-body<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>proc-body proc-body<span class="synSpecial">)</span>
</span><span class="code-line">               <span class="synSpecial">(</span>def <span class="synSpecial">'())</span>
</span><span class="code-line">               <span class="synSpecial">(</span>body <span class="synSpecial">'()))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> proc-body<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> def<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> body<span class="synSpecial">)))</span>
</span><span class="code-line">            <span class="synSpecial">((</span>definition? <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">))</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                                                 <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> def<span class="synSpecial">)</span>
</span><span class="code-line">                                                 body<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                        def
</span><span class="code-line">                        <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> body<span class="synSpecial">))))))</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let*</span> <span class="synSpecial">((</span>def-body-list <span class="synSpecial">(</span>split-def-body body<span class="synSpecial">))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>def-list <span class="synSpecial">(</span><span class="synIdentifier">car</span> def-body-list<span class="synSpecial">))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>body-list <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> def-body-list<span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> def-list<span class="synSpecial">)</span>
</span><span class="code-line">        body
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span>make-let <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>x<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span>definition-variable x<span class="synSpecial">)</span> <span class="synSpecial">''</span><span class="synConstant">*unassigned*</span><span class="synSpecial">))</span>
</span><span class="code-line">                         def-list<span class="synSpecial">)</span>
</span><span class="code-line">                    <span class="synSpecial">(</span><span class="synIdentifier">append</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>x<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>set! <span class="synSpecial">(</span>definition-variable x<span class="synSpecial">)</span>
</span><span class="code-line">                                                   <span class="synSpecial">(</span>definition-value x<span class="synSpecial">)))</span>
</span><span class="code-line">                                 def-list<span class="synSpecial">)</span>
</span><span class="code-line">                            body-list<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; if</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>if? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>if<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>if-predicate <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>if-consequent <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>if-alternative <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">not</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cadddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">'</span>false<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-if predicate consequent alternative<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>if predicate consequent alternative<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; begin</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>begin? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>begin<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>begin-actions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>last-exp? seq<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> seq<span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>first-exp seq<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> seq<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>rest-exps seq<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> seq<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>sequence->exp seq<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> seq<span class="synSpecial">)</span> seq<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">((</span>last-exp? seq<span class="synSpecial">)</span> <span class="synSpecial">(</span>first-exp seq<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>make-begin seq<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-begin seq<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>begin seq<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 任意の合成式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>application? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">pair?</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>operator <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>operands <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>no-operands? ops<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> ops<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>first-operand ops<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> ops<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>rest-operands ops<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> ops<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 派生式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>cond<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond-else-clause? clause<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> <span class="synSpecial">(</span>cond-predicate clause<span class="synSpecial">)</span> <span class="synSpecial">'</span>else<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond-predicate clause<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> clause<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond-actions clause<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clause<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>cond->if <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>expand-clauses <span class="synSpecial">(</span>cond-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>expand-clauses clauses<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> clauses<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">'</span>false
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>first <span class="synSpecial">(</span><span class="synIdentifier">car</span> clauses<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span>rest <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">)))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>cond-else-clause? first<span class="synSpecial">)</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> rest<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>sequence->exp <span class="synSpecial">(</span>cond-actions first<span class="synSpecial">))</span>
</span><span class="code-line">                <span class="synSpecial">(</span>error <span class="synConstant">"ELSE clause isn't last -- COND->IF"</span> clauses<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>action <span class="synSpecial">(</span>cond-actions first<span class="synSpecial">))</span>
</span><span class="code-line">                  <span class="synSpecial">(</span>predicate <span class="synSpecial">(</span>cond-predicate first<span class="synSpecial">)))</span>
</span><span class="code-line">              <span class="synSpecial">(</span>make-if predicate
</span><span class="code-line">                       <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> action<span class="synSpecial">)</span> <span class="synSpecial">'</span>=><span class="synSpecial">)</span>
</span><span class="code-line">                           <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> action<span class="synSpecial">)</span> predicate<span class="synSpecial">)</span>
</span><span class="code-line">                           <span class="synSpecial">(</span>sequence->exp action<span class="synSpecial">))</span>
</span><span class="code-line">                       <span class="synSpecial">(</span>expand-clauses rest<span class="synSpecial">)))))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; and</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>and? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>and<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>and-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-and <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>clauses <span class="synSpecial">(</span>and-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> clauses<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">'</span>true
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>first <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> clauses<span class="synSpecial">)</span> env<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">))</span> first<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>first <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">)))</span>
</span><span class="code-line">                <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">'</span>false<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; or</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>or? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>or<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>or-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>eval-or <span class="synIdentifier">exp</span> env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>clauses <span class="synSpecial">(</span>or-clauses <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">null?</span> clauses<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">'</span>false
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>first <span class="synSpecial">(</span><span class="synIdentifier">eval</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> clauses<span class="synSpecial">)</span> env<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">))</span> first<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>first <span class="synSpecial">'</span>true<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> clauses<span class="synSpecial">))))))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; let</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>let<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> <span class="synSpecial">(</span>let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">cadr</span> <span class="synSpecial">(</span>let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let->combination <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span> <span class="synComment">;; 2番目の要素がシンボルならnamed-let</span>
</span><span class="code-line">      <span class="synSpecial">(</span>named-let->define <span class="synSpecial">(</span>named-let-func-name <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>named-let-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>named-let-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>named-let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span>make-lambda <span class="synSpecial">(</span>let-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                     <span class="synSpecial">(</span>let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span>let-expressions <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; let*</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>let*<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> <span class="synSpecial">(</span>let*-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">cadr</span> <span class="synSpecial">(</span>let*-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-let parameters bodys<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>let <span class="synSpecial">(</span><span class="synIdentifier">cons</span> parameters bodys<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>let*->nested-lets <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>expand-lets <span class="synSpecial">(</span>let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>expand-lets parameters bodys<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> parameters<span class="synSpecial">)</span> <span class="synSpecial">(</span>error <span class="synConstant">"EXPAND-LETS required pair, but "</span> parameters<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">((</span><span class="synIdentifier">null?</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> parameters<span class="synSpecial">))</span>
</span><span class="code-line">         <span class="synSpecial">(</span>make-let <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> parameters<span class="synSpecial">))</span>
</span><span class="code-line">                   bodys<span class="synSpecial">))</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>make-let <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> parameters<span class="synSpecial">))</span>
</span><span class="code-line">                        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span>expand-lets <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> parameters<span class="synSpecial">)</span> bodys<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; named-let</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">symbol?</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-func-name <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> <span class="synSpecial">(</span>named-let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">cadr</span> <span class="synSpecial">(</span>named-let-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let-bodys <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-definition variable value<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>define variable value<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>named-let->define func-name variables expressions bodys<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>make-begin <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span>make-definition func-name <span class="synSpecial">(</span>make-lambda variables bodys<span class="synSpecial">))</span>
</span><span class="code-line">                    <span class="synSpecial">(</span><span class="synIdentifier">cons</span> func-name expressions<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 術後のテスト</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>true? x<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">not</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> x <span class="synSpecial">'</span><span class="synConstant">#f</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>false? x<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> x <span class="synSpecial">'</span><span class="synConstant">#f</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 手続きの表現</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-procedure parameters body env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>procedure parameters <span class="synSpecial">(</span>scan-out-defines body<span class="synSpecial">)</span> env<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>compound-procedure? p<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? p <span class="synSpecial">'</span>procedure<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>procedure-parameters p<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> p<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>procedure-body p<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">caddr</span> p<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>procedure-environment p<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadddr</span> p<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 環境に対する操作</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>enclosing-environment env<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> env<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>first-frame env<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> env<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> the-empty-environment <span class="synSpecial">'())</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; フレーム</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-frame variables <span class="synIdentifier">values</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">cons</span> variables <span class="synIdentifier">values</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> frame<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> frame<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>add-binding-to-frame! var val frame<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> frame <span class="synSpecial">(</span><span class="synIdentifier">cons</span> var <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)))</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">set-cdr!</span> frame <span class="synSpecial">(</span><span class="synIdentifier">cons</span> val <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 変数を値に対応づける新しいフレーム</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>extend-environment vars vals base-env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">=</span> <span class="synSpecial">(</span><span class="synIdentifier">length</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">length</span> vals<span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span>make-frame vars vals<span class="synSpecial">)</span> base-env<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">&#x3C;</span> <span class="synSpecial">(</span><span class="synIdentifier">length</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">length</span> vals<span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">(</span>error <span class="synConstant">"Too many arguments supplied"</span> vars vals<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">(</span>error <span class="synConstant">"Too few arguments supplied"</span> vars vals<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lookup-variable-value var env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>env-loop env<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>scan vars vals<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> vars<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>env-loop <span class="synSpecial">(</span>enclosing-environment env<span class="synSpecial">)))</span>
</span><span class="code-line">            <span class="synSpecial">((</span><span class="synIdentifier">eq?</span> var <span class="synSpecial">(</span><span class="synIdentifier">car</span> vars<span class="synSpecial">))</span>
</span><span class="code-line">             <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> vals<span class="synSpecial">)</span> <span class="synSpecial">'</span><span class="synConstant">*unassigned*</span><span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">(</span>error <span class="synConstant">"*Unassigned* variable"</span> var<span class="synSpecial">)</span>
</span><span class="code-line">                 <span class="synSpecial">(</span><span class="synIdentifier">car</span> vals<span class="synSpecial">)))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>scan <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vals<span class="synSpecial">)))))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> env the-empty-environment<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span>error <span class="synConstant">"Unbound variable"</span> var<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>frame <span class="synSpecial">(</span>first-frame env<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">(</span>scan <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">)))))</span>
</span><span class="code-line">  <span class="synSpecial">(</span>env-loop env<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>set-variable-value! var val env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>env-loop env<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>scan vars vals<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> vars<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>env-loop <span class="synSpecial">(</span>enclosing-environment env<span class="synSpecial">)))</span>
</span><span class="code-line">            <span class="synSpecial">((</span><span class="synIdentifier">eq?</span> var <span class="synSpecial">(</span><span class="synIdentifier">car</span> vars<span class="synSpecial">))</span>
</span><span class="code-line">             <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> vals val<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>scan <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vals<span class="synSpecial">)))))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span><span class="synIdentifier">eq?</span> env the-empty-environment<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span>error <span class="synConstant">"Unbound variable -- SET!"</span> var<span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>frame <span class="synSpecial">(</span>first-frame env<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">(</span>scan <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)</span>
</span><span class="code-line">                <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">)))))</span>
</span><span class="code-line">  <span class="synSpecial">(</span>env-loop env<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>define-variable! var val env<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>frame <span class="synSpecial">(</span>first-frame env<span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>scan vars vals<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> vars<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>add-binding-to-frame! var val frame<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">((</span><span class="synIdentifier">eq?</span> var <span class="synSpecial">(</span><span class="synIdentifier">car</span> vars<span class="synSpecial">))</span>
</span><span class="code-line">             <span class="synSpecial">(</span><span class="synIdentifier">set-car!</span> vals val<span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>scan <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vars<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> vals<span class="synSpecial">)))))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>scan <span class="synSpecial">(</span>frame-variables frame<span class="synSpecial">)</span>
</span><span class="code-line">          <span class="synSpecial">(</span>frame-values frame<span class="synSpecial">))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>primitive-procedure? proc<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>tagged-list? proc <span class="synSpecial">'</span>primitive<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>primitive-implementation proc<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> proc<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> primitive-procedures
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>car <span class="synIdentifier">car</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>cdr <span class="synIdentifier">cdr</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>cons <span class="synIdentifier">cons</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>null? <span class="synIdentifier">null?</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>= <span class="synIdentifier">=</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>- <span class="synIdentifier">-</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>+ <span class="synIdentifier">+</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>* <span class="synIdentifier">*</span><span class="synSpecial">)</span>
</span><span class="code-line">        <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>/ <span class="synIdentifier">/</span><span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>primitive-procedure-names<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> primitive-procedures<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>primitive-procedure-objects<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>proc<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>primitive <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> proc<span class="synSpecial">)))</span>
</span><span class="code-line">       primitive-procedures<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>apply-primitive-procedure proc args<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>apply-in-underlying-scheme
</span><span class="code-line">   <span class="synSpecial">(</span>primitive-implementation proc<span class="synSpecial">)</span> args<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> apply-in-underlying-scheme <span class="synIdentifier">apply</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; 環境</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>setup-environment<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>initial-env
</span><span class="code-line">         <span class="synSpecial">(</span>extend-environment <span class="synSpecial">(</span>primitive-procedure-names<span class="synSpecial">)</span>
</span><span class="code-line">                             <span class="synSpecial">(</span>primitive-procedure-objects<span class="synSpecial">)</span>
</span><span class="code-line">                             the-empty-environment<span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span>define-variable! <span class="synSpecial">'</span>true <span class="synConstant">#t</span> initial-env<span class="synSpecial">)</span>
</span><span class="code-line">    <span class="synSpecial">(</span>define-variable! <span class="synSpecial">'</span>false <span class="synConstant">#f</span> initial-env<span class="synSpecial">)</span>
</span><span class="code-line">    initial-env<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> the-global-environment <span class="synSpecial">(</span>setup-environment<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> input-prompt <span class="synConstant">";;; M-Eval input:"</span><span class="synSpecial">)</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> output-prompt <span class="synConstant">";;; M-Eval value:"</span><span class="synSpecial">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>driver-loop<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>prompt-for-input input-prompt<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>input <span class="synSpecial">(</span><span class="synIdentifier">read</span><span class="synSpecial">)))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">let</span> <span class="synSpecial">((</span>output <span class="synSpecial">(</span>time <span class="synSpecial">(</span>actual-value input the-global-environment<span class="synSpecial">))))</span> <span class="synComment">;; test用にtimeマクロを入れている</span>
</span><span class="code-line">      <span class="synSpecial">(</span>announce-output output-prompt<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span>user-print output<span class="synSpecial">)))</span>
</span><span class="code-line">  <span class="synSpecial">(</span>driver-loop<span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>prompt-for-input <span class="synIdentifier">string</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synIdentifier">string</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>announce-output <span class="synIdentifier">string</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synIdentifier">string</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">newline</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>user-print object<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">if</span> <span class="synSpecial">(</span>compound-procedure? object<span class="synSpecial">)</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">display</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>compound-procedure
</span><span class="code-line">                     <span class="synSpecial">(</span>procedure-parameters object<span class="synSpecial">)</span>
</span><span class="code-line">                     <span class="synSpecial">(</span>procedure-body object<span class="synSpecial">)</span>
</span><span class="code-line">                     <span class="synSpecial">'</span><span class="synConstant">&#x3C;procedure-env></span><span class="synSpecial">))</span>
</span><span class="code-line">      <span class="synSpecial">(</span><span class="synIdentifier">display</span> object<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">;; lambda式</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>lambda<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>lambda-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>make-lambda parameters body<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">'</span>lambda <span class="synSpecial">(</span><span class="synIdentifier">cons</span> parameters body<span class="synSpecial">)))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>def-body-list proc-body<span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span><span class="synStatement">let</span> iter <span class="synSpecial">((</span>proc-body proc-body<span class="synSpecial">)</span>
</span><span class="code-line">             <span class="synSpecial">(</span>def <span class="synSpecial">'())</span>
</span><span class="code-line">             <span class="synSpecial">(</span>body <span class="synSpecial">'()))</span>
</span><span class="code-line">    <span class="synSpecial">(</span><span class="synStatement">cond</span> <span class="synSpecial">((</span><span class="synIdentifier">null?</span> proc-body<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> def<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">reverse</span> body<span class="synSpecial">)))</span>
</span><span class="code-line">          <span class="synSpecial">((</span>definition? <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">))</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                                               <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> def<span class="synSpecial">)</span>
</span><span class="code-line">                                               body<span class="synSpecial">))</span>
</span><span class="code-line">          <span class="synSpecial">(</span><span class="synStatement">else</span> <span class="synSpecial">(</span>iter <span class="synSpecial">(</span><span class="synIdentifier">cdr</span> proc-body<span class="synSpecial">)</span>
</span><span class="code-line">                      def
</span><span class="code-line">                      <span class="synSpecial">(</span><span class="synIdentifier">cons</span> <span class="synSpecial">(</span><span class="synIdentifier">car</span> proc-body<span class="synSpecial">)</span> body<span class="synSpecial">))))))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec? <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span>tagged-list? <span class="synIdentifier">exp</span> <span class="synSpecial">'</span>letrec<span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cadr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">car</span> <span class="synSpecial">(</span>letrec-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec-expressions <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synIdentifier">cadr</span> <span class="synSpecial">(</span>letrec-parameters <span class="synIdentifier">exp</span><span class="synSpecial">)))</span>
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec-body <span class="synIdentifier">exp</span><span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">cddr</span> <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synSpecial">(</span><span class="synStatement">define</span> <span class="synSpecial">(</span>letrec->let <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">  <span class="synSpecial">(</span>make-let <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>x<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> x <span class="synSpecial">''</span><span class="synConstant">*unassigned*</span><span class="synSpecial">))</span>
</span><span class="code-line">                 <span class="synSpecial">(</span>letrec-variables <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">            <span class="synSpecial">(</span><span class="synIdentifier">append</span> <span class="synSpecial">(</span><span class="synIdentifier">map</span> <span class="synSpecial">(</span><span class="synStatement">lambda</span> <span class="synSpecial">(</span>x y<span class="synSpecial">)</span> <span class="synSpecial">(</span><span class="synIdentifier">list</span> <span class="synSpecial">'</span>set! x y<span class="synSpecial">))</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>letrec-variables <span class="synIdentifier">exp</span><span class="synSpecial">)</span>
</span><span class="code-line">                         <span class="synSpecial">(</span>letrec-expressions <span class="synIdentifier">exp</span><span class="synSpecial">))</span>
</span><span class="code-line">                    <span class="synSpecial">(</span>letrec-body <span class="synIdentifier">exp</span><span class="synSpecial">))))</span>
</span></code></pre></div></div></article></div></div><div class="flex md:justify-center w-full"><div class="flex flex-col md:max-w-4xl w-full"><hr/><div class="flex justify-center pt-4 pb-8">© 2022 wat-aro</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"遅延評価と末尾再帰フィボナッチ","published":"2016/01/08","tags":["SICP","scheme"],"content":"\n\u003cp\u003e前回の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SICP\"\u003eSICP\u003c/a\u003e問題4.29で遅延評価する評価器でメモ化しない場合に，する場合と比べてはるかに遅くなるプログラムの例としてフィボナッチを書きました．\u003cbr/\u003e\nただ，あまりに差が大きくてなぜそうなるのかがわからなかったので考えてみました．\u003cbr/\u003e\n評価器は最後に載せておきます．\u003cbr/\u003e\n　\u003cbr/\u003e\nフィボナッチの定義は以下の通り，末尾\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003eで書いています．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eb \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecount n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        a\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter b \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eメモ化した場合は\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e10000\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;(time (actual-value input the-global-environment))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e; real   0.190\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e; user   0.190\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e; sys    0.000\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003cspan class=\"synConstant\"\u003e33644764876431783266621612005107543310302148460680063906564769974680081442166662368155595513633734025582065332680836159373734790483865268263040892463056431887354544369559827491606602099884183933864652731300088830269235673613135117579297437854413752130520504347701602264758318906527890855154366159582987279682987510631200575428783453215515103870818298969791613127856265033195487140214287532698187962046936097879900350962302291026368131493195275630227837628441540360584402572114334961180023091208287046088923962328835461505776583271252546093591128203925285393434620904245248929403901706233888991085841065183173360437470737908552631764325733993712871937587746897479926305837065742830161637408969178426378624212835258112820516370298089332099905707920064367426202389783111470054074998459250360633560933883831923386783056136435351892133279732908133732642652633989763922723407882928177953580570993691049175470808931841056146322338217465637321248226383092103297701648054726243842374862411453093812206564914032751086643394517512161526545361333111314042436854805106765843493523836959653428071768775328348234345557366719731392746273629108210679280784718035329131176778924659089938635459327894523777674406192240337638674004021330343297496902028328145933418826817683893072003634795623117103101291953169794607632737589253530772552375943788434504067715555779056450443016640119462580972216729758615026968443146952034614932291105970676243268515992834709891284706740862008587135016260312071903172086094081298321581077282076353186624611278245537208532365305775956430072517744315051539600905168603220349163222640885248852433158051534849622434848299380905070483482449327453732624567755879089187190803662058009594743150052402532709746995318770724376825907419939632265984147498193609285223945039707165443156421328157688908058783183404917434556270520223564846495196112460268313970975069382648706613264507665074611512677522748621598642530711298441182622661057163515069260029861704945425047491378115154139941550671256271197133252763631939606902895650288268608362241082050562430701794976171121233066073310059947366875\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eメモ化していない場合は\u003c/p\u003e\n\n\u003cpre class=\"code\" data-lang=\"\" data-unlink\u003e;;; M-Eval input:\n(fib 30)\n;(time (actual-value input the-global-environment))\n; real   6.628\n; user   6.620\n; sys    0.010\n\n;;; M-Eval value:\n832040\u003c/pre\u003e\n\n\n\u003cp\u003eメモ化していない場合になぜこれだけ遅いかを検証します．\u003cbr/\u003e\n(\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iter\"\u003eiter\u003c/a\u003e 0 1 30)から考えます．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    a\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter b \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eなのでまずa b countはそれぞれ(thunk 0) (thunk 1) (thunk 30)となります．\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eなのでpredicateが評価され，countは30となります．\u003cbr/\u003e\n次の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iter\"\u003eiter\u003c/a\u003eが呼ばれます．この時のa b countは(thunk 1) (thunk (+ (thunk 0) (thunk 1))) (thunk (- 30 1))です．\u003cbr/\u003e\nこれがcountが0になるまで続けられます．\u003cbr/\u003e\ncountが0になるとifのconsequentが評価されます．\u003cbr/\u003e\nここで初めてaが評価されることになります．\u003cbr/\u003e\nこの時にはaには二つ上のthunkとさらに一つ上のthunkを足したものが\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003e的になったthunkが入っています．\u003cbr/\u003e\nbには一つ上のthunkとさらに一つ上のthunkを足したものが\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003e的になったthunkが入っています．\u003cbr/\u003e\nつまり，(+ (fib (- n 1)) (fib (- n 2)))を計算するのと同じような計算が必要になります．\u003cbr/\u003e\nメモ化していない場合はこれらをすべて計算していくことになります．\u003cbr/\u003e\nメモ化している場合はそれぞれの階層の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iter\"\u003eiter\u003c/a\u003eの環境にbindされている手続きがevaluated-thunkと値に置き換えられていくので無駄な計算が生じません．\u003cbr/\u003e\n遅延評価だと引数は必要になるまで評価されないので末尾\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003eで書いてもメモ化しない場合はあまり効率的にはなりません．\u003c/p\u003e\n\n\u003cp\u003e[評価器]\u003c/p\u003e\n\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e true \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e false \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etext-of-quotation \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u0026gt;combination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u0026gt;nested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u0026gt;let \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;letrecを追加\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u0026gt;if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                   env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synComment\"\u003e;; (my-apply (eval (operator exp) env)\u003c/span\u003e\n         \u003cspan class=\"synComment\"\u003e;;           (list-of-values (operands exp) env))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown expression type --EVAL\u0026quot;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; メモ化する評価器\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ethunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eresult \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-exp obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-env obj\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e obj \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eevaluated-thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;expをその値で置き換える\u003c/span\u003e\n           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;;必要のなくなったenvを忘れる\u003c/span\u003e\n           result\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eevaluated-thunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-value obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; メモ化しない評価器\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; (define (force-it obj)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;   (if (thunk? obj)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;       (actual-value (thunk-exp obj) (thunk-env obj))\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;;       obj))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edelay-it \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ethunk \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ethunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-exp thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-env thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eevaluated-thunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? obj \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eevaluated-thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-value evaluated-thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e evaluated-thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efoo bar\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebar \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; apply\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply procedure arguments env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprimitive-procedure? procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-primitive-procedure\n          procedure\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values arguments env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e; changed\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompound-procedure? procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args arguments env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e; changed\u003c/span\u003e\n                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-environment procedure\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unknown procedure type: APPLY\u0026quot;\u003c/span\u003e procedure\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edelay-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elast-exp? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-exps exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 代入\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-variable-value! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                       env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 定義\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable!\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 自己評価式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003estring?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 変数\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; クオート\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003equote\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etext-of-quotation \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e tag\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e tag\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      false\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 代入\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset!\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 定義\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edefine\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;仮パラメタ\u003c/span\u003e\n                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;本体\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; lambda式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda parameters body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-body-list proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                               body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                      def\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; ((define u e1) (define v e2) e3 e4)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e;; =\u0026gt; ((let ((u *unassigned*) (v *unassigned*)) (set! u e1) (set! v e2) e3 e4))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-def-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                 body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                        def\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet*\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edef-body-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-def-body body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e def-body-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e def-body-list\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        body\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                         def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                                 def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                            body-list\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; if\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eif\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-if predicate consequent alternative\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eif predicate consequent alternative\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; begin\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebegin\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elast-exp? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-exps seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u0026gt;exp seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elast-exp? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin seq\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebegin seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; 任意の合成式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 派生式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003econd\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-else-clause? clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eelse\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clause\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clause\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u0026gt;if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-else-clause? first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u0026gt;exp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions first\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;ELSE clause isn't last -- COND-\u0026gt;IF\u0026quot;\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eaction \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions first\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epredicate \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate first\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-if predicate\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e action\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=\u0026gt;\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e action\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e predicate\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u0026gt;exp action\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses rest\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; and\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eand\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eclauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; or\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eor\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eclauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; let\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u0026gt;combination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; 2番目の要素がシンボルならnamed-let\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-\u0026gt;define \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-func-name \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; let*\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet*\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let parameters bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters bodys\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u0026gt;nested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets parameters bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;EXPAND-LETS required pair, but \u0026quot;\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                   bodys\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e bodys\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e;; named-let\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-func-name \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition variable value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edefine variable value\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-\u0026gt;define func-name variables expressions bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition func-name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda variables bodys\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e func-name expressions\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 術後のテスト\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efalse? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 手続きの表現\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure parameters body env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure parameters \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-procedure? p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-environment p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 環境に対する操作\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e the-empty-environment \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; フレーム\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-frame variables \u003cspan class=\"synIdentifier\"\u003evalues\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e variables \u003cspan class=\"synIdentifier\"\u003evalues\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-binding-to-frame! var val frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 変数を値に対応づける新しいフレーム\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment vars vals base-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-frame vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e base-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Too many arguments supplied\u0026quot;\u003c/span\u003e vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Too few arguments supplied\u0026quot;\u003c/span\u003e vars vals\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value var env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;*Unassigned* variable\u0026quot;\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e env the-empty-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unbound variable\u0026quot;\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-variable-value! var val env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e vals val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e env the-empty-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\u0026quot;Unbound variable -- SET!\u0026quot;\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! var val env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-binding-to-frame! var val frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e vals val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure? proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? proc \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-implementation proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e primitive-procedures\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecar \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecdr \u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003econs \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enull? \u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e= \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e- \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e/ \u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-names\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e primitive-procedures\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-objects\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e proc\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n       primitive-procedures\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-primitive-procedure proc args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-in-underlying-scheme\n   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-implementation proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e apply-in-underlying-scheme \u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; 環境\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einitial-env\n         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-names\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-objects\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                             the-empty-environment\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e initial-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e initial-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n    initial-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e the-global-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e input-prompt \u003cspan class=\"synConstant\"\u003e\u0026quot;;;; M-Eval input:\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e output-prompt \u003cspan class=\"synConstant\"\u003e\u0026quot;;;; M-Eval value:\u0026quot;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprompt-for-input input-prompt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einput \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eread\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eoutput \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etime \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value input the-global-environment\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; test用にtimeマクロを入れている\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eannounce-output output-prompt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print output\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprompt-for-input \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eannounce-output \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-procedure? object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompound-procedure\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                     \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026lt;procedure-env\u0026gt;\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e object\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e;; lambda式\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda parameters body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-body-list proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                                               body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                      def\n                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eletrec\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\n\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u0026gt;let \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! x y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/pre\u003e\n\n\n","slug":"遅延評価と末尾再帰フィボナッチ"},"content":"\u003cp\u003e前回の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SICP\"\u003eSICP\u003c/a\u003e問題4.29で遅延評価する評価器でメモ化しない場合に，する場合と比べてはるかに遅くなるプログラムの例としてフィボナッチを書きました．\u003cbr\u003e\nただ，あまりに差が大きくてなぜそうなるのかがわからなかったので考えてみました．\u003cbr\u003e\n評価器は最後に載せておきます．\u003cbr\u003e\n　\u003cbr\u003e\nフィボナッチの定義は以下の通り，末尾\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003eで書いています．\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib n\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ea \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eb \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecount n\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        a\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter b \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eメモ化した場合は\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval input:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efib \u003cspan class=\"synConstant\"\u003e10000\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;(time (actual-value input the-global-environment))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e; real   0.190\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e; user   0.190\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e; sys    0.000\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;; M-Eval value:\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synConstant\"\u003e33644764876431783266621612005107543310302148460680063906564769974680081442166662368155595513633734025582065332680836159373734790483865268263040892463056431887354544369559827491606602099884183933864652731300088830269235673613135117579297437854413752130520504347701602264758318906527890855154366159582987279682987510631200575428783453215515103870818298969791613127856265033195487140214287532698187962046936097879900350962302291026368131493195275630227837628441540360584402572114334961180023091208287046088923962328835461505776583271252546093591128203925285393434620904245248929403901706233888991085841065183173360437470737908552631764325733993712871937587746897479926305837065742830161637408969178426378624212835258112820516370298089332099905707920064367426202389783111470054074998459250360633560933883831923386783056136435351892133279732908133732642652633989763922723407882928177953580570993691049175470808931841056146322338217465637321248226383092103297701648054726243842374862411453093812206564914032751086643394517512161526545361333111314042436854805106765843493523836959653428071768775328348234345557366719731392746273629108210679280784718035329131176778924659089938635459327894523777674406192240337638674004021330343297496902028328145933418826817683893072003634795623117103101291953169794607632737589253530772552375943788434504067715555779056450443016640119462580972216729758615026968443146952034614932291105970676243268515992834709891284706740862008587135016260312071903172086094081298321581077282076353186624611278245537208532365305775956430072517744315051539600905168603220349163222640885248852433158051534849622434848299380905070483482449327453732624567755879089187190803662058009594743150052402532709746995318770724376825907419939632265984147498193609285223945039707165443156421328157688908058783183404917434556270520223564846495196112460268313970975069382648706613264507665074611512677522748621598642530711298441182622661057163515069260029861704945425047491378115154139941550671256271197133252763631939606902895650288268608362241082050562430701794976171121233066073310059947366875\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eメモ化していない場合は\u003c/p\u003e\n\u003cpre class=\"code\" data-lang=\"\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e;;; M-Eval input:\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e(fib 30)\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e;(time (actual-value input the-global-environment))\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e; real   6.628\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e; user   6.620\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e; sys    0.010\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e;;; M-Eval value:\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e832040\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eメモ化していない場合になぜこれだけ遅いかを検証します．\u003cbr\u003e\n(\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iter\"\u003eiter\u003c/a\u003e 0 1 30)から考えます．\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    a\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter b \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e a b\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e count \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eなのでまずa b countはそれぞれ(thunk 0) (thunk 1) (thunk 30)となります．\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eなのでpredicateが評価され，countは30となります．\u003cbr\u003e\n次の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iter\"\u003eiter\u003c/a\u003eが呼ばれます．この時のa b countは(thunk 1) (thunk (+ (thunk 0) (thunk 1))) (thunk (- 30 1))です．\u003cbr\u003e\nこれがcountが0になるまで続けられます．\u003cbr\u003e\ncountが0になるとifのconsequentが評価されます．\u003cbr\u003e\nここで初めてaが評価されることになります．\u003cbr\u003e\nこの時にはaには二つ上のthunkとさらに一つ上のthunkを足したものが\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003e的になったthunkが入っています．\u003cbr\u003e\nbには一つ上のthunkとさらに一つ上のthunkを足したものが\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003e的になったthunkが入っています．\u003cbr\u003e\nつまり，(+ (fib (- n 1)) (fib (- n 2)))を計算するのと同じような計算が必要になります．\u003cbr\u003e\nメモ化していない場合はこれらをすべて計算していくことになります．\u003cbr\u003e\nメモ化している場合はそれぞれの階層の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/iter\"\u003eiter\u003c/a\u003eの環境にbindされている手続きがevaluated-thunkと値に置き換えられていくので無駄な計算が生じません．\u003cbr\u003e\n遅延評価だと引数は必要になるまで評価されないので末尾\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BA%C6%B5%A2\"\u003e再帰\u003c/a\u003eで書いてもメモ化しない場合はあまり効率的にはなりません．\u003c/p\u003e\n\u003cp\u003e[評価器]\u003c/p\u003e\n\u003cpre class=\"code lang-scheme\" data-lang=\"scheme\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e true \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e false \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etext-of-quotation \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u003ecombination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u003enested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u003elet \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;letrecを追加\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u003eif \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synComment\"\u003e;; (my-apply (eval (operator exp) env)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synComment\"\u003e;;           (list-of-values (operands exp) env))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unknown expression type --EVAL\"\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; メモ化する評価器\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ethunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eresult \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-exp obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-env obj\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e obj \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eevaluated-thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e result\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;expをその値で置き換える\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e    \u003cspan class=\"synComment\"\u003e;;必要のなくなったenvを忘れる\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           result\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eevaluated-thunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-value obj\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e obj\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; メモ化しない評価器\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; (define (force-it obj)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;   (if (thunk? obj)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;       (actual-value (thunk-exp obj) (thunk-env obj))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;;       obj))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edelay-it \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ethunk \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ethunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-exp thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-env thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eevaluated-thunk? obj\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? obj \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eevaluated-thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ethunk-value evaluated-thunk\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e evaluated-thunk\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eforce-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efoo bar\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebar \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ea\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; apply\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emy-apply procedure arguments env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eprimitive-procedure? procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-primitive-procedure\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          procedure\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values arguments env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e; changed\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003ecompound-procedure? procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters procedure\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args arguments env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e; changed\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-environment procedure\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unknown procedure type: APPLY\"\u003c/span\u003e procedure\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-arg-values \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e'()\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edelay-it \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elist-of-delayed-args \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-if \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence exps env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elast-exp? exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-sequence \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-exps exps\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 代入\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-assignment \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-variable-value! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                       env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 定義\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-definition \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable!\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eok\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 自己評価式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eself-evaluating? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enumber?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003estring?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e true\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e false\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 変数\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003evariable? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; クオート\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003equoted? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003equote\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etext-of-quotation \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e tag\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e tag\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      false\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 代入\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset!\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eassignment-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 定義\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edefine\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;仮パラメタ\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;;本体\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; lambda式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda parameters body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-body-list proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                               body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                      def\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; ((define u e1) (define v e2) e3 e4)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; =\u003e ((let ((u *unassigned*) (v *unassigned*)) (set! u e1) (set! v e2) e3 e4))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-def-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                                 body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        def\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet*\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edef-body-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esplit-def-body body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e def-body-list\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody-list \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e def-body-list\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        body\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-variable x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                                   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefinition-value x\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                 def-list\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                            body-list\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; if\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eif\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-predicate \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-consequent \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eif-alternative \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-if predicate consequent alternative\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eif predicate consequent alternative\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; begin\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebegin\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebegin-actions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elast-exp? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-exps seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u003eexp seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003elast-exp? seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-exp seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin seq\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin seq\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ebegin seq\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 任意の合成式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapplication? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003epair?\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperator \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eoperands \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eno-operands? ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-operand ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest-operands ops\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e ops\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 派生式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003econd\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-else-clause? clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eelse\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clause\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions clause\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clause\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-\u003eif \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003erest \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-else-clause? first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e rest\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u003eexp \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions first\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"ELSE clause isn't last -- COND-\u003eIF\"\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eaction \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-actions first\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003epredicate \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003econd-predicate first\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e              \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-if predicate\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e action\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e=\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e action\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e predicate\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                           \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esequence-\u003eexp action\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                       \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-clauses rest\u003cspan class=\"synSpecial\"\u003e)))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; and\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eand\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-and \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eclauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eand-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; or\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eor\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eeval-or \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eclauses \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eor-clauses \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeval\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e first\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e clauses\u003cspan class=\"synSpecial\"\u003e))))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; let\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-\u003ecombination \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; 2番目の要素がシンボルならnamed-let\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-\u003edefine \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-func-name \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; let*\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet*\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let parameters bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elet \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters bodys\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet*-\u003enested-lets \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elet-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets parameters bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"EXPAND-LETS required pair, but \"\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   bodys\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eexpand-lets \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e parameters\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e bodys\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; named-let\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003esymbol?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-func-name \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-bodys \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition variable value\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003edefine variable value\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003enamed-let-\u003edefine func-name variables expressions bodys\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-begin \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-definition func-name \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda variables bodys\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e func-name expressions\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 術後のテスト\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etrue? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enot\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efalse? x\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 手続きの表現\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-procedure parameters body env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure parameters \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan-out-defines body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-procedure? p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? p \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprocedure\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecaddr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-environment p\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadddr\u003c/span\u003e p\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 環境に対する操作\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e the-empty-environment \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; フレーム\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-frame variables \u003cspan class=\"synIdentifier\"\u003evalues\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e variables \u003cspan class=\"synIdentifier\"\u003evalues\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-binding-to-frame! var val frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-cdr!\u003c/span\u003e frame \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e val \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 変数を値に対応づける新しいフレーム\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment vars vals base-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-frame vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e base-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elength\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Too many arguments supplied\"\u003c/span\u003e vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Too few arguments supplied\"\u003c/span\u003e vars vals\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elookup-variable-value var env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"*Unassigned* variable\"\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e env the-empty-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unbound variable\"\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eset-variable-value! var val env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenclosing-environment env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e vals val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e env the-empty-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eerror \u003cspan class=\"synConstant\"\u003e\"Unbound variable -- SET!\"\u003c/span\u003e var\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eenv-loop env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! var val env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eframe \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003efirst-frame env\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan vars vals\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eadd-binding-to-frame! var val frame\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eeq?\u003c/span\u003e var \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eset-car!\u003c/span\u003e vals val\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vars\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e vals\u003cspan class=\"synSpecial\"\u003e)))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003escan \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-variables frame\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eframe-values frame\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure? proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? proc \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-implementation proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e proc\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e primitive-procedures\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecar \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecdr \u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003econs \u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003enull? \u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e= \u003cspan class=\"synIdentifier\"\u003e=\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e- \u003cspan class=\"synIdentifier\"\u003e-\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e+ \u003cspan class=\"synIdentifier\"\u003e+\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e* \u003cspan class=\"synIdentifier\"\u003e*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e        \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e/ \u003cspan class=\"synIdentifier\"\u003e/\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-names\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e primitive-procedures\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-objects\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eproc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eprimitive \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e proc\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       primitive-procedures\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-primitive-procedure proc args\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eapply-in-underlying-scheme\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e   \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-implementation proc\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e args\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e apply-in-underlying-scheme \u003cspan class=\"synIdentifier\"\u003eapply\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; 環境\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einitial-env\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eextend-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-names\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprimitive-procedure-objects\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             the-empty-environment\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003etrue \u003cspan class=\"synConstant\"\u003e#t\u003c/span\u003e initial-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edefine-variable! \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003efalse \u003cspan class=\"synConstant\"\u003e#f\u003c/span\u003e initial-env\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    initial-env\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e the-global-environment \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003esetup-environment\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e input-prompt \u003cspan class=\"synConstant\"\u003e\";;; M-Eval input:\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e output-prompt \u003cspan class=\"synConstant\"\u003e\";;; M-Eval value:\"\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprompt-for-input input-prompt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003einput \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eread\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eoutput \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etime \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eactual-value input the-global-environment\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e \u003cspan class=\"synComment\"\u003e;; test用にtimeマクロを入れている\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eannounce-output output-prompt\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print output\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edriver-loop\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprompt-for-input \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eannounce-output \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003estring\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enewline\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003euser-print object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ecompound-procedure? object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003ecompound-procedure\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-parameters object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eprocedure-body object\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                     \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026#x3C;procedure-env\u003e\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003edisplay\u003c/span\u003e object\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e;; lambda式\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003elambda-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-lambda parameters body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003elambda \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e parameters body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef-body-list proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e iter \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003eproc-body proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003edef \u003cspan class=\"synSpecial\"\u003e'())\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e             \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ebody \u003cspan class=\"synSpecial\"\u003e'()))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003econd\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003enull?\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ereverse\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e((\u003c/span\u003edefinition? \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                               \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e def\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                               body\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e          \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eiter \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecdr\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                      def\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                      \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003econs\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e proc-body\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e body\u003cspan class=\"synSpecial\"\u003e))))))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003etagged-list? \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eletrec\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecar\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003ecadr\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-parameters \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003ecddr\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003edefine\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-\u003elet \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003emake-let \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e x \u003cspan class=\"synSpecial\"\u003e''\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e*unassigned*\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                 \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e            \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003eappend\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003emap\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003elambda\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003ex y\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003elist\u003c/span\u003e \u003cspan class=\"synSpecial\"\u003e'\u003c/span\u003eset! x y\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-variables \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-expressions \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                    \u003cspan class=\"synSpecial\"\u003e(\u003c/span\u003eletrec-body \u003cspan class=\"synIdentifier\"\u003eexp\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e))))\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"遅延評価と末尾再帰フィボナッチ"},"buildId":"Vkket-G7K8unr3JM8zyxA","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>