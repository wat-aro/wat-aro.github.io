<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>プログラミングの基礎　16.4 最初の完動プログラム | (wat-aro)</title><meta name="title" content="プログラミングの基礎　16.4 最初の完動プログラム | (wat-aro)"/><meta name="description" content="&lt;p&gt;プログラミングの基礎で作ったメトロネットワーク最短路問題の解答．&lt;br/&gt;&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AF%A5%B9%A5%C8%A5%E9&quot;&gt;ダイクストラ&lt;/a&gt;法を使い求める．&lt;br/&gt;ここまで"/><meta property="og:locale" content="ja_jp"/><meta property="og:type" content="article"/><meta property="og:site_name" content="(wat-aro)"/><meta property="og:title" content="プログラミングの基礎　16.4 最初の完動プログラム | (wat-aro)"/><meta property="og:image" content="https://wat-aro.dev/og-images/プログラミングの基礎　16.4 最初の完動プログラム.png"/><meta property="og:url" content="https://wat-aro.dev/posts/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%AE%E5%9F%BA%E7%A4%8E%E3%80%8016.4%20%E6%9C%80%E5%88%9D%E3%81%AE%E5%AE%8C%E5%8B%95%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@wat_aro"/><meta name="twitter:creator" content="@wat_aro"/><meta name="twitter:title" content="プログラミングの基礎　16.4 最初の完動プログラム | (wat-aro)"/><meta name="twitter:description" content="&lt;p&gt;プログラミングの基礎で作ったメトロネットワーク最短路問題の解答．&lt;br/&gt;&lt;a class=&quot;keyword&quot; href=&quot;http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AF%A5%B9%A5%C8%A5%E9&quot;&gt;ダイクストラ&lt;/a&gt;法を使い求める．&lt;br/&gt;ここまで"/><meta name="twitter:image" content="https://wat-aro.dev/og-images/プログラミングの基礎　16.4 最初の完動プログラム.png"/><meta name="next-head-count" content="17"/><link rel="icon" href="/images/favicon.ico"/><link rel="preload" href="/_next/static/css/efce62830f77489e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/efce62830f77489e.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-fc7d2f0e2098927e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d19aa426007499ce.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-0e1c4012a86ba0a9.js" defer=""></script><script src="/_next/static/7e9MaWZtiSJfq25LIpmjp/_buildManifest.js" defer=""></script><script src="/_next/static/7e9MaWZtiSJfq25LIpmjp/_ssgManifest.js" defer=""></script><script src="/_next/static/7e9MaWZtiSJfq25LIpmjp/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW6D56L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="py-0 md:px-8 min-h-screen flex flex-col items-center"><div class="top-0 bg-white w-full h-16 flex flex-row justify-between items-center px-4 border-b-2"><a href="/"><div class="flex items-center font-midium text-3xl h-full font-bold gap-4"><img class="rounded-full" src="/images/profile.jpg" width="48" height="48" alt="profile image"/>(wat-aro)<!-- --></div></a><ul class="flex gap-3 h-full"><li class="h-full  flex flex-col justify-end border-black pb-4"><a href="/about">About</a></li><li class="h-full  flex flex-col justify-end border-black pb-3 border-b-4"><a href="/posts">Blog</a></li></ul></div><div class="flex md:justify-center justify-between w-full"><div class="flex flex-col sm:max-w-sm md:max-w-4xl w-full py-4 px-4"><article class="flex max-w-4xl w-full"><div class="py-4 w-full"><div class="mr-2 text-xs font-bold">2016/02/16</div><h1 class="font-bold text-3xl text-black">プログラミングの基礎　16.4 最初の完動プログラム</h1><nav class="flex mt-2 mb-2 items-start text-gray-500 text-xs"><div class="flex flex-nowrap max-w-full overflow-x-auto"><p class="mr-1 rounded-full px-2 py-1 border leading-none">OCaml</p><p class="mr-1 rounded-full px-2 py-1 border leading-none">プログラミングの基礎</p></div></nav><div class="znc"><p>プログラミングの基礎で作ったメトロネットワーク最短路問題の解答．<br>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AF%A5%B9%A5%C8%A5%E9">ダイクストラ</a>法を使い求める．<br>
ここまでのメトロネットワーク最短路問題に関係する問題の解答すべてここに書いてある．</p>
<pre class="code lang-ocaml" data-lang="ocaml" data-unlink=""><code class="code-highlight"><span class="code-line"><span class="synComment">(* サポートページからダウンロードしたglobal_ekimei_listとglobal_ekikan_list *)</span>
</span><span class="code-line"><span class="synPreProc">#use</span> <span class="synConstant">"metro.ml"</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：ekimei_t型のデータを受け取り，「路線名，駅名（かな）」を返す *)</span>
</span><span class="code-line"><span class="synComment">(* hyoji : ekimei_t -> string *)</span>
</span><span class="code-line"><span class="synStatement">let</span> hyoji ekimei <span class="synStatement">=</span> <span class="synStatement">match</span> ekimei <span class="synStatement">with</span>
</span><span class="code-line">    <span class="synStatement">{</span>kanji <span class="synStatement">=</span> kanji<span class="synStatement">;</span>
</span><span class="code-line">     kana <span class="synStatement">=</span> kana<span class="synStatement">;</span>
</span><span class="code-line">     romaji <span class="synStatement">=</span> romaji<span class="synStatement">;</span>
</span><span class="code-line">     shozoku <span class="synStatement">=</span> shozoku<span class="synStatement">;}</span>
</span><span class="code-line">    <span class="synStatement">-></span> shozoku <span class="synStatement">^</span> <span class="synConstant">"，"</span> <span class="synStatement">^</span> kanji <span class="synStatement">^</span> <span class="synConstant">"（"</span> <span class="synStatement">^</span> kana <span class="synStatement">^</span> <span class="synConstant">"）"</span><span class="synStatement">;;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* hyoji test *)</span>
</span><span class="code-line">print_string <span class="synConstant">"hyouji test"</span>
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> hyoji <span class="synStatement">{</span>kanji <span class="synStatement">=</span> <span class="synConstant">"茗荷谷"</span><span class="synStatement">;</span> kana <span class="synStatement">=</span> <span class="synConstant">"みょうがだに"</span><span class="synStatement">;</span>
</span><span class="code-line">                   romaji <span class="synStatement">=</span> <span class="synConstant">"myogadani"</span><span class="synStatement">;</span> shozoku <span class="synStatement">=</span> <span class="synConstant">"丸ノ内線"</span><span class="synStatement">}</span>
</span><span class="code-line">  <span class="synStatement">=</span> <span class="synConstant">"丸ノ内線，茗荷谷（みょうがだに）"</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：ローマ字の駅名（文字列）と駅名リスト(ekimei_t list 型)を受け取り</span>
</span><span class="code-line"><span class="synComment">   園駅の漢字表記を返す *)</span>
</span><span class="code-line"><span class="synComment">(* romaji_to_kanji -> string -> ekimei_t list -> string *)</span>
</span><span class="code-line"><span class="synStatement">let</span> <span class="synStatement">rec</span> romaji_to_kanji name lst <span class="synStatement">=</span> <span class="synStatement">match</span> lst <span class="synStatement">with</span>
</span><span class="code-line">    <span class="synConstant">[]</span> <span class="synStatement">-></span> <span class="synConstant">""</span>
</span><span class="code-line">  <span class="synStatement">|</span> <span class="synStatement">{</span>kanji <span class="synStatement">=</span> kanji<span class="synStatement">;</span> kana <span class="synStatement">=</span> kana<span class="synStatement">;</span> romaji <span class="synStatement">=</span> romaji<span class="synStatement">;</span> shozoku <span class="synStatement">=</span> shozoku<span class="synStatement">}</span> <span class="synStatement">::</span> rest <span class="synStatement">-></span>
</span><span class="code-line">     <span class="synStatement">if</span> name <span class="synStatement">=</span> romaji
</span><span class="code-line">     <span class="synStatement">then</span> kanji
</span><span class="code-line">     <span class="synStatement">else</span> romaji_to_kanji name rest
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* romaji_to_kanji test *)</span>
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> romaji_to_kanji <span class="synConstant">""</span> <span class="synConstant">[]</span> <span class="synStatement">=</span> <span class="synConstant">""</span>
</span><span class="code-line"><span class="synStatement">let</span> test2 <span class="synStatement">=</span> romaji_to_kanji <span class="synConstant">""</span> global_ekimei_list <span class="synStatement">=</span> <span class="synConstant">""</span>
</span><span class="code-line"><span class="synStatement">let</span> test3 <span class="synStatement">=</span> romaji_to_kanji <span class="synConstant">"myogadani"</span> <span class="synConstant">[]</span> <span class="synStatement">=</span> <span class="synConstant">""</span>
</span><span class="code-line"><span class="synStatement">let</span> test4 <span class="synStatement">=</span> romaji_to_kanji <span class="synConstant">"myogadani"</span> global_ekimei_list <span class="synStatement">=</span> <span class="synConstant">"茗荷谷"</span>
</span><span class="code-line"><span class="synStatement">let</span> test5 <span class="synStatement">=</span> romaji_to_kanji <span class="synConstant">"aoyamaicchome"</span> global_ekimei_list <span class="synStatement">=</span> <span class="synConstant">"青山一丁目"</span>
</span><span class="code-line"><span class="synStatement">let</span> test6 <span class="synStatement">=</span> romaji_to_kanji <span class="synConstant">"heiwadai"</span> global_ekimei_list <span class="synStatement">=</span> <span class="synConstant">"平和台"</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：漢字の駅名を２つと駅間リストを受け取ったら，駅間リストの中からその２駅間の距離を返す *)</span>
</span><span class="code-line"><span class="synComment">(* get_ekikan_kyori : string -> string -> ekikan_t list -> float *)</span>
</span><span class="code-line"><span class="synStatement">let</span> <span class="synStatement">rec</span> get_ekikan_kyori eki1 eki2 lst <span class="synStatement">=</span> <span class="synStatement">match</span> lst <span class="synStatement">with</span>
</span><span class="code-line">    <span class="synConstant">[]</span> <span class="synStatement">-></span> infinity
</span><span class="code-line">  <span class="synStatement">|</span> <span class="synStatement">{</span>kiten <span class="synStatement">=</span> kiten<span class="synStatement">;</span> shuten <span class="synStatement">=</span> shuten<span class="synStatement">;</span> keiyu <span class="synStatement">=</span> keiyu<span class="synStatement">;</span> kyori <span class="synStatement">=</span> kyori<span class="synStatement">;</span> jikan <span class="synStatement">=</span> jikan<span class="synStatement">}</span> <span class="synStatement">::</span> rest <span class="synStatement">-></span>
</span><span class="code-line">     <span class="synStatement">if</span> eki1 <span class="synStatement">=</span> kiten <span class="synStatement">&#x26;&#x26;</span> eki2 <span class="synStatement">=</span> shuten
</span><span class="code-line">     <span class="synStatement">then</span> kyori
</span><span class="code-line">     <span class="synStatement">else</span> <span class="synStatement">if</span> eki2 <span class="synStatement">=</span> kiten <span class="synStatement">&#x26;&#x26;</span> eki1 <span class="synStatement">=</span> shuten
</span><span class="code-line">     <span class="synStatement">then</span> kyori
</span><span class="code-line">     <span class="synStatement">else</span> get_ekikan_kyori eki1 eki2 rest
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* get_ekikan_kyori test *)</span>
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> get_ekikan_kyori <span class="synConstant">"錦糸町"</span> <span class="synConstant">"住吉"</span> <span class="synConstant">[]</span> <span class="synStatement">=</span> infinity
</span><span class="code-line"><span class="synStatement">let</span> test2 <span class="synStatement">=</span> get_ekikan_kyori <span class="synConstant">"錦糸町"</span> <span class="synConstant">""</span> global_ekikan_list <span class="synStatement">=</span> infinity
</span><span class="code-line"><span class="synStatement">let</span> test3 <span class="synStatement">=</span> get_ekikan_kyori <span class="synConstant">""</span> <span class="synConstant">"錦糸町"</span> global_ekikan_list <span class="synStatement">=</span> infinity
</span><span class="code-line"><span class="synStatement">let</span> test4 <span class="synStatement">=</span> get_ekikan_kyori <span class="synConstant">"横浜駅"</span> <span class="synConstant">"錦糸町"</span> global_ekikan_list <span class="synStatement">=</span> infinity
</span><span class="code-line"><span class="synStatement">let</span> test5 <span class="synStatement">=</span> get_ekikan_kyori <span class="synConstant">"大手町"</span> <span class="synConstant">"三越前"</span> global_ekikan_list <span class="synStatement">=</span> <span class="synConstant">0.7</span>
</span><span class="code-line"><span class="synStatement">let</span> test6 <span class="synStatement">=</span> get_ekikan_kyori <span class="synConstant">"三越前"</span> <span class="synConstant">"大手町"</span> global_ekikan_list <span class="synStatement">=</span> <span class="synConstant">0.7</span>
</span><span class="code-line"><span class="synStatement">let</span> test7 <span class="synStatement">=</span> get_ekikan_kyori <span class="synConstant">"霞ヶ関"</span> <span class="synConstant">"日比谷"</span> global_ekikan_list <span class="synStatement">=</span> <span class="synConstant">1.2</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：ローマ字の駅名を２つ受け取り，その間の距離を調べ，つながっている場合は</span>
</span><span class="code-line"><span class="synComment">   「A駅からB駅までのはｘｋｍです」と返し，繋がっていない場合は</span>
</span><span class="code-line"><span class="synComment">   「A駅からB駅はつながっていません」と返す*)</span>
</span><span class="code-line"><span class="synStatement">let</span> kyori_wo_hyoji r1 r2 <span class="synStatement">=</span>
</span><span class="code-line">  <span class="synStatement">let</span> k1 <span class="synStatement">=</span> romaji_to_kanji r1 global_ekimei_list <span class="synStatement">in</span>
</span><span class="code-line">  <span class="synStatement">let</span> k2 <span class="synStatement">=</span> romaji_to_kanji r2 global_ekimei_list <span class="synStatement">in</span>
</span><span class="code-line">  <span class="synStatement">let</span> not_exist <span class="synStatement">=</span> <span class="synConstant">"という駅は存在しません"</span> <span class="synStatement">in</span>
</span><span class="code-line">  <span class="synStatement">if</span> k1 <span class="synStatement">=</span> <span class="synConstant">""</span>
</span><span class="code-line">  <span class="synStatement">then</span> r1 <span class="synStatement">^</span> not_exist
</span><span class="code-line">  <span class="synStatement">else</span> <span class="synStatement">if</span> k2 <span class="synStatement">=</span> <span class="synConstant">""</span>
</span><span class="code-line">  <span class="synStatement">then</span> r2 <span class="synStatement">^</span> not_exist
</span><span class="code-line">  <span class="synStatement">else</span> <span class="synStatement">let</span> kyori <span class="synStatement">=</span> get_ekikan_kyori k1 k2 global_ekikan_list <span class="synStatement">in</span>
</span><span class="code-line">       <span class="synStatement">if</span> kyori <span class="synStatement">=</span> infinity
</span><span class="code-line">       <span class="synStatement">then</span> k1 <span class="synStatement">^</span> <span class="synConstant">"駅と"</span> <span class="synStatement">^</span> k2 <span class="synStatement">^</span> <span class="synConstant">"駅はつながっていません"</span>
</span><span class="code-line">       <span class="synStatement">else</span> k1 <span class="synStatement">^</span> <span class="synConstant">"駅から"</span> <span class="synStatement">^</span> k2 <span class="synStatement">^</span> <span class="synConstant">"駅までは"</span> <span class="synStatement">^</span> string_of_float kyori <span class="synStatement">^</span> <span class="synConstant">"kmです"</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* kyori_wo_hyoji test *)</span>
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> kyori_wo_hyoji <span class="synConstant">"otemachi"</span> <span class="synConstant">"hibiya"</span> <span class="synStatement">=</span> <span class="synConstant">"大手町駅と日比谷駅はつながっていません"</span>
</span><span class="code-line"><span class="synStatement">let</span> test2 <span class="synStatement">=</span> kyori_wo_hyoji <span class="synConstant">""</span> <span class="synConstant">"kinsityo"</span>  <span class="synStatement">=</span> <span class="synConstant">"という駅は存在しません"</span>
</span><span class="code-line"><span class="synStatement">let</span> test3 <span class="synStatement">=</span> kyori_wo_hyoji <span class="synConstant">"yokohama"</span> <span class="synConstant">"kinsityo"</span> <span class="synStatement">=</span> <span class="synConstant">"yokohamaという駅は存在しません"</span>
</span><span class="code-line"><span class="synStatement">let</span> test4 <span class="synStatement">=</span> kyori_wo_hyoji <span class="synConstant">"otemachi"</span> <span class="synConstant">"mitsukoshimae"</span> <span class="synStatement">=</span> <span class="synConstant">"大手町駅から三越前駅までは0.7kmです"</span>
</span><span class="code-line"><span class="synStatement">let</span> test5 <span class="synStatement">=</span> kyori_wo_hyoji <span class="synConstant">"mitsukoshimae"</span> <span class="synConstant">"otemachi"</span> <span class="synStatement">=</span> <span class="synConstant">"三越前駅から大手町駅までは0.7kmです"</span>
</span><span class="code-line"><span class="synStatement">let</span> test6 <span class="synStatement">=</span> kyori_wo_hyoji <span class="synConstant">"kasumigaseki"</span> <span class="synConstant">"hibiya"</span> <span class="synStatement">=</span> <span class="synConstant">"霞ヶ関駅から日比谷駅までは1.2kmです"</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synStatement">type</span> eki_t <span class="synStatement">=</span> <span class="synStatement">{</span>
</span><span class="code-line">  namae : <span class="synType">string</span><span class="synStatement">;</span>               <span class="synComment">(* 駅名（漢字の文字列） *)</span>
</span><span class="code-line">  saitan_kyori : <span class="synType">float</span><span class="synStatement">;</span>         <span class="synComment">(* 最短距離（実数） *)</span>
</span><span class="code-line">  temae_list : <span class="synType">string</span> <span class="synType">list</span><span class="synStatement">;</span>     <span class="synComment">(* 駅名（漢字の文字列）のリスト *)</span>
</span><span class="code-line"><span class="synStatement">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：string型の駅名(漢字)とekimei_t list型を受け取り，</span>
</span><span class="code-line"><span class="synComment">   ekimei_t listをeki_t listに変え，その際駅名と一致する駅についてはshokikaする *)</span>
</span><span class="code-line"><span class="synComment">(* make_initial_eki_list : string -> ekimei_t list -> eki_t list *)</span>
</span><span class="code-line"><span class="synStatement">let</span> make_initial_eki_list name lst <span class="synStatement">=</span>
</span><span class="code-line">  <span class="synPreProc">List</span>.map <span class="synStatement">(fun</span> eki <span class="synStatement">-></span> <span class="synStatement">match</span> eki <span class="synStatement">with</span>
</span><span class="code-line">    <span class="synStatement">{</span>kanji <span class="synStatement">=</span> k<span class="synStatement">;</span> kana <span class="synStatement">=</span> a<span class="synStatement">;</span> romaji <span class="synStatement">=</span> r<span class="synStatement">;</span> shozoku <span class="synStatement">=</span> s<span class="synStatement">}</span>
</span><span class="code-line">    <span class="synStatement">-></span> <span class="synStatement">if</span> k <span class="synStatement">=</span> name
</span><span class="code-line">      <span class="synStatement">then</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> k<span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0</span>.<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span>k<span class="synStatement">]}</span>
</span><span class="code-line">      <span class="synStatement">else</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> k<span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">})</span>
</span><span class="code-line">    lst<span class="synStatement">;;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* make_initial_eki_list test *)</span>
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> make_initial_eki_list <span class="synConstant">"代々木上原"</span> <span class="synStatement">[{</span>kanji<span class="synStatement">=</span><span class="synConstant">"代々木上原"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"よよぎうえはら"</span><span class="synStatement">;</span>
</span><span class="code-line">                                                 romaji<span class="synStatement">=</span><span class="synConstant">"yoyogiuehara"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"千代田線"</span><span class="synStatement">}]</span>
</span><span class="code-line">  <span class="synStatement">=</span> <span class="synStatement">[{</span>namae <span class="synStatement">=</span> <span class="synConstant">"代々木上原"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0</span>.<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"代々木上原"</span><span class="synStatement">]}];;</span>
</span><span class="code-line"><span class="synStatement">let</span> test2 <span class="synStatement">=</span> make_initial_eki_list <span class="synConstant">"明治神宮前"</span> <span class="synStatement">[{</span>kanji<span class="synStatement">=</span><span class="synConstant">"代々木公園"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"よよぎこうえん"</span><span class="synStatement">;</span>
</span><span class="code-line">                                                romaji<span class="synStatement">=</span><span class="synConstant">"yoyogikouen"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"千代田線"</span><span class="synStatement">};</span>
</span><span class="code-line">                                               <span class="synStatement">{</span>kanji<span class="synStatement">=</span><span class="synConstant">"明治神宮前"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"めいじじんぐうまえ"</span><span class="synStatement">;</span>
</span><span class="code-line">                                                romaji<span class="synStatement">=</span><span class="synConstant">"meijijinguumae"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"千代田線"</span><span class="synStatement">}]</span>
</span><span class="code-line">  <span class="synStatement">=</span> <span class="synStatement">[{</span>namae <span class="synStatement">=</span> <span class="synConstant">"代々木公園"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"明治神宮前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0</span>.<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"明治神宮前"</span><span class="synStatement">]}];;</span>
</span><span class="code-line"><span class="synStatement">let</span> test3 <span class="synStatement">=</span> make_initial_eki_list <span class="synConstant">"赤坂"</span> <span class="synStatement">[{</span>kanji<span class="synStatement">=</span><span class="synConstant">"表参道"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"おもてさんどう"</span><span class="synStatement">;</span>
</span><span class="code-line">                                           romaji<span class="synStatement">=</span><span class="synConstant">"omotesandou"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"千代田線"</span><span class="synStatement">};</span>
</span><span class="code-line">                                          <span class="synStatement">{</span>kanji<span class="synStatement">=</span><span class="synConstant">"乃木坂"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"のぎざか"</span><span class="synStatement">;</span>
</span><span class="code-line">                                           romaji<span class="synStatement">=</span><span class="synConstant">"nogizaka"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"千代田線"</span><span class="synStatement">};</span>
</span><span class="code-line">                                          <span class="synStatement">{</span>kanji<span class="synStatement">=</span><span class="synConstant">"赤坂"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"あかさか"</span><span class="synStatement">;</span>
</span><span class="code-line">                                           romaji<span class="synStatement">=</span><span class="synConstant">"akasaka"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"千代田線"</span><span class="synStatement">}]</span>
</span><span class="code-line">  <span class="synStatement">=</span> <span class="synStatement">[{</span>namae <span class="synStatement">=</span> <span class="synConstant">"表参道"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"乃木坂"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"赤坂"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0</span>.<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"赤坂"</span><span class="synStatement">]}];;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：ekimei_t型のレコードとekimei_t型のリストを受け取ったら，平仮名の昇順となる位置に</span>
</span><span class="code-line"><span class="synComment">   ekimei_t型のレコードを挿入する．同じ駅がリストにあれば挿入しない．</span>
</span><span class="code-line"><span class="synComment">   seiretsuのための補助関数*)</span>
</span><span class="code-line"><span class="synComment">(* ekimei_isnert : -> ekimei_t -> ekimei_t list -> ekimei_t list *)</span>
</span><span class="code-line"><span class="synStatement">let</span> <span class="synStatement">rec</span> ekimei_insert eki lst <span class="synStatement">=</span> <span class="synStatement">match</span> lst <span class="synStatement">with</span>
</span><span class="code-line">    <span class="synConstant">[]</span> <span class="synStatement">-></span> <span class="synStatement">[</span>eki<span class="synStatement">]</span>
</span><span class="code-line">  <span class="synStatement">|</span> <span class="synStatement">({</span>kanji <span class="synStatement">=</span> kanji<span class="synStatement">;</span> kana <span class="synStatement">=</span> kana<span class="synStatement">;</span> romaji <span class="synStatement">=</span> romaji<span class="synStatement">;</span> shozoku <span class="synStatement">=</span> shozoku<span class="synStatement">;}</span> <span class="synStatement">as</span> first<span class="synStatement">)</span> <span class="synStatement">::</span> rest <span class="synStatement">-></span>
</span><span class="code-line">     <span class="synStatement">if</span> kana <span class="synStatement">=</span> eki.kana
</span><span class="code-line">     <span class="synStatement">then</span> lst                   <span class="synComment">(* リストにあったほうが残る *)</span>
</span><span class="code-line">     <span class="synStatement">else</span> <span class="synStatement">if</span> eki.kana <span class="synStatement">&#x3C;</span> kana    <span class="synComment">(* 駅のkana &#x3C; first のkana *)</span>
</span><span class="code-line">     <span class="synStatement">then</span> eki <span class="synStatement">::</span> lst
</span><span class="code-line">     <span class="synStatement">else</span> first <span class="synStatement">::</span> ekimei_insert eki rest
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* test data *)</span>
</span><span class="code-line"><span class="synStatement">let</span> yoyogiuehara_tiyodasen <span class="synStatement">=</span> <span class="synStatement">{</span>kanji<span class="synStatement">=</span><span class="synConstant">"代々木上原"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"よよぎうえはら"</span><span class="synStatement">;</span>
</span><span class="code-line">                              romaji<span class="synStatement">=</span><span class="synConstant">"yoyogiuehara"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"千代田線"</span><span class="synStatement">}</span>
</span><span class="code-line"><span class="synStatement">let</span> otemachi_tiyodasen <span class="synStatement">=</span> <span class="synStatement">{</span>kanji<span class="synStatement">=</span><span class="synConstant">"大手町"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"おおてまち"</span><span class="synStatement">;</span>
</span><span class="code-line">                         romaji<span class="synStatement">=</span><span class="synConstant">"otemachi"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"千代田線"</span><span class="synStatement">}</span>
</span><span class="code-line"><span class="synStatement">let</span> otemachi_hanzoumonsen <span class="synStatement">=</span> <span class="synStatement">{</span>kanji<span class="synStatement">=</span><span class="synConstant">"大手町"</span><span class="synStatement">;</span> kana<span class="synStatement">=</span><span class="synConstant">"おおてまち"</span><span class="synStatement">;</span>
</span><span class="code-line">                             romaji<span class="synStatement">=</span><span class="synConstant">"otemachi"</span><span class="synStatement">;</span> shozoku<span class="synStatement">=</span><span class="synConstant">"半蔵門線"</span><span class="synStatement">}</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* test *)</span>
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> ekimei_insert otemachi_tiyodasen <span class="synConstant">[]</span> <span class="synStatement">=</span> <span class="synStatement">[</span>otemachi_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line"><span class="synStatement">let</span> test2 <span class="synStatement">=</span> ekimei_insert otemachi_tiyodasen <span class="synStatement">[</span>otemachi_hanzoumonsen<span class="synStatement">]</span> <span class="synStatement">=</span> <span class="synStatement">[</span>otemachi_hanzoumonsen<span class="synStatement">]</span>
</span><span class="code-line"><span class="synStatement">let</span> test3 <span class="synStatement">=</span> ekimei_insert otemachi_tiyodasen <span class="synStatement">[</span>yoyogiuehara_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line">    <span class="synStatement">=</span> <span class="synStatement">[</span>otemachi_tiyodasen<span class="synStatement">;</span> yoyogiuehara_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line"><span class="synStatement">let</span> test4 <span class="synStatement">=</span> ekimei_insert yoyogiuehara_tiyodasen <span class="synStatement">[</span>otemachi_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line">    <span class="synStatement">=</span> <span class="synStatement">[</span>otemachi_tiyodasen<span class="synStatement">;</span> yoyogiuehara_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：ekimei_t型のリストを受け取ったら，それを平仮名の順に整列し，</span>
</span><span class="code-line"><span class="synComment">   さらに駅の重複を取り除いたekimei_t型のリストを返す *)</span>
</span><span class="code-line"><span class="synComment">(* seiretsu : ekimei_t -> ekimei_t *)</span>
</span><span class="code-line"><span class="synStatement">let</span> <span class="synStatement">rec</span> seiretsu lst <span class="synStatement">=</span> <span class="synStatement">match</span> lst <span class="synStatement">with</span>
</span><span class="code-line">    <span class="synConstant">[]</span> <span class="synStatement">-></span> <span class="synConstant">[]</span>
</span><span class="code-line">  <span class="synStatement">|</span> first <span class="synStatement">::</span> rest <span class="synStatement">-></span> ekimei_insert first <span class="synStatement">(</span>seiretsu rest<span class="synStatement">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> seiretsu <span class="synConstant">[]</span> <span class="synStatement">=</span> <span class="synConstant">[]</span>
</span><span class="code-line"><span class="synStatement">let</span> test2 <span class="synStatement">=</span> <span class="synStatement">[</span>yoyogiuehara_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line">  <span class="synStatement">=</span> <span class="synStatement">[</span>yoyogiuehara_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line"><span class="synStatement">let</span> test3 <span class="synStatement">=</span> seiretsu <span class="synStatement">[</span>otemachi_tiyodasen<span class="synStatement">;</span> otemachi_hanzoumonsen<span class="synStatement">]</span>
</span><span class="code-line">  <span class="synStatement">=</span> <span class="synStatement">[</span>otemachi_hanzoumonsen<span class="synStatement">]</span>
</span><span class="code-line"><span class="synStatement">let</span> test4 <span class="synStatement">=</span> seiretsu <span class="synStatement">[</span>otemachi_tiyodasen<span class="synStatement">;</span> otemachi_hanzoumonsen<span class="synStatement">;</span> yoyogiuehara_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line">  <span class="synStatement">=</span> <span class="synStatement">[</span>otemachi_hanzoumonsen<span class="synStatement">;</span> yoyogiuehara_tiyodasen<span class="synStatement">]</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synStatement">let</span> otemachi <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"大手町"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0</span>.<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"大手町"</span><span class="synStatement">]}</span>
</span><span class="code-line"><span class="synStatement">let</span> mitsukoshimae <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line"><span class="synStatement">let</span> shibuya <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"渋谷"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line"><span class="synStatement">let</span> aoyamaichome <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"青山一丁目"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：直前に確定した駅 p (eki_t型)と味覚手の役のリスト v (eki_t list型)を受け取り</span>
</span><span class="code-line"><span class="synComment">   必要な更新処理を行った後の未確定の駅のリストを返す*)</span>
</span><span class="code-line"><span class="synComment">(* koushin -> eki_t -> eki_t list -> ekikan_t list -> eki_t list *)</span>
</span><span class="code-line"><span class="synStatement">let</span> koushin p v ekikan <span class="synStatement">=</span>
</span><span class="code-line">  <span class="synPreProc">List</span>.map
</span><span class="code-line">    <span class="synStatement">(fun</span> q <span class="synStatement">-></span>
</span><span class="code-line">      <span class="synStatement">let</span> kyori <span class="synStatement">=</span> get_ekikan_kyori p.namae q.namae ekikan <span class="synStatement">in</span>
</span><span class="code-line">      <span class="synStatement">if</span> kyori <span class="synStatement">=</span> infinity
</span><span class="code-line">      <span class="synStatement">then</span> q
</span><span class="code-line">      <span class="synStatement">else</span> <span class="synStatement">let</span> p_keiyu_q_kyori <span class="synStatement">=</span> p.saitan_kyori +. kyori <span class="synStatement">in</span>
</span><span class="code-line">           <span class="synStatement">if</span>  p_keiyu_q_kyori  <span class="synStatement">&#x3C;</span> q.saitan_kyori
</span><span class="code-line">           <span class="synStatement">then</span> <span class="synStatement">{</span> namae <span class="synStatement">=</span> q.namae<span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> p_keiyu_q_kyori<span class="synStatement">;</span>
</span><span class="code-line">                  temae_list <span class="synStatement">=(</span>q.namae<span class="synStatement">)</span> <span class="synStatement">::</span> p.temae_list<span class="synStatement">}</span>
</span><span class="code-line">           <span class="synStatement">else</span> q<span class="synStatement">)</span>
</span><span class="code-line">    v<span class="synStatement">;;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* test data *)</span>
</span><span class="code-line"><span class="synStatement">let</span> otemachi <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"大手町"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0</span>.<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"大手町"</span><span class="synStatement">]}</span>
</span><span class="code-line"><span class="synStatement">let</span> mitsukoshimae <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line"><span class="synStatement">let</span> shibuya <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"渋谷"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line"><span class="synStatement">let</span> aoyamaichome <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"青山一丁目"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line"><span class="synStatement">let</span> nagatacho <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"永田町"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line"><span class="synStatement">let</span> shinochanomizu <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"新御茶ノ水"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* koushin test *)</span>
</span><span class="code-line"><span class="synStatement">let</span> koushin_test1 <span class="synStatement">=</span> koushin otemachi
</span><span class="code-line">  <span class="synStatement">[</span>mitsukoshimae<span class="synStatement">;</span> shibuya<span class="synStatement">;</span> shinochanomizu<span class="synStatement">;</span> aoyamaichome<span class="synStatement">]</span> global_ekikan_list
</span><span class="code-line">  <span class="synStatement">=[{</span>namae <span class="synStatement">=</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0.7</span><span class="synStatement">;</span>
</span><span class="code-line">     temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"三越前"</span><span class="synStatement">;</span> <span class="synConstant">"大手町"</span><span class="synStatement">]};</span>
</span><span class="code-line">    <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"渋谷"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">};</span>
</span><span class="code-line">    <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"新御茶ノ水"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">1.3</span><span class="synStatement">;</span>
</span><span class="code-line">     temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"新御茶ノ水"</span><span class="synStatement">;</span> <span class="synConstant">"大手町"</span><span class="synStatement">]};</span>
</span><span class="code-line">    <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"青山一丁目"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}];;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：eki_t list型のリストを受け取り，「最短距離最小の駅」と</span>
</span><span class="code-line"><span class="synComment">   「最短距離最小の駅以外からなるリスト」の組を返す *)</span>
</span><span class="code-line"><span class="synComment">(* saitan_wo_bunri : eki_t list -> eki_t * eki_t list *)</span>
</span><span class="code-line"><span class="synStatement">let</span> saitan_wo_bunri eki_list <span class="synStatement">=</span>
</span><span class="code-line">  <span class="synPreProc">List</span>.fold_right
</span><span class="code-line">    <span class="synStatement">(fun</span> first rest_saitan <span class="synStatement">-></span>
</span><span class="code-line">      <span class="synStatement">let</span> <span class="synStatement">(</span>minimum, lst<span class="synStatement">)</span> <span class="synStatement">=</span> rest_saitan <span class="synStatement">in</span>
</span><span class="code-line">      <span class="synStatement">if</span> minimum.namae <span class="synStatement">=</span> <span class="synConstant">""</span>
</span><span class="code-line">      <span class="synStatement">then</span> <span class="synStatement">(</span>first, lst<span class="synStatement">)</span>
</span><span class="code-line">      <span class="synStatement">else</span> <span class="synStatement">if</span> first.saitan_kyori <span class="synStatement">&#x3C;=</span> minimum.saitan_kyori
</span><span class="code-line">      <span class="synStatement">then</span> <span class="synStatement">(</span>first, minimum <span class="synStatement">::</span> lst<span class="synStatement">)</span>
</span><span class="code-line">      <span class="synStatement">else</span> <span class="synStatement">(</span>minimum, first <span class="synStatement">::</span> lst<span class="synStatement">))</span>
</span><span class="code-line">    eki_list
</span><span class="code-line">    <span class="synStatement">({</span>namae <span class="synStatement">=</span> <span class="synConstant">""</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>, <span class="synConstant">[]</span><span class="synStatement">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> saitan_wo_bunri <span class="synStatement">[{</span>namae <span class="synStatement">=</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0.7</span><span class="synStatement">;</span>
</span><span class="code-line">                              temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"三越前"</span><span class="synStatement">;</span> <span class="synConstant">"大手町"</span><span class="synStatement">]};</span>
</span><span class="code-line">                             <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"渋谷"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0.3</span><span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"渋谷"</span><span class="synStatement">]};</span>
</span><span class="code-line">                             <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"新御茶ノ水"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">1.3</span><span class="synStatement">;</span>
</span><span class="code-line">                              temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"新御茶ノ水"</span><span class="synStatement">;</span> <span class="synConstant">"大手町"</span><span class="synStatement">]};</span>
</span><span class="code-line">                             <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"青山一丁目"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span>
</span><span class="code-line">                              temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}]</span>
</span><span class="code-line">  <span class="synStatement">=({</span>namae <span class="synStatement">=</span> <span class="synConstant">"渋谷"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0.3</span><span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"渋谷"</span><span class="synStatement">]}</span>,
</span><span class="code-line">    <span class="synStatement">[{</span>namae <span class="synStatement">=</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">0.7</span><span class="synStatement">;</span>
</span><span class="code-line">     temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"三越前"</span><span class="synStatement">;</span> <span class="synConstant">"大手町"</span><span class="synStatement">]};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"新御茶ノ水"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">1.3</span><span class="synStatement">;</span>
</span><span class="code-line">      temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"新御茶ノ水"</span><span class="synStatement">;</span> <span class="synConstant">"大手町"</span><span class="synStatement">]};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"青山一丁目"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}]);;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：eki_t list型の未確定の駅のリストとekikan_t list型の駅間のリストを受け取り</span>
</span><span class="code-line"><span class="synComment">   ダイクストラのアルゴリズムにしたがって各駅について</span>
</span><span class="code-line"><span class="synComment">   最短距離と最短経路が正しく入ったリストを返す *)</span>
</span><span class="code-line"><span class="synComment">(* dijkstra_main : eki_t list -> ekikan_t list -> eki_t list *)</span>
</span><span class="code-line"><span class="synStatement">let</span> <span class="synStatement">rec</span> dijkstra_main  eki_list ekikan <span class="synStatement">=</span> <span class="synStatement">match</span> eki_list <span class="synStatement">with</span>
</span><span class="code-line">    <span class="synConstant">[]</span> <span class="synStatement">-></span> <span class="synConstant">[]</span>
</span><span class="code-line">  <span class="synStatement">|</span> first <span class="synStatement">::</span> rest <span class="synStatement">-></span> <span class="synStatement">match</span> <span class="synStatement">(</span>saitan_wo_bunri eki_list<span class="synStatement">)</span> <span class="synStatement">with</span>
</span><span class="code-line">    <span class="synStatement">(</span>saitan1, <span class="synConstant">[]</span><span class="synStatement">)</span> <span class="synStatement">-></span> <span class="synStatement">[</span>saitan1<span class="synStatement">]</span>
</span><span class="code-line">    <span class="synStatement">|</span> <span class="synStatement">(</span>saitan2, rest<span class="synStatement">)</span> <span class="synStatement">-></span> saitan2 <span class="synStatement">::</span> <span class="synStatement">(</span>dijkstra_main <span class="synStatement">(</span>koushin saitan2 rest ekikan<span class="synStatement">)</span> ekikan<span class="synStatement">)</span> <span class="synStatement">;;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* test_data *)</span>
</span><span class="code-line"><span class="synStatement">let</span> otemachi <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"大手町"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">1.7</span><span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"神保町"</span><span class="synStatement">]};;</span>
</span><span class="code-line"><span class="synStatement">let</span> mitsukoshimae <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">};;</span>
</span><span class="code-line"><span class="synStatement">let</span> suitenguumae <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"水天宮前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">};;</span>
</span><span class="code-line"><span class="synStatement">let</span> kiyosumishirakawa <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"清澄白河"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">};;</span>
</span><span class="code-line"><span class="synStatement">let</span> sumiyoshi <span class="synStatement">=</span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"住吉"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">};;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synStatement">let</span> dijkstra_test1 <span class="synStatement">=</span> dijkstra_main <span class="synStatement">[</span>otemachi<span class="synStatement">;</span> mitsukoshimae<span class="synStatement">;</span> suitenguumae<span class="synStatement">;</span>
</span><span class="code-line">                                    kiyosumishirakawa<span class="synStatement">;</span> sumiyoshi<span class="synStatement">]</span>
</span><span class="code-line">  global_ekikan_list
</span><span class="code-line">  <span class="synStatement">=</span> <span class="synStatement">[{</span>namae <span class="synStatement">=</span> <span class="synConstant">"大手町"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">1.7</span><span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"神保町"</span><span class="synStatement">]};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">2.4</span><span class="synStatement">;</span>
</span><span class="code-line">      temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"三越前"</span><span class="synStatement">;</span> <span class="synConstant">"神保町"</span><span class="synStatement">]};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"水天宮前"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">3.7</span><span class="synStatement">;</span>
</span><span class="code-line">      temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"水天宮前"</span><span class="synStatement">;</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> <span class="synConstant">"神保町"</span><span class="synStatement">]};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"清澄白河"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">5.4</span><span class="synStatement">;</span>
</span><span class="code-line">      temae_list <span class="synStatement">=</span> <span class="synStatement">[</span><span class="synConstant">"清澄白河"</span><span class="synStatement">;</span> <span class="synConstant">"水天宮前"</span><span class="synStatement">;</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> <span class="synConstant">"神保町"</span><span class="synStatement">]};</span>
</span><span class="code-line">     <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"住吉"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">7.30000000000000071</span><span class="synStatement">;</span>
</span><span class="code-line">      temae_list <span class="synStatement">=</span>
</span><span class="code-line">         <span class="synStatement">[</span><span class="synConstant">"住吉"</span><span class="synStatement">;</span> <span class="synConstant">"清澄白河"</span><span class="synStatement">;</span> <span class="synConstant">"水天宮前"</span><span class="synStatement">;</span> <span class="synConstant">"三越前"</span><span class="synStatement">;</span> <span class="synConstant">"神保町"</span><span class="synStatement">]}];;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* 目的：始点の駅名（ローマ字の文字列）と終点の駅名（ローマ字の文字列）を受け取り</span>
</span><span class="code-line"><span class="synComment">   seiretsuを使ってglobal_ekimei_list の重複を取り除き，</span>
</span><span class="code-line"><span class="synComment">   romaji_to_kanji を使って始点と終点の漢字表記を求め</span>
</span><span class="code-line"><span class="synComment">   make_initial_eki_listを使って駅のリストを作り，</span>
</span><span class="code-line"><span class="synComment">   dijkstra_mainを使って各駅までの最短路を確定し，</span>
</span><span class="code-line"><span class="synComment">   その中空終点の駅のレコード(eki_t型)を返す*)</span>
</span><span class="code-line"><span class="synComment">(* dijkstra : string -> string -> eki_t *)</span>
</span><span class="code-line"><span class="synStatement">let</span> dijkstra siten shuten <span class="synStatement">=</span>
</span><span class="code-line">  <span class="synStatement">let</span> sorted_ekimei_list <span class="synStatement">=</span> seiretsu global_ekimei_list <span class="synStatement">in</span>
</span><span class="code-line">  <span class="synStatement">let</span> siten_kanji <span class="synStatement">=</span> romaji_to_kanji siten sorted_ekimei_list <span class="synStatement">in</span>
</span><span class="code-line">  <span class="synStatement">let</span> shuten_kanji <span class="synStatement">=</span> romaji_to_kanji shuten sorted_ekimei_list <span class="synStatement">in</span>
</span><span class="code-line">  <span class="synStatement">let</span> initialized_list <span class="synStatement">=</span> make_initial_eki_list siten_kanji sorted_ekimei_list <span class="synStatement">in</span>
</span><span class="code-line">  <span class="synStatement">let</span> saitan_list <span class="synStatement">=</span> dijkstra_main initialized_list global_ekikan_list <span class="synStatement">in</span>
</span><span class="code-line">  <span class="synStatement">let</span> <span class="synStatement">rec</span> serch item lst <span class="synStatement">=</span> <span class="synStatement">match</span> lst <span class="synStatement">with</span>
</span><span class="code-line">      <span class="synConstant">[]</span> <span class="synStatement">-></span> <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">""</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> infinity<span class="synStatement">;</span> temae_list <span class="synStatement">=</span> <span class="synConstant">[]</span><span class="synStatement">}</span>
</span><span class="code-line">    <span class="synStatement">|</span> first <span class="synStatement">::</span> rest <span class="synStatement">-></span>
</span><span class="code-line">       <span class="synStatement">if</span> first.namae <span class="synStatement">=</span> item
</span><span class="code-line">       <span class="synStatement">then</span> first
</span><span class="code-line">       <span class="synStatement">else</span> serch item rest
</span><span class="code-line">  <span class="synStatement">in</span> serch shuten_kanji saitan_list<span class="synStatement">;;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="synComment">(* test *)</span>
</span><span class="code-line"><span class="synComment">(* サポートページからのコピペ *)</span>
</span><span class="code-line"><span class="synStatement">let</span> test1 <span class="synStatement">=</span> dijkstra <span class="synConstant">"shibuya"</span> <span class="synConstant">"gokokuji"</span> <span class="synStatement">=</span>
</span><span class="code-line">  <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"護国寺"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">9.8</span><span class="synStatement">;</span>
</span><span class="code-line">   temae_list <span class="synStatement">=</span>
</span><span class="code-line">     <span class="synStatement">[</span><span class="synConstant">"護国寺"</span><span class="synStatement">;</span> <span class="synConstant">"江戸川橋"</span><span class="synStatement">;</span> <span class="synConstant">"飯田橋"</span><span class="synStatement">;</span> <span class="synConstant">"市ヶ谷"</span><span class="synStatement">;</span> <span class="synConstant">"麹町"</span><span class="synStatement">;</span> <span class="synConstant">"永田町"</span><span class="synStatement">;</span>
</span><span class="code-line">      <span class="synConstant">"青山一丁目"</span><span class="synStatement">;</span> <span class="synConstant">"表参道"</span><span class="synStatement">;</span> <span class="synConstant">"渋谷"</span><span class="synStatement">]}</span>
</span><span class="code-line"><span class="synStatement">let</span> test2 <span class="synStatement">=</span> dijkstra <span class="synConstant">"myogadani"</span> <span class="synConstant">"meguro"</span> <span class="synStatement">=</span>
</span><span class="code-line">  <span class="synStatement">{</span>namae <span class="synStatement">=</span> <span class="synConstant">"目黒"</span><span class="synStatement">;</span> saitan_kyori <span class="synStatement">=</span> <span class="synConstant">12.7000000000000028</span><span class="synStatement">;</span>
</span><span class="code-line">   temae_list <span class="synStatement">=</span>
</span><span class="code-line">     <span class="synStatement">[</span><span class="synConstant">"目黒"</span><span class="synStatement">;</span> <span class="synConstant">"白金台"</span><span class="synStatement">;</span> <span class="synConstant">"白金高輪"</span><span class="synStatement">;</span> <span class="synConstant">"麻布十番"</span><span class="synStatement">;</span> <span class="synConstant">"六本木一丁目"</span><span class="synStatement">;</span> <span class="synConstant">"溜池山王"</span><span class="synStatement">;</span>
</span><span class="code-line">      <span class="synConstant">"永田町"</span><span class="synStatement">;</span> <span class="synConstant">"麹町"</span><span class="synStatement">;</span> <span class="synConstant">"市ヶ谷"</span><span class="synStatement">;</span> <span class="synConstant">"飯田橋"</span><span class="synStatement">;</span> <span class="synConstant">"後楽園"</span><span class="synStatement">;</span> <span class="synConstant">"茗荷谷"</span><span class="synStatement">]}</span>
</span></code></pre></div></div></article></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"プログラミングの基礎　16.4 最初の完動プログラム","published":"2016/02/16","tags":["OCaml","プログラミングの基礎"],"content":"\u003cp\u003eプログラミングの基礎で作ったメトロネットワーク最短路問題の解答．\u003cbr\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AF%A5%B9%A5%C8%A5%E9\"\u003eダイクストラ\u003c/a\u003e法を使い求める．\u003cbr\u003e\nここまでのメトロネットワーク最短路問題に関係する問題の解答すべてここに書いてある．\u003c/p\u003e\n\u003cpre class=\"code lang-ocaml\" data-lang=\"ocaml\" data-unlink=\"\"\u003e\u003ccode class=\"code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* サポートページからダウンロードしたglobal_ekimei_listとglobal_ekikan_list *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synPreProc\"\u003e#use\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"metro.ml\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のデータを受け取り，「路線名，駅名（かな）」を返す *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* hyoji : ekimei_t -\u003e string *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e hyoji ekimei \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e ekimei \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e;}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"，\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e kanji \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"（\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"）\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* hyoji test *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003eprint_string \u003cspan class=\"synConstant\"\u003e\"hyouji test\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e hyoji \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"茗荷谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"みょうがだに\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                   romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"myogadani\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"丸ノ内線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"丸ノ内線，茗荷谷（みょうがだに）\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：ローマ字の駅名（文字列）と駅名リスト(ekimei_t list 型)を受け取り\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   園駅の漢字表記を返す *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* romaji_to_kanji -\u003e string -\u003e ekimei_t list -\u003e string *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e romaji_to_kanji name lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e name \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kanji\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e romaji_to_kanji name rest\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* romaji_to_kanji test *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\"myogadani\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\"myogadani\"\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"茗荷谷\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\"aoyamaicchome\"\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"青山一丁目\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\"heiwadai\"\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"平和台\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：漢字の駅名を２つと駅間リストを受け取ったら，駅間リストの中からその２駅間の距離を返す *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* get_ekikan_kyori : string -\u003e string -\u003e ekikan_t list -\u003e float *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e get_ekikan_kyori eki1 eki2 lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e infinity\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekiten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shuten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e keiyu \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e keiyu\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e jikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e jikan\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten \u003cspan class=\"synStatement\"\u003e\u0026#x26;\u0026#x26;\u003c/span\u003e eki2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kyori\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten \u003cspan class=\"synStatement\"\u003e\u0026#x26;\u0026#x26;\u003c/span\u003e eki1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kyori\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e get_ekikan_kyori eki1 eki2 rest\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* get_ekikan_kyori test *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\"錦糸町\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"住吉\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\"錦糸町\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"錦糸町\"\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\"横浜駅\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"錦糸町\"\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test7 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\"霞ヶ関\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"日比谷\"\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.2\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：ローマ字の駅名を２つ受け取り，その間の距離を調べ，つながっている場合は\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   「A駅からB駅までのはｘｋｍです」と返し，繋がっていない場合は\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   「A駅からB駅はつながっていません」と返す*)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori_wo_hyoji r1 r2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji r1 global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji r2 global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e not_exist \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"という駅は存在しません\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e r1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e not_exist\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e r2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e not_exist\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori k1 k2 global_ekikan_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"駅と\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"駅はつながっていません\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"駅から\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"駅までは\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e string_of_float kyori \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"kmです\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* kyori_wo_hyoji test *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\"otemachi\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"hibiya\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町駅と日比谷駅はつながっていません\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"kinsityo\"\u003c/span\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"という駅は存在しません\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\"yokohama\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"kinsityo\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"yokohamaという駅は存在しません\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\"otemachi\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"mitsukoshimae\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町駅から三越前駅までは0.7kmです\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\"mitsukoshimae\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"otemachi\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前駅から大手町駅までは0.7kmです\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\"kasumigaseki\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"hibiya\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"霞ヶ関駅から日比谷駅までは1.2kmです\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003etype\u003c/span\u003e eki_t \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  namae : \u003cspan class=\"synType\"\u003estring\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e               \u003cspan class=\"synComment\"\u003e(* 駅名（漢字の文字列） *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  saitan_kyori : \u003cspan class=\"synType\"\u003efloat\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e(* 最短距離（実数） *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  temae_list : \u003cspan class=\"synType\"\u003estring\u003c/span\u003e \u003cspan class=\"synType\"\u003elist\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e(* 駅名（漢字の文字列）のリスト *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：string型の駅名(漢字)とekimei_t list型を受け取り，\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   ekimei_t listをeki_t listに変え，その際駅名と一致する駅についてはshokikaする *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* make_initial_eki_list : string -\u003e ekimei_t list -\u003e eki_t list *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e make_initial_eki_list name lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.map \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e a\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e r\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e s\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e name\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003ek\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    lst\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* make_initial_eki_list test *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\"代々木上原\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"代々木上原\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"よよぎうえはら\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                                 romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"yoyogiuehara\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"千代田線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"代々木上原\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"代々木上原\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\"明治神宮前\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"代々木公園\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"よよぎこうえん\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                                romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"yoyogikouen\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"千代田線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                               \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"明治神宮前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"めいじじんぐうまえ\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                                romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"meijijinguumae\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"千代田線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"代々木公園\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"明治神宮前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"明治神宮前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\"赤坂\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"表参道\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"おもてさんどう\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"omotesandou\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"千代田線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                          \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"乃木坂\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"のぎざか\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"nogizaka\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"千代田線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                          \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"赤坂\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"あかさか\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"akasaka\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"千代田線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"表参道\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"乃木坂\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"赤坂\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"赤坂\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のレコードとekimei_t型のリストを受け取ったら，平仮名の昇順となる位置に\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   ekimei_t型のレコードを挿入する．同じ駅がリストにあれば挿入しない．\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   seiretsuのための補助関数*)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* ekimei_isnert : -\u003e ekimei_t -\u003e ekimei_t list -\u003e ekimei_t list *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e ekimei_insert eki lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eeki\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e({\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e;}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eas\u003c/span\u003e first\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e eki.kana\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e lst                   \u003cspan class=\"synComment\"\u003e(* リストにあったほうが残る *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki.kana \u003cspan class=\"synStatement\"\u003e\u0026#x3C;\u003c/span\u003e kana    \u003cspan class=\"synComment\"\u003e(* 駅のkana \u0026#x3C; first のkana *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e ekimei_insert eki rest\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* test data *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e yoyogiuehara_tiyodasen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"代々木上原\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"よよぎうえはら\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"yoyogiuehara\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"千代田線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"おおてまち\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                         romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"otemachi\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"千代田線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi_hanzoumonsen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"おおてまち\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"otemachi\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"半蔵門線\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* test *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert yoyogiuehara_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のリストを受け取ったら，それを平仮名の順に整列し，\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   さらに駅の重複を取り除いたekimei_t型のリストを返す *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* seiretsu : ekimei_t -\u003e ekimei_t *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e seiretsu lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e ekimei_insert first \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eseiretsu rest\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e otemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e otemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shibuya \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"渋谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e aoyamaichome \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"青山一丁目\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：直前に確定した駅 p (eki_t型)と味覚手の役のリスト v (eki_t list型)を受け取り\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   必要な更新処理を行った後の未確定の駅のリストを返す*)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* koushin -\u003e eki_t -\u003e eki_t list -\u003e ekikan_t list -\u003e eki_t list *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e koushin p v ekikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.map\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e q \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori p.namae q.namae ekikan \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e q\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e p_keiyu_q_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e p.saitan_kyori +. kyori \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e  p_keiyu_q_kyori  \u003cspan class=\"synStatement\"\u003e\u0026#x3C;\u003c/span\u003e q.saitan_kyori\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003e namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e q.namae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e p_keiyu_q_kyori\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                  temae_list \u003cspan class=\"synStatement\"\u003e=(\u003c/span\u003eq.namae\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e p.temae_list\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e           \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e q\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    v\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* test data *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shibuya \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"渋谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e aoyamaichome \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"青山一丁目\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e nagatacho \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"永田町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shinochanomizu \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"新御茶ノ水\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* koushin test *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e koushin_test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e koushin otemachi\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003emitsukoshimae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shibuya\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shinochanomizu\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e aoyamaichome\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e global_ekikan_list\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"渋谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"新御茶ノ水\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"新御茶ノ水\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"青山一丁目\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}];;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：eki_t list型のリストを受け取り，「最短距離最小の駅」と\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   「最短距離最小の駅以外からなるリスト」の組を返す *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* saitan_wo_bunri : eki_t list -\u003e eki_t * eki_t list *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e saitan_wo_bunri eki_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.fold_right\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e first rest_saitan \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eminimum, lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e rest_saitan \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e minimum.namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003efirst, lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e first.saitan_kyori \u003cspan class=\"synStatement\"\u003e\u0026#x3C;=\u003c/span\u003e minimum.saitan_kyori\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003efirst, minimum \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eminimum, first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\u003cspan class=\"synStatement\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    eki_list\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e({\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e, \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e saitan_wo_bunri \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"渋谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"渋谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"新御茶ノ水\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"新御茶ノ水\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"青山一丁目\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=({\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"渋谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"渋谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e,\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"新御茶ノ水\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"新御茶ノ水\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"青山一丁目\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]);;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：eki_t list型の未確定の駅のリストとekikan_t list型の駅間のリストを受け取り\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   ダイクストラのアルゴリズムにしたがって各駅について\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   最短距離と最短経路が正しく入ったリストを返す *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* dijkstra_main : eki_t list -\u003e ekikan_t list -\u003e eki_t list *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e dijkstra_main  eki_list ekikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e eki_list \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan_wo_bunri eki_list\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan1, \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003esaitan1\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan2, rest\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e saitan2 \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003edijkstra_main \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003ekoushin saitan2 rest ekikan\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e ekikan\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* test_data *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"神保町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e suitenguumae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"水天宮前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kiyosumishirakawa \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"清澄白河\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e sumiyoshi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"住吉\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e dijkstra_test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra_main \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e mitsukoshimae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e suitenguumae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e                                    kiyosumishirakawa\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e sumiyoshi\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  global_ekikan_list\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"大手町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"神保町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2.4\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"神保町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"水天宮前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"水天宮前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"神保町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"清澄白河\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5.4\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"清澄白河\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"水天宮前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"神保町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"住吉\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7.30000000000000071\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e         \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"住吉\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"清澄白河\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"水天宮前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"三越前\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"神保町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* 目的：始点の駅名（ローマ字の文字列）と終点の駅名（ローマ字の文字列）を受け取り\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   seiretsuを使ってglobal_ekimei_list の重複を取り除き，\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   romaji_to_kanji を使って始点と終点の漢字表記を求め\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   make_initial_eki_listを使って駅のリストを作り，\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   dijkstra_mainを使って各駅までの最短路を確定し，\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e   その中空終点の駅のレコード(eki_t型)を返す*)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* dijkstra : string -\u003e string -\u003e eki_t *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e dijkstra siten shuten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e sorted_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e siten_kanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji siten sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shuten_kanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji shuten sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e initialized_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list siten_kanji sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e saitan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra_main initialized_list global_ekikan_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e serch item lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e    \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u003e\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e first.namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e item\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e first\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e       \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e serch item rest\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e serch shuten_kanji saitan_list\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* test *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synComment\"\u003e(* サポートページからのコピペ *)\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra \u003cspan class=\"synConstant\"\u003e\"shibuya\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"gokokuji\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"護国寺\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e9.8\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e   temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"護国寺\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"江戸川橋\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"飯田橋\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"市ヶ谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"麹町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"永田町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synConstant\"\u003e\"青山一丁目\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"表参道\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"渋谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra \u003cspan class=\"synConstant\"\u003e\"myogadani\"\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"meguro\"\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"目黒\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e12.7000000000000028\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e   temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e     \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\"目黒\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"白金台\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"白金高輪\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"麻布十番\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"六本木一丁目\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"溜池山王\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e      \u003cspan class=\"synConstant\"\u003e\"永田町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"麹町\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"市ヶ谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"飯田橋\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"後楽園\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\"茗荷谷\"\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","slug":"プログラミングの基礎　16.4 最初の完動プログラム","rawContent":"\n\u003cp\u003eプログラミングの基礎で作ったメトロネットワーク最短路問題の解答．\u003cbr/\u003e\n\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C0%A5%A4%A5%AF%A5%B9%A5%C8%A5%E9\"\u003eダイクストラ\u003c/a\u003e法を使い求める．\u003cbr/\u003e\nここまでのメトロネットワーク最短路問題に関係する問題の解答すべてここに書いてある．\u003c/p\u003e\n\n\u003cpre class=\"code lang-ocaml\" data-lang=\"ocaml\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e(* サポートページからダウンロードしたglobal_ekimei_listとglobal_ekikan_list *)\u003c/span\u003e\n\u003cspan class=\"synPreProc\"\u003e#use\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;metro.ml\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のデータを受け取り，「路線名，駅名（かな）」を返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* hyoji : ekimei_t -\u0026gt; string *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e hyoji ekimei \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e ekimei \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e;}\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;，\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e kanji \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;（\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;）\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e(* hyoji test *)\u003c/span\u003e\nprint_string \u003cspan class=\"synConstant\"\u003e\u0026quot;hyouji test\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e hyoji \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;茗荷谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;みょうがだに\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                   romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;myogadani\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;丸ノ内線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;丸ノ内線，茗荷谷（みょうがだに）\u0026quot;\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ローマ字の駅名（文字列）と駅名リスト(ekimei_t list 型)を受け取り\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   園駅の漢字表記を返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* romaji_to_kanji -\u0026gt; string -\u0026gt; ekimei_t list -\u0026gt; string *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e romaji_to_kanji name lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e name \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kanji\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e romaji_to_kanji name rest\n\n\u003cspan class=\"synComment\"\u003e(* romaji_to_kanji test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;myogadani\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;myogadani\u0026quot;\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;茗荷谷\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;aoyamaicchome\u0026quot;\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji \u003cspan class=\"synConstant\"\u003e\u0026quot;heiwadai\u0026quot;\u003c/span\u003e global_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;平和台\u0026quot;\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：漢字の駅名を２つと駅間リストを受け取ったら，駅間リストの中からその２駅間の距離を返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* get_ekikan_kyori : string -\u0026gt; string -\u0026gt; ekikan_t list -\u0026gt; float *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e get_ekikan_kyori eki1 eki2 lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e infinity\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekiten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shuten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e keiyu \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e keiyu\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e jikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e jikan\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten \u003cspan class=\"synStatement\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e eki2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kyori\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kiten \u003cspan class=\"synStatement\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e eki1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shuten\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e kyori\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e get_ekikan_kyori eki1 eki2 rest\n\n\n\n\u003cspan class=\"synComment\"\u003e(* get_ekikan_kyori test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;錦糸町\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;住吉\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;錦糸町\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;錦糸町\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;横浜駅\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;錦糸町\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test7 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori \u003cspan class=\"synConstant\"\u003e\u0026quot;霞ヶ関\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;日比谷\u0026quot;\u003c/span\u003e global_ekikan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.2\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ローマ字の駅名を２つ受け取り，その間の距離を調べ，つながっている場合は\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   「A駅からB駅までのはｘｋｍです」と返し，繋がっていない場合は\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   「A駅からB駅はつながっていません」と返す*)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori_wo_hyoji r1 r2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji r1 global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji r2 global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e not_exist \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;という駅は存在しません\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e r1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e not_exist\n  \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e r2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e not_exist\n  \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori k1 k2 global_ekikan_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n       \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n       \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;駅と\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;駅はつながっていません\u0026quot;\u003c/span\u003e\n       \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e k1 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;駅から\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e k2 \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;駅までは\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e string_of_float kyori \u003cspan class=\"synStatement\"\u003e^\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;kmです\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* kyori_wo_hyoji test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;hibiya\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町駅と日比谷駅はつながっていません\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;kinsityo\u0026quot;\u003c/span\u003e  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;という駅は存在しません\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;yokohama\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;kinsityo\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;yokohamaという駅は存在しません\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;mitsukoshimae\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町駅から三越前駅までは0.7kmです\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test5 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;mitsukoshimae\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前駅から大手町駅までは0.7kmです\u0026quot;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test6 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kyori_wo_hyoji \u003cspan class=\"synConstant\"\u003e\u0026quot;kasumigaseki\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;hibiya\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;霞ヶ関駅から日比谷駅までは1.2kmです\u0026quot;\u003c/span\u003e\n\n\u003cspan class=\"synStatement\"\u003etype\u003c/span\u003e eki_t \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003e\n  namae : \u003cspan class=\"synType\"\u003estring\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e               \u003cspan class=\"synComment\"\u003e(* 駅名（漢字の文字列） *)\u003c/span\u003e\n  saitan_kyori : \u003cspan class=\"synType\"\u003efloat\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e         \u003cspan class=\"synComment\"\u003e(* 最短距離（実数） *)\u003c/span\u003e\n  temae_list : \u003cspan class=\"synType\"\u003estring\u003c/span\u003e \u003cspan class=\"synType\"\u003elist\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e     \u003cspan class=\"synComment\"\u003e(* 駅名（漢字の文字列）のリスト *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* 目的：string型の駅名(漢字)とekimei_t list型を受け取り，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   ekimei_t listをeki_t listに変え，その際駅名と一致する駅についてはshokikaする *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* make_initial_eki_list : string -\u0026gt; ekimei_t list -\u0026gt; eki_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e make_initial_eki_list name lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.map \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e a\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e r\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e s\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e k \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e name\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003ek\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e k\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e})\u003c/span\u003e\n    lst\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* make_initial_eki_list test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;よよぎうえはら\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                                 romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;yoyogiuehara\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\u0026quot;明治神宮前\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;代々木公園\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;よよぎこうえん\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                                romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;yoyogikouen\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n                                               \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;明治神宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;めいじじんぐうまえ\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                                romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;meijijinguumae\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;代々木公園\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;明治神宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;明治神宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list \u003cspan class=\"synConstant\"\u003e\u0026quot;赤坂\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;表参道\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;おもてさんどう\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;omotesandou\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n                                          \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;乃木坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;のぎざか\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;nogizaka\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n                                          \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;赤坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;あかさか\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                           romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;akasaka\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;表参道\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;乃木坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;赤坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;赤坂\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\n\n\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のレコードとekimei_t型のリストを受け取ったら，平仮名の昇順となる位置に\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   ekimei_t型のレコードを挿入する．同じ駅がリストにあれば挿入しない．\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   seiretsuのための補助関数*)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* ekimei_isnert : -\u0026gt; ekimei_t -\u0026gt; ekimei_t list -\u0026gt; ekimei_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e ekimei_insert eki lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eeki\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e({\u003c/span\u003ekanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kanji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e romaji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e;}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eas\u003c/span\u003e first\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kana \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e eki.kana\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e lst                   \u003cspan class=\"synComment\"\u003e(* リストにあったほうが残る *)\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e eki.kana \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003e kana    \u003cspan class=\"synComment\"\u003e(* 駅のkana \u0026lt; first のkana *)\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e eki \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\n     \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e ekimei_insert eki rest\n\n\u003cspan class=\"synComment\"\u003e(* test data *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e yoyogiuehara_tiyodasen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;代々木上原\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;よよぎうえはら\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                              romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;yoyogiuehara\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;おおてまち\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                         romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;千代田線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi_hanzoumonsen \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003ekanji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e kana\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;おおてまち\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                             romaji\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;otemachi\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shozoku\u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;半蔵門線\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert otemachi_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e ekimei_insert yoyogiuehara_tiyodasen \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：ekimei_t型のリストを受け取ったら，それを平仮名の順に整列し，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   さらに駅の重複を取り除いたekimei_t型のリストを返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* seiretsu : ekimei_t -\u0026gt; ekimei_t *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e seiretsu lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e ekimei_insert first \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eseiretsu rest\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\n\n\n\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eyoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test3 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e otemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test4 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_tiyodasen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e otemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi_hanzoumonsen\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e yoyogiuehara_tiyodasen\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n\n\n\n\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shibuya \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e aoyamaichome \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：直前に確定した駅 p (eki_t型)と味覚手の役のリスト v (eki_t list型)を受け取り\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   必要な更新処理を行った後の未確定の駅のリストを返す*)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* koushin -\u0026gt; eki_t -\u0026gt; eki_t list -\u0026gt; ekikan_t list -\u0026gt; eki_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e koushin p v ekikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.map\n    \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e q \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e get_ekikan_kyori p.namae q.namae ekikan \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e q\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e p_keiyu_q_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e p.saitan_kyori +. kyori \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n           \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e  p_keiyu_q_kyori  \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003e q.saitan_kyori\n           \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003e namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e q.namae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e p_keiyu_q_kyori\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                  temae_list \u003cspan class=\"synStatement\"\u003e=(\u003c/span\u003eq.namae\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e p.temae_list\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n           \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e q\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n    v\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* test data *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shibuya \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e aoyamaichome \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e nagatacho \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;永田町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shinochanomizu \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* koushin test *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e koushin_test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e koushin otemachi\n  \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003emitsukoshimae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shibuya\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e shinochanomizu\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e aoyamaichome\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e global_ekikan_list\n  \u003cspan class=\"synStatement\"\u003e=[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}];;\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：eki_t list型のリストを受け取り，「最短距離最小の駅」と\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   「最短距離最小の駅以外からなるリスト」の組を返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* saitan_wo_bunri : eki_t list -\u0026gt; eki_t * eki_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e saitan_wo_bunri eki_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synPreProc\"\u003eList\u003c/span\u003e.fold_right\n    \u003cspan class=\"synStatement\"\u003e(fun\u003c/span\u003e first rest_saitan \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eminimum, lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e rest_saitan \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e minimum.namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003efirst, lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e first.saitan_kyori \u003cspan class=\"synStatement\"\u003e\u0026lt;=\u003c/span\u003e minimum.saitan_kyori\n      \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003efirst, minimum \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003eminimum, first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e lst\u003cspan class=\"synStatement\"\u003e))\u003c/span\u003e\n    eki_list\n    \u003cspan class=\"synStatement\"\u003e({\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e, \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e saitan_wo_bunri \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n                             \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                              temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e=({\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e,\n    \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e0.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n     temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.3\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;新御茶ノ水\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}]);;\u003c/span\u003e\n\n\n\u003cspan class=\"synComment\"\u003e(* 目的：eki_t list型の未確定の駅のリストとekikan_t list型の駅間のリストを受け取り\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   ダイクストラのアルゴリズムにしたがって各駅について\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   最短距離と最短経路が正しく入ったリストを返す *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* dijkstra_main : eki_t list -\u0026gt; ekikan_t list -\u0026gt; eki_t list *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e dijkstra_main  eki_list ekikan \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e eki_list \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan_wo_bunri eki_list\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan1, \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003esaitan1\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003esaitan2, rest\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e saitan2 \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003edijkstra_main \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003ekoushin saitan2 rest ekikan\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e ekikan\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\n\n\u003cspan class=\"synComment\"\u003e(* test_data *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e otemachi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e mitsukoshimae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e suitenguumae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e kiyosumishirakawa \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;清澄白河\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e sumiyoshi \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;住吉\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e};;\u003c/span\u003e\n\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e dijkstra_test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra_main \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eotemachi\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e mitsukoshimae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e suitenguumae\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n                                    kiyosumishirakawa\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e sumiyoshi\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e\n  global_ekikan_list\n  \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;大手町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e2.4\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e3.7\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;清澄白河\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e5.4\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;清澄白河\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]};\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;住吉\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e7.30000000000000071\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n         \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;住吉\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;清澄白河\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;水天宮前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;三越前\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;神保町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}];;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* 目的：始点の駅名（ローマ字の文字列）と終点の駅名（ローマ字の文字列）を受け取り\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   seiretsuを使ってglobal_ekimei_list の重複を取り除き，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   romaji_to_kanji を使って始点と終点の漢字表記を求め\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   make_initial_eki_listを使って駅のリストを作り，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   dijkstra_mainを使って各駅までの最短路を確定し，\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e   その中空終点の駅のレコード(eki_t型)を返す*)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* dijkstra : string -\u0026gt; string -\u0026gt; eki_t *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e dijkstra siten shuten \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e sorted_ekimei_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e seiretsu global_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e siten_kanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji siten sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e shuten_kanji \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e romaji_to_kanji shuten sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e initialized_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e make_initial_eki_list siten_kanji sorted_ekimei_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e saitan_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra_main initialized_list global_ekikan_list \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e \u003cspan class=\"synStatement\"\u003erec\u003c/span\u003e serch item lst \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synStatement\"\u003ematch\u003c/span\u003e lst \u003cspan class=\"synStatement\"\u003ewith\u003c/span\u003e\n      \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e infinity\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e[]\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"synStatement\"\u003e|\u003c/span\u003e first \u003cspan class=\"synStatement\"\u003e::\u003c/span\u003e rest \u003cspan class=\"synStatement\"\u003e-\u0026gt;\u003c/span\u003e\n       \u003cspan class=\"synStatement\"\u003eif\u003c/span\u003e first.namae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e item\n       \u003cspan class=\"synStatement\"\u003ethen\u003c/span\u003e first\n       \u003cspan class=\"synStatement\"\u003eelse\u003c/span\u003e serch item rest\n  \u003cspan class=\"synStatement\"\u003ein\u003c/span\u003e serch shuten_kanji saitan_list\u003cspan class=\"synStatement\"\u003e;;\u003c/span\u003e\n\n\u003cspan class=\"synComment\"\u003e(* test *)\u003c/span\u003e\n\u003cspan class=\"synComment\"\u003e(* サポートページからのコピペ *)\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test1 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra \u003cspan class=\"synConstant\"\u003e\u0026quot;shibuya\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;gokokuji\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;護国寺\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e9.8\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n   temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;護国寺\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;江戸川橋\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;飯田橋\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;市ヶ谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;麹町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;永田町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"synConstant\"\u003e\u0026quot;青山一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;表参道\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;渋谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003elet\u003c/span\u003e test2 \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e dijkstra \u003cspan class=\"synConstant\"\u003e\u0026quot;myogadani\u0026quot;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;meguro\u0026quot;\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e{\u003c/span\u003enamae \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;目黒\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e saitan_kyori \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e12.7000000000000028\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n   temae_list \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e\n     \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e\u0026quot;目黒\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;白金台\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;白金高輪\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;麻布十番\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;六本木一丁目\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;溜池山王\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"synConstant\"\u003e\u0026quot;永田町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;麹町\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;市ヶ谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;飯田橋\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;後楽園\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e\u0026quot;茗荷谷\u0026quot;\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e]}\u003c/span\u003e\n\u003c/pre\u003e\n\n\n"},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"プログラミングの基礎　16.4 最初の完動プログラム"},"buildId":"7e9MaWZtiSJfq25LIpmjp","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>